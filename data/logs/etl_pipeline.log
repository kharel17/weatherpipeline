2025-07-29 09:43:17,075 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 09:43:17,076 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:17,076 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 09:43:17,076 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:17,077 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 09:43:17,077 - etl.pipeline - INFO - Timestamp: 2025-07-29T09:43:17.077279
2025-07-29 09:43:17,077 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:17,078 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 09:43:17,078 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:17,079 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 09:43:17,079 - etl.extract - INFO - Starting complete data extraction
2025-07-29 09:43:17,079 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 09:43:17,899 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 09:43:17,900 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 09:43:18,657 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 09:43:18,658 - etl.extract - INFO - Data extraction completed in 1.58 seconds
2025-07-29 09:43:18,658 - etl.extract - INFO - Data validation successful
2025-07-29 09:43:18,658 - etl.pipeline - INFO - Extraction completed in 1.58 seconds
2025-07-29 09:43:18,658 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 09:43:18,659 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 09:43:18,659 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:18,660 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 09:43:18,660 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:18,660 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 09:43:18,661 - etl.transform - INFO - Starting data transformation
2025-07-29 09:43:18,661 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 09:43:18,662 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 09:43:18,662 - etl.pipeline - INFO - Records created: 7
2025-07-29 09:43:18,662 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 09:43:18,663 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:18,663 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 09:43:18,663 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:18,671 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 09:43:19,284 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 09:43:19,496 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-07-29 09:43:19,599 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250729_094319.csv
2025-07-29 09:43:19,618 - etl.load - INFO - Data successfully saved to JSON: data\json_exports\weather_data_lat27.75_lon85.25_20250729_094319.json
2025-07-29 09:43:19,668 - etl.pipeline - INFO - Data loading completed in 0.96 seconds
2025-07-29 09:43:19,669 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:19,669 - etl.pipeline - INFO - EXECUTION SUMMARY
2025-07-29 09:43:19,669 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:19,670 - etl.pipeline - INFO - 
Location: 27.75, 85.25
2025-07-29 09:43:19,670 - etl.pipeline - INFO - Timezone: Asia/Kathmandu
2025-07-29 09:43:19,671 - etl.pipeline - INFO - Data source: open-meteo
2025-07-29 09:43:19,671 - etl.pipeline - INFO - 
Current Conditions:
2025-07-29 09:43:19,671 - etl.pipeline - INFO -   Temperature: 23.1°C
2025-07-29 09:43:19,672 - etl.pipeline - INFO -   Condition: Overcast
2025-07-29 09:43:19,683 - etl.pipeline - INFO -   Wind: 3.8 km/h NNW
2025-07-29 09:43:19,683 - etl.pipeline - INFO - 
Air Quality:
2025-07-29 09:43:19,684 - etl.pipeline - INFO -   PM2.5: 0.0 µg/m³
2025-07-29 09:43:19,684 - etl.pipeline - INFO -   PM10: 0.0 µg/m³
2025-07-29 09:43:19,684 - etl.pipeline - INFO -   US AQI: 0 (Good)
2025-07-29 09:43:19,685 - etl.pipeline - INFO - 
Forecast Preview (Next 3 Days):
2025-07-29 09:43:19,685 - etl.pipeline - INFO -   2025-07-29: 21.1°C to 25.0°C, Thunderstorm
2025-07-29 09:43:19,686 - etl.pipeline - INFO -     Precipitation: 8.9 mm, UV Index: 5.6
2025-07-29 09:43:19,686 - etl.pipeline - INFO -   2025-07-30: 21.2°C to 25.5°C, Thunderstorm with slight hail
2025-07-29 09:43:19,686 - etl.pipeline - INFO -     Precipitation: 43.6 mm, UV Index: 8.15
2025-07-29 09:43:19,687 - etl.pipeline - INFO -   2025-07-31: 21.0°C to 24.3°C, Thunderstorm
2025-07-29 09:43:19,687 - etl.pipeline - INFO -     Precipitation: 27.4 mm, UV Index: 7.55
2025-07-29 09:43:19,687 - etl.pipeline - INFO - 
Performance Statistics:
2025-07-29 09:43:19,687 - etl.pipeline - INFO -   Extract time: 1.58s
2025-07-29 09:43:19,688 - etl.pipeline - INFO -   Transform time: 0.00s
2025-07-29 09:43:19,688 - etl.pipeline - INFO -   Load time: 0.96s
2025-07-29 09:43:19,688 - etl.pipeline - INFO -   Total time: 2.59s
2025-07-29 09:43:19,690 - etl.pipeline - INFO - 
Data Storage:
2025-07-29 09:43:19,704 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:19,705 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.59 SECONDS
2025-07-29 09:43:19,705 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:19,709 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 09:43:19,714 - etl.pipeline - INFO - Starting batch ETL for 3 locations
2025-07-29 09:43:19,715 - etl.pipeline - INFO - 
Processing location 1/3: 27.7, 85.3
2025-07-29 09:43:19,717 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:19,717 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 09:43:19,717 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:19,717 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 09:43:19,717 - etl.pipeline - INFO - Timestamp: 2025-07-29T09:43:19.717743
2025-07-29 09:43:19,717 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:19,718 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 09:43:19,718 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:19,718 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 09:43:19,718 - etl.extract - INFO - Starting complete data extraction
2025-07-29 09:43:19,719 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 09:43:20,412 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 09:43:20,412 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 09:43:21,093 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 09:43:21,093 - etl.extract - INFO - Data extraction completed in 1.37 seconds
2025-07-29 09:43:21,093 - etl.extract - INFO - Data validation successful
2025-07-29 09:43:21,093 - etl.pipeline - INFO - Extraction completed in 1.38 seconds
2025-07-29 09:43:21,093 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 09:43:21,093 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 09:43:21,093 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:21,093 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 09:43:21,093 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:21,109 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 09:43:21,109 - etl.transform - INFO - Starting data transformation
2025-07-29 09:43:21,110 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 09:43:21,110 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 09:43:21,110 - etl.pipeline - INFO - Records created: 7
2025-07-29 09:43:21,110 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 09:43:21,110 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:21,110 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 09:43:21,110 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:21,113 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 09:43:21,115 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 09:43:21,117 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 09:43:21,123 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250729_094321.csv
2025-07-29 09:43:21,250 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-07-29 09:43:21,250 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:21,250 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.53 SECONDS
2025-07-29 09:43:21,250 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:21,250 - etl.pipeline - INFO - 
Processing location 2/3: 40.71, -74.01
2025-07-29 09:43:21,250 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:21,250 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 09:43:21,250 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:21,259 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-07-29 09:43:21,259 - etl.pipeline - INFO - Timestamp: 2025-07-29T09:43:21.259448
2025-07-29 09:43:21,259 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:21,260 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 09:43:21,260 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:21,260 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-07-29 09:43:21,260 - etl.extract - INFO - Starting complete data extraction
2025-07-29 09:43:21,260 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-07-29 09:43:21,991 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 09:43:21,991 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-07-29 09:43:23,292 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 09:43:23,293 - etl.extract - INFO - Data extraction completed in 2.03 seconds
2025-07-29 09:43:23,294 - etl.extract - INFO - Data validation successful
2025-07-29 09:43:23,294 - etl.pipeline - INFO - Extraction completed in 2.03 seconds
2025-07-29 09:43:23,294 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 09:43:23,295 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 09:43:23,296 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:23,296 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 09:43:23,297 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:23,298 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 09:43:23,298 - etl.transform - INFO - Starting data transformation
2025-07-29 09:43:23,298 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 09:43:23,299 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 09:43:23,299 - etl.pipeline - INFO - Records created: 7
2025-07-29 09:43:23,300 - etl.pipeline - INFO - Date range: 2025-07-28 to 2025-08-03
2025-07-29 09:43:23,300 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:23,302 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 09:43:23,302 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:23,304 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 09:43:23,314 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 09:43:23,442 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-07-29 09:43:23,442 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250729_094323.csv
2025-07-29 09:43:23,644 - etl.pipeline - INFO - Data loading completed in 0.15 seconds
2025-07-29 09:43:23,644 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:23,644 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.39 SECONDS
2025-07-29 09:43:23,644 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:23,644 - etl.pipeline - INFO - 
Processing location 3/3: 51.51, -0.13
2025-07-29 09:43:23,644 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:23,644 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 09:43:23,644 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:23,644 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-07-29 09:43:23,644 - etl.pipeline - INFO - Timestamp: 2025-07-29T09:43:23.644609
2025-07-29 09:43:23,644 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:23,644 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 09:43:23,644 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:23,644 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-07-29 09:43:23,644 - etl.extract - INFO - Starting complete data extraction
2025-07-29 09:43:23,644 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-07-29 09:43:24,361 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 09:43:24,362 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-07-29 09:43:25,027 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 09:43:25,027 - etl.extract - INFO - Data extraction completed in 1.38 seconds
2025-07-29 09:43:25,027 - etl.extract - INFO - Data validation successful
2025-07-29 09:43:25,027 - etl.pipeline - INFO - Extraction completed in 1.38 seconds
2025-07-29 09:43:25,027 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 09:43:25,039 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 09:43:25,039 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:25,039 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 09:43:25,039 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:25,039 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 09:43:25,039 - etl.transform - INFO - Starting data transformation
2025-07-29 09:43:25,039 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 09:43:25,040 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 09:43:25,040 - etl.pipeline - INFO - Records created: 7
2025-07-29 09:43:25,040 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 09:43:25,040 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:25,041 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 09:43:25,041 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:25,042 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 09:43:25,052 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 09:43:25,110 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-07-29 09:43:25,128 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250729_094325.csv
2025-07-29 09:43:25,254 - etl.pipeline - INFO - Data loading completed in 0.09 seconds
2025-07-29 09:43:25,254 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:25,255 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.61 SECONDS
2025-07-29 09:43:25,255 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:25,260 - etl.pipeline - INFO - 
Batch ETL completed in 5.55 seconds
2025-07-29 09:43:25,260 - etl.pipeline - INFO - Success rate: 100.0% (3/3)
2025-07-29 09:43:25,281 - etl.load - INFO - Retrieved 5 records from database
2025-07-29 09:43:25,286 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 09:43:25,287 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:25,287 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 09:43:25,287 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:25,288 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 09:43:25,288 - etl.pipeline - INFO - Timestamp: 2025-07-29T09:43:25.288932
2025-07-29 09:43:25,288 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:25,289 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 09:43:25,290 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:25,290 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 09:43:25,291 - etl.extract - INFO - Starting complete data extraction
2025-07-29 09:43:25,291 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 09:43:26,031 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 09:43:26,031 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 09:43:26,704 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 09:43:26,704 - etl.extract - INFO - Data extraction completed in 1.41 seconds
2025-07-29 09:43:26,705 - etl.extract - INFO - Data validation successful
2025-07-29 09:43:26,705 - etl.pipeline - INFO - Extraction completed in 1.41 seconds
2025-07-29 09:43:26,705 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 09:43:26,705 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 09:43:26,706 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:26,706 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 09:43:26,706 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:26,706 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 09:43:26,707 - etl.transform - INFO - Starting data transformation
2025-07-29 09:43:26,707 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 09:43:26,707 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 09:43:26,707 - etl.pipeline - INFO - Records created: 7
2025-07-29 09:43:26,707 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 09:43:26,708 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 09:43:26,708 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 09:43:26,708 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 09:43:26,711 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 09:43:26,712 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 09:43:26,718 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 09:43:26,724 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250729_094326.csv
2025-07-29 09:43:26,850 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-07-29 09:43:26,850 - etl.pipeline - INFO - 
============================================================
2025-07-29 09:43:26,850 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.56 SECONDS
2025-07-29 09:43:26,850 - etl.pipeline - INFO - ============================================================
2025-07-29 09:43:26,855 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 09:43:26,869 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 0, 0
2025-07-29 13:43:19,317 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 13:43:19,631 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:19,631 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 13:43:19,631 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:19,631 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-07-29 13:43:19,631 - etl.pipeline - INFO - Timestamp: 2025-07-29T13:43:19.631779
2025-07-29 13:43:19,631 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:19,631 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 13:43:19,642 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:19,644 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-07-29 13:43:19,645 - etl.extract - INFO - Starting complete data extraction
2025-07-29 13:43:19,645 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-07-29 13:43:20,450 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 13:43:20,450 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-07-29 13:43:21,263 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 13:43:21,263 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-07-29 13:43:21,263 - etl.extract - INFO - Data validation successful
2025-07-29 13:43:21,263 - etl.pipeline - INFO - Extraction completed in 1.62 seconds
2025-07-29 13:43:21,263 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 13:43:21,263 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 13:43:21,263 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:21,263 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 13:43:21,269 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:21,269 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 13:43:21,269 - etl.transform - INFO - Starting data transformation
2025-07-29 13:43:21,269 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 13:43:21,269 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 13:43:21,269 - etl.pipeline - INFO - Records created: 7
2025-07-29 13:43:21,277 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 13:43:21,278 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:21,278 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 13:43:21,279 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:21,296 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 13:43:21,298 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 13:43:21,331 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 13:43:21,882 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250729_134321.csv
2025-07-29 13:43:22,032 - etl.pipeline - INFO - Data loading completed in 0.62 seconds
2025-07-29 13:43:22,032 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:43:22,032 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.40 SECONDS
2025-07-29 13:43:22,048 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:22,048 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:22] "[32mGET /weather?lat=40.71&lon=-74.01 HTTP/1.1[0m" 302 -
2025-07-29 13:43:22,084 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:22] "GET / HTTP/1.1" 200 -
2025-07-29 13:43:27,069 - models.database - ERROR - Error getting database stats: (sqlite3.OperationalError) no such column: data_quality_log.pipeline_version
[SQL: SELECT count(*) AS count_1 
FROM (SELECT data_quality_log.id AS data_quality_log_id, data_quality_log.timestamp AS data_quality_log_timestamp, data_quality_log.records_processed AS data_quality_log_records_processed, data_quality_log.records_saved AS data_quality_log_records_saved, data_quality_log.errors_count AS data_quality_log_errors_count, data_quality_log.processing_time_seconds AS data_quality_log_processing_time_seconds, data_quality_log.location_lat AS data_quality_log_location_lat, data_quality_log.location_lon AS data_quality_log_location_lon, data_quality_log.notes AS data_quality_log_notes, data_quality_log.pipeline_version AS data_quality_log_pipeline_version 
FROM data_quality_log) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 13:43:27,073 - __main__ - ERROR - Stats error: stats.html
2025-07-29 13:43:27,076 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:27] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-07-29 13:43:27,090 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:27] "GET / HTTP/1.1" 200 -
2025-07-29 13:43:28,839 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:28] "[32mGET /dashboard HTTP/1.1[0m" 302 -
2025-07-29 13:43:28,855 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:28] "GET / HTTP/1.1" 200 -
2025-07-29 13:43:30,170 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:30] "GET / HTTP/1.1" 200 -
2025-07-29 13:43:40,760 - __main__ - INFO - Fetching fresh weather data for 27.7, 85.3
2025-07-29 13:43:40,762 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 13:43:40,762 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:40,762 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 13:43:40,762 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:40,762 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 13:43:40,762 - etl.pipeline - INFO - Timestamp: 2025-07-29T13:43:40.762075
2025-07-29 13:43:40,762 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:40,762 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 13:43:40,762 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:40,762 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 13:43:40,762 - etl.extract - INFO - Starting complete data extraction
2025-07-29 13:43:40,762 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 13:43:41,577 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 13:43:41,577 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 13:43:42,396 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 13:43:42,396 - etl.extract - INFO - Data extraction completed in 1.63 seconds
2025-07-29 13:43:42,401 - etl.extract - INFO - Data validation successful
2025-07-29 13:43:42,402 - etl.pipeline - INFO - Extraction completed in 1.64 seconds
2025-07-29 13:43:42,402 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 13:43:42,402 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 13:43:42,402 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:42,402 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 13:43:42,406 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:42,406 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 13:43:42,409 - etl.transform - INFO - Starting data transformation
2025-07-29 13:43:42,409 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 13:43:42,409 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 13:43:42,409 - etl.pipeline - INFO - Records created: 7
2025-07-29 13:43:42,409 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 13:43:42,415 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:43:42,415 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 13:43:42,415 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:43:42,423 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 13:43:42,429 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 13:43:42,440 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 13:43:42,475 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250729_134342.csv
2025-07-29 13:43:42,614 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-07-29 13:43:42,614 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:43:42,623 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.85 SECONDS
2025-07-29 13:43:42,623 - etl.pipeline - INFO - ============================================================
2025-07-29 13:43:42,627 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:42] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-07-29 13:43:42,643 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:43:42] "GET / HTTP/1.1" 200 -
2025-07-29 13:44:56,648 - __main__ - INFO - Fetching fresh weather data for 51.51, -0.13
2025-07-29 13:44:56,655 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 13:44:56,655 - etl.pipeline - INFO - ============================================================
2025-07-29 13:44:56,655 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 13:44:56,655 - etl.pipeline - INFO - ============================================================
2025-07-29 13:44:56,655 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-07-29 13:44:56,655 - etl.pipeline - INFO - Timestamp: 2025-07-29T13:44:56.655321
2025-07-29 13:44:56,663 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:44:56,663 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 13:44:56,663 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:44:56,666 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-07-29 13:44:56,666 - etl.extract - INFO - Starting complete data extraction
2025-07-29 13:44:56,667 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-07-29 13:44:57,454 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 13:44:57,454 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-07-29 13:44:58,263 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 13:44:58,265 - etl.extract - INFO - Data extraction completed in 1.60 seconds
2025-07-29 13:44:58,265 - etl.extract - INFO - Data validation successful
2025-07-29 13:44:58,265 - etl.pipeline - INFO - Extraction completed in 1.60 seconds
2025-07-29 13:44:58,265 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 13:44:58,265 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 13:44:58,265 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:44:58,265 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 13:44:58,265 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:44:58,265 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 13:44:58,265 - etl.transform - INFO - Starting data transformation
2025-07-29 13:44:58,265 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 13:44:58,274 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-07-29 13:44:58,274 - etl.pipeline - INFO - Records created: 7
2025-07-29 13:44:58,276 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 13:44:58,276 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:44:58,276 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 13:44:58,276 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:44:58,282 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 13:44:58,290 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 13:44:58,298 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 13:44:58,437 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250729_134458.csv
2025-07-29 13:44:58,501 - etl.pipeline - INFO - Data loading completed in 0.17 seconds
2025-07-29 13:44:58,501 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:44:58,501 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.85 SECONDS
2025-07-29 13:44:58,501 - etl.pipeline - INFO - ============================================================
2025-07-29 13:44:58,501 - models.forecast.manager - INFO - ForecastManager initialized
2025-07-29 13:44:58,501 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.51, -0.13
2025-07-29 13:44:58,612 - __main__ - ERROR - Error in weather route: Could not build url for endpoint 'history' with values ['lat', 'lon']. Did you mean 'dashboard' instead?
2025-07-29 13:44:58,620 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:44:58] "[32mGET /weather?lat=51.51&lon=-0.13 HTTP/1.1[0m" 302 -
2025-07-29 13:44:58,634 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:44:58] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:11,088 - __main__ - INFO - Fetching fresh weather data for 51.51, -0.13
2025-07-29 13:46:11,088 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 13:46:11,088 - etl.pipeline - INFO - ============================================================
2025-07-29 13:46:11,088 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 13:46:11,098 - etl.pipeline - INFO - ============================================================
2025-07-29 13:46:11,098 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-07-29 13:46:11,099 - etl.pipeline - INFO - Timestamp: 2025-07-29T13:46:11.099585
2025-07-29 13:46:11,099 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:46:11,101 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 13:46:11,101 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:46:11,101 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-07-29 13:46:11,103 - etl.extract - INFO - Starting complete data extraction
2025-07-29 13:46:11,104 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-07-29 13:46:11,872 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 13:46:11,872 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-07-29 13:46:12,595 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 13:46:12,595 - etl.extract - INFO - Data extraction completed in 1.49 seconds
2025-07-29 13:46:12,595 - etl.extract - INFO - Data validation successful
2025-07-29 13:46:12,595 - etl.pipeline - INFO - Extraction completed in 1.49 seconds
2025-07-29 13:46:12,595 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 13:46:12,595 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 13:46:12,602 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:46:12,602 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 13:46:12,718 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:46:12,718 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 13:46:12,718 - etl.transform - INFO - Starting data transformation
2025-07-29 13:46:12,718 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 13:46:12,718 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 13:46:12,718 - etl.pipeline - INFO - Records created: 7
2025-07-29 13:46:12,718 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 13:46:12,726 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:46:12,726 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 13:46:12,726 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:46:12,732 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 13:46:12,734 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 13:46:12,742 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 13:46:12,785 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250729_134612.csv
2025-07-29 13:46:12,840 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-07-29 13:46:12,840 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:46:12,848 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-07-29 13:46:12,848 - etl.pipeline - INFO - ============================================================
2025-07-29 13:46:12,852 - models.forecast.manager - INFO - ForecastManager initialized
2025-07-29 13:46:12,852 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.51, -0.13
2025-07-29 13:46:12,864 - __main__ - ERROR - Error in weather route: Could not build url for endpoint 'history' with values ['lat', 'lon']. Did you mean 'dashboard' instead?
2025-07-29 13:46:12,864 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:12] "[32mGET /weather?lat=51.51&lon=-0.13 HTTP/1.1[0m" 302 -
2025-07-29 13:46:12,882 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:12] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:20,458 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:20] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:22,032 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:22] "[32mGET /dashboard HTTP/1.1[0m" 302 -
2025-07-29 13:46:22,051 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:22] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:25,306 - models.database - ERROR - Error getting database stats: (sqlite3.OperationalError) no such column: data_quality_log.pipeline_version
[SQL: SELECT count(*) AS count_1 
FROM (SELECT data_quality_log.id AS data_quality_log_id, data_quality_log.timestamp AS data_quality_log_timestamp, data_quality_log.records_processed AS data_quality_log_records_processed, data_quality_log.records_saved AS data_quality_log_records_saved, data_quality_log.errors_count AS data_quality_log_errors_count, data_quality_log.processing_time_seconds AS data_quality_log_processing_time_seconds, data_quality_log.location_lat AS data_quality_log_location_lat, data_quality_log.location_lon AS data_quality_log_location_lon, data_quality_log.notes AS data_quality_log_notes, data_quality_log.pipeline_version AS data_quality_log_pipeline_version 
FROM data_quality_log) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 13:46:25,314 - __main__ - ERROR - Stats error: stats.html
2025-07-29 13:46:25,314 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:25] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-07-29 13:46:25,331 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:25] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:27,556 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:27] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:29,229 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:29] "[32mGET /dashboard HTTP/1.1[0m" 302 -
2025-07-29 13:46:29,241 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:29] "GET / HTTP/1.1" 200 -
2025-07-29 13:46:30,531 - models.database - ERROR - Error getting database stats: (sqlite3.OperationalError) no such column: data_quality_log.pipeline_version
[SQL: SELECT count(*) AS count_1 
FROM (SELECT data_quality_log.id AS data_quality_log_id, data_quality_log.timestamp AS data_quality_log_timestamp, data_quality_log.records_processed AS data_quality_log_records_processed, data_quality_log.records_saved AS data_quality_log_records_saved, data_quality_log.errors_count AS data_quality_log_errors_count, data_quality_log.processing_time_seconds AS data_quality_log_processing_time_seconds, data_quality_log.location_lat AS data_quality_log_location_lat, data_quality_log.location_lon AS data_quality_log_location_lon, data_quality_log.notes AS data_quality_log_notes, data_quality_log.pipeline_version AS data_quality_log_pipeline_version 
FROM data_quality_log) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 13:46:30,533 - __main__ - ERROR - Stats error: stats.html
2025-07-29 13:46:30,533 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:30] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-07-29 13:46:30,553 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 13:46:30] "GET / HTTP/1.1" 200 -
2025-07-29 13:57:51,803 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 13:57:51,803 - etl.pipeline - INFO - ============================================================
2025-07-29 13:57:51,803 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 13:57:51,803 - etl.pipeline - INFO - ============================================================
2025-07-29 13:57:51,803 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 13:57:51,803 - etl.pipeline - INFO - Timestamp: 2025-07-29T13:57:51.803373
2025-07-29 13:57:51,803 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:57:51,803 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 13:57:51,811 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:57:51,811 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 13:57:51,811 - etl.extract - INFO - Starting complete data extraction
2025-07-29 13:57:51,811 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 13:57:52,537 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 13:57:52,537 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 13:57:53,231 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 13:57:53,231 - etl.extract - INFO - Data extraction completed in 1.42 seconds
2025-07-29 13:57:53,231 - etl.extract - INFO - Data validation successful
2025-07-29 13:57:53,231 - etl.pipeline - INFO - Extraction completed in 1.42 seconds
2025-07-29 13:57:53,231 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 13:57:53,231 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 13:57:53,231 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:57:53,231 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 13:57:53,231 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:57:53,231 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 13:57:53,231 - etl.transform - INFO - Starting data transformation
2025-07-29 13:57:53,241 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 13:57:53,241 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-07-29 13:57:53,242 - etl.pipeline - INFO - Records created: 7
2025-07-29 13:57:53,242 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 13:57:53,242 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 13:57:53,242 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 13:57:53,242 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 13:57:53,250 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 13:57:53,275 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 13:57:53,284 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-07-29 13:57:53,372 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-07-29 13:57:53,372 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:57:53,372 - etl.pipeline - INFO - EXECUTION SUMMARY
2025-07-29 13:57:53,372 - etl.pipeline - INFO - ============================================================
2025-07-29 13:57:53,372 - etl.pipeline - INFO - 
Location: 27.75, 85.25
2025-07-29 13:57:53,372 - etl.pipeline - INFO - Timezone: Asia/Kathmandu
2025-07-29 13:57:53,376 - etl.pipeline - INFO - Data source: open-meteo
2025-07-29 13:57:53,376 - etl.pipeline - INFO - 
Current Conditions:
2025-07-29 13:57:53,376 - etl.pipeline - INFO -   Temperature: 25.4°C
2025-07-29 13:57:53,376 - etl.pipeline - INFO -   Condition: Overcast
2025-07-29 13:57:53,380 - etl.pipeline - INFO -   Wind: 6.9 km/h NW
2025-07-29 13:57:53,381 - etl.pipeline - INFO - 
Air Quality:
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   PM2.5: 0.0 µg/m³
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   PM10: 0.0 µg/m³
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   US AQI: 0 (Good)
2025-07-29 13:57:53,382 - etl.pipeline - INFO - 
Forecast Preview (Next 3 Days):
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   2025-07-29: 21.1°C to 25.4°C, Slight rain showers
2025-07-29 13:57:53,382 - etl.pipeline - INFO -     Precipitation: 4.9 mm, UV Index: 4.2
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   2025-07-30: 21.4°C to 25.7°C, Thunderstorm with slight hail
2025-07-29 13:57:53,382 - etl.pipeline - INFO -     Precipitation: 21.5 mm, UV Index: 7.2
2025-07-29 13:57:53,382 - etl.pipeline - INFO -   2025-07-31: 21.1°C to 24.7°C, Thunderstorm
2025-07-29 13:57:53,389 - etl.pipeline - INFO -     Precipitation: 24.7 mm, UV Index: 8.7
2025-07-29 13:57:53,389 - etl.pipeline - INFO - 
Performance Statistics:
2025-07-29 13:57:53,389 - etl.pipeline - INFO -   Extract time: 1.42s
2025-07-29 13:57:53,389 - etl.pipeline - INFO -   Transform time: 0.01s
2025-07-29 13:57:53,389 - etl.pipeline - INFO -   Load time: 0.05s
2025-07-29 13:57:53,389 - etl.pipeline - INFO -   Total time: 1.57s
2025-07-29 13:57:53,394 - etl.pipeline - INFO - 
Data Storage:
2025-07-29 13:57:53,402 - etl.pipeline - INFO - 
============================================================
2025-07-29 13:57:53,402 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.57 SECONDS
2025-07-29 13:57:53,402 - etl.pipeline - INFO - ============================================================
2025-07-29 14:34:07,286 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 14:34:07,288 - etl.pipeline - INFO - ============================================================
2025-07-29 14:34:07,288 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 14:34:07,288 - etl.pipeline - INFO - ============================================================
2025-07-29 14:34:07,289 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-07-29 14:34:07,289 - etl.pipeline - INFO - Timestamp: 2025-07-29T14:34:07.289797
2025-07-29 14:34:07,289 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:34:07,290 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 14:34:07,290 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:34:07,290 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-07-29 14:34:07,291 - etl.extract - INFO - Starting complete data extraction
2025-07-29 14:34:07,291 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-07-29 14:34:08,078 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 14:34:08,078 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-07-29 14:34:08,710 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 14:34:08,711 - etl.extract - INFO - Data extraction completed in 1.42 seconds
2025-07-29 14:34:08,711 - etl.extract - INFO - Data validation successful
2025-07-29 14:34:08,712 - etl.pipeline - INFO - Extraction completed in 1.42 seconds
2025-07-29 14:34:08,713 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 14:34:08,713 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 14:34:08,714 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:34:08,715 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 14:34:08,715 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:34:08,716 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 14:34:08,716 - etl.transform - INFO - Starting data transformation
2025-07-29 14:34:08,717 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 14:34:08,717 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 14:34:08,717 - etl.pipeline - INFO - Records created: 7
2025-07-29 14:34:08,717 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 14:34:08,717 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:34:08,718 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 14:34:08,719 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:34:08,734 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 14:34:08,737 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 14:34:08,919 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-07-29 14:34:09,055 - etl.pipeline - INFO - Data loading completed in 0.28 seconds
2025-07-29 14:34:09,056 - etl.pipeline - INFO - 
============================================================
2025-07-29 14:34:09,056 - etl.pipeline - INFO - EXECUTION SUMMARY
2025-07-29 14:34:09,057 - etl.pipeline - INFO - ============================================================
2025-07-29 14:34:09,058 - etl.pipeline - INFO - 
Location: 27.75, 85.25
2025-07-29 14:34:09,058 - etl.pipeline - INFO - Timezone: Asia/Kathmandu
2025-07-29 14:34:09,059 - etl.pipeline - INFO - Data source: open-meteo
2025-07-29 14:34:09,059 - etl.pipeline - INFO - 
Current Conditions:
2025-07-29 14:34:09,060 - etl.pipeline - INFO -   Temperature: 25.4°C
2025-07-29 14:34:09,060 - etl.pipeline - INFO -   Condition: Overcast
2025-07-29 14:34:09,060 - etl.pipeline - INFO -   Wind: 6.9 km/h NW
2025-07-29 14:34:09,061 - etl.pipeline - INFO - 
Air Quality:
2025-07-29 14:34:09,061 - etl.pipeline - INFO -   PM2.5: 0.0 µg/m³
2025-07-29 14:34:09,061 - etl.pipeline - INFO -   PM10: 0.0 µg/m³
2025-07-29 14:34:09,061 - etl.pipeline - INFO -   US AQI: 0 (Good)
2025-07-29 14:34:09,062 - etl.pipeline - INFO - 
Forecast Preview (Next 3 Days):
2025-07-29 14:34:09,062 - etl.pipeline - INFO -   2025-07-29: 21.1°C to 25.4°C, Slight rain showers
2025-07-29 14:34:09,063 - etl.pipeline - INFO -     Precipitation: 4.9 mm, UV Index: 4.2
2025-07-29 14:34:09,065 - etl.pipeline - INFO -   2025-07-30: 21.4°C to 25.7°C, Thunderstorm with slight hail
2025-07-29 14:34:09,065 - etl.pipeline - INFO -     Precipitation: 21.5 mm, UV Index: 7.2
2025-07-29 14:34:09,066 - etl.pipeline - INFO -   2025-07-31: 21.1°C to 24.7°C, Thunderstorm
2025-07-29 14:34:09,066 - etl.pipeline - INFO -     Precipitation: 24.7 mm, UV Index: 8.7
2025-07-29 14:34:09,067 - etl.pipeline - INFO - 
Performance Statistics:
2025-07-29 14:34:09,068 - etl.pipeline - INFO -   Extract time: 1.42s
2025-07-29 14:34:09,068 - etl.pipeline - INFO -   Transform time: 0.00s
2025-07-29 14:34:09,069 - etl.pipeline - INFO -   Load time: 0.28s
2025-07-29 14:34:09,069 - etl.pipeline - INFO -   Total time: 1.77s
2025-07-29 14:34:09,069 - etl.pipeline - INFO - 
Data Storage:
2025-07-29 14:34:09,075 - etl.pipeline - INFO - 
============================================================
2025-07-29 14:34:09,075 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.77 SECONDS
2025-07-29 14:34:09,076 - etl.pipeline - INFO - ============================================================
2025-07-29 14:36:47,367 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-07-29 14:36:47,367 - etl.pipeline - INFO - ============================================================
2025-07-29 14:36:47,369 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-07-29 14:36:47,369 - etl.pipeline - INFO - ============================================================
2025-07-29 14:36:47,369 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-07-29 14:36:47,370 - etl.pipeline - INFO - Timestamp: 2025-07-29T14:36:47.370366
2025-07-29 14:36:47,370 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:36:47,371 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-07-29 14:36:47,371 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:36:47,371 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-07-29 14:36:47,372 - etl.extract - INFO - Starting complete data extraction
2025-07-29 14:36:47,372 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-07-29 14:36:48,154 - etl.extract - INFO - Weather forecast fetched successfully
2025-07-29 14:36:48,154 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-07-29 14:36:48,801 - etl.extract - INFO - Air quality data fetched successfully
2025-07-29 14:36:48,802 - etl.extract - INFO - Data extraction completed in 1.43 seconds
2025-07-29 14:36:48,802 - etl.extract - INFO - Data validation successful
2025-07-29 14:36:48,803 - etl.pipeline - INFO - Extraction completed in 1.43 seconds
2025-07-29 14:36:48,803 - etl.pipeline - INFO - Weather forecast days: 7
2025-07-29 14:36:48,803 - etl.pipeline - INFO - Air quality data points: 120
2025-07-29 14:36:48,804 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:36:48,804 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-07-29 14:36:48,804 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:36:48,805 - etl.transform - INFO - WeatherTransformer initialized
2025-07-29 14:36:48,805 - etl.transform - INFO - Starting data transformation
2025-07-29 14:36:48,805 - etl.transform - INFO - Transformation completed. 7 records created
2025-07-29 14:36:48,805 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-07-29 14:36:48,806 - etl.pipeline - INFO - Records created: 7
2025-07-29 14:36:48,806 - etl.pipeline - INFO - Date range: 2025-07-29 to 2025-08-04
2025-07-29 14:36:48,806 - etl.pipeline - INFO - 
----------------------------------------
2025-07-29 14:36:48,806 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-07-29 14:36:48,807 - etl.pipeline - INFO - ----------------------------------------
2025-07-29 14:36:48,823 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-07-29 14:36:48,823 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-07-29 14:36:49,081 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-07-29 14:36:49,296 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250729_143649.csv
2025-07-29 14:36:49,349 - etl.pipeline - INFO - Data loading completed in 0.49 seconds
2025-07-29 14:36:49,350 - etl.pipeline - INFO - 
============================================================
2025-07-29 14:36:49,350 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.98 SECONDS
2025-07-29 14:36:49,350 - etl.pipeline - INFO - ============================================================
2025-07-29 14:36:49,352 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:36:49] "[32mGET /weather?lat=35.69&lon=139.69 HTTP/1.1[0m" 302 -
2025-07-29 14:36:49,360 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:36:49] "GET / HTTP/1.1" 200 -
2025-07-29 14:37:01,953 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:37:01] "[32mGET /dashboard HTTP/1.1[0m" 302 -
2025-07-29 14:37:01,967 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:37:01] "GET / HTTP/1.1" 200 -
2025-07-29 14:37:22,907 - models.database - ERROR - Error getting database stats: (sqlite3.OperationalError) no such column: data_quality_log.pipeline_version
[SQL: SELECT count(*) AS count_1 
FROM (SELECT data_quality_log.id AS data_quality_log_id, data_quality_log.timestamp AS data_quality_log_timestamp, data_quality_log.records_processed AS data_quality_log_records_processed, data_quality_log.records_saved AS data_quality_log_records_saved, data_quality_log.errors_count AS data_quality_log_errors_count, data_quality_log.processing_time_seconds AS data_quality_log_processing_time_seconds, data_quality_log.location_lat AS data_quality_log_location_lat, data_quality_log.location_lon AS data_quality_log_location_lon, data_quality_log.notes AS data_quality_log_notes, data_quality_log.pipeline_version AS data_quality_log_pipeline_version 
FROM data_quality_log) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 14:37:22,907 - __main__ - ERROR - Stats error: stats.html
2025-07-29 14:37:22,907 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:37:22] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-07-29 14:37:22,924 - werkzeug - INFO - 127.0.0.1 - - [29/Jul/2025 14:37:22] "GET / HTTP/1.1" 200 -
2025-08-12 01:13:15,886 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:13:15,886 - etl.pipeline - INFO - ============================================================
2025-08-12 01:13:15,886 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:13:15,886 - etl.pipeline - INFO - ============================================================
2025-08-12 01:13:15,887 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-08-12 01:13:15,887 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:13:15.887151
2025-08-12 01:13:15,887 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:13:15,887 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:13:15,887 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:13:15,887 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-08-12 01:13:15,887 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:13:15,888 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-08-12 01:13:16,972 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:13:16,972 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-08-12 01:13:17,788 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:13:17,789 - etl.extract - INFO - Data extraction completed in 1.90 seconds
2025-08-12 01:13:17,789 - etl.extract - INFO - Data validation successful
2025-08-12 01:13:17,789 - etl.pipeline - INFO - Extraction completed in 1.90 seconds
2025-08-12 01:13:17,789 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:13:17,789 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:13:17,789 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:13:17,789 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:13:17,790 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:13:17,790 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:13:17,790 - etl.transform - INFO - Starting data transformation
2025-08-12 01:13:17,790 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:13:17,791 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:13:17,791 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:13:17,791 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 01:13:17,791 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:13:17,791 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:13:17,791 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:13:17,799 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:13:17,813 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:13:17,826 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-08-12 01:13:17,851 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_011317.csv
2025-08-12 01:13:17,864 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-12 01:13:17,864 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:13:17,864 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.98 SECONDS
2025-08-12 01:13:17,864 - etl.pipeline - INFO - ============================================================
2025-08-12 01:13:17,887 - __main__ - ERROR - Error in weather route: Could not build url for endpoint 'history' with values ['lat', 'lon']. Did you mean 'dashboard' instead?
2025-08-12 01:13:17,888 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:13:17] "[32mGET /weather?lat=51.51&lon=-0.13 HTTP/1.1[0m" 302 -
2025-08-12 01:13:17,893 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:13:17] "GET / HTTP/1.1" 200 -
2025-08-12 01:27:58,961 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:27:58,961 - etl.pipeline - INFO - ============================================================
2025-08-12 01:27:58,961 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:27:58,961 - etl.pipeline - INFO - ============================================================
2025-08-12 01:27:58,961 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 01:27:58,961 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:27:58.961859
2025-08-12 01:27:58,961 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:27:58,962 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:27:58,962 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:27:58,962 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 01:27:58,962 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:27:58,962 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 01:28:00,072 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:28:00,072 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 01:28:00,930 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:28:00,930 - etl.extract - INFO - Data extraction completed in 1.97 seconds
2025-08-12 01:28:00,930 - etl.extract - INFO - Data validation successful
2025-08-12 01:28:00,930 - etl.pipeline - INFO - Extraction completed in 1.97 seconds
2025-08-12 01:28:00,930 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:28:00,930 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:28:00,930 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:00,930 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:28:00,931 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:00,931 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:28:00,931 - etl.transform - INFO - Starting data transformation
2025-08-12 01:28:00,931 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:28:00,931 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:28:00,931 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:28:00,931 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 01:28:00,931 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:00,932 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:28:00,932 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:00,934 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:28:00,944 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:28:00,954 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-08-12 01:28:00,964 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_012800.csv
2025-08-12 01:28:00,976 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 01:28:00,977 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:28:00,977 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.02 SECONDS
2025-08-12 01:28:00,977 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:00,978 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:00] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 01:28:00,983 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:00] "GET / HTTP/1.1" 200 -
2025-08-12 01:28:07,891 - __main__ - INFO - Fetching fresh weather data for -33.87, 151.21
2025-08-12 01:28:07,893 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:28:07,893 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:07,893 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:28:07,893 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:07,894 - etl.pipeline - INFO - Location: -33.87, 151.21
2025-08-12 01:28:07,894 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:28:07.894229
2025-08-12 01:28:07,894 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:07,894 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:28:07,894 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:07,894 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.87, 151.21
2025-08-12 01:28:07,894 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:28:07,895 - etl.extract - INFO - Fetching weather forecast for -33.87, 151.21
2025-08-12 01:28:08,997 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:28:08,997 - etl.extract - INFO - Fetching air quality data for -33.87, 151.21
2025-08-12 01:28:09,823 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:28:09,823 - etl.extract - INFO - Data extraction completed in 1.93 seconds
2025-08-12 01:28:09,823 - etl.extract - INFO - Data validation successful
2025-08-12 01:28:09,823 - etl.pipeline - INFO - Extraction completed in 1.93 seconds
2025-08-12 01:28:09,823 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:28:09,824 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:28:09,824 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:09,824 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:28:09,824 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:09,824 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:28:09,824 - etl.transform - ERROR - Input data validation failed
2025-08-12 01:28:09,824 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:28:09,824 - etl.pipeline - INFO - Records created: 0
2025-08-12 01:28:09,825 - etl.pipeline - INFO - Date range: None to None
2025-08-12 01:28:09,825 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-12 01:28:09,825 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-12 01:28:09,825 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-12 01:28:09,825 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:09] "[32mGET /weather?lat=-33.87&lon=151.21 HTTP/1.1[0m" 302 -
2025-08-12 01:28:09,831 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:09] "GET / HTTP/1.1" 200 -
2025-08-12 01:28:13,734 - __main__ - INFO - Fetching fresh weather data for 35.69, 139.69
2025-08-12 01:28:13,736 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:28:13,736 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:13,736 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:28:13,736 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:13,736 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 01:28:13,736 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:28:13.736904
2025-08-12 01:28:13,737 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:13,737 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:28:13,737 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:13,737 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 01:28:13,737 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:28:13,737 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 01:28:14,831 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:28:14,831 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 01:28:15,657 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:28:15,657 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 01:28:15,657 - etl.extract - INFO - Data validation successful
2025-08-12 01:28:15,657 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 01:28:15,657 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:28:15,657 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:28:15,657 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:15,658 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:28:15,658 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:15,658 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:28:15,658 - etl.transform - INFO - Starting data transformation
2025-08-12 01:28:15,658 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:28:15,658 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:28:15,658 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:28:15,658 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 01:28:15,659 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:15,659 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:28:15,659 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:15,660 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:28:15,670 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:28:15,680 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-08-12 01:28:15,686 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_012815.csv
2025-08-12 01:28:15,698 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 01:28:15,698 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:28:15,699 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 01:28:15,699 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:15,700 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:15] "[32mGET /weather?lat=35.69&lon=139.69 HTTP/1.1[0m" 302 -
2025-08-12 01:28:15,706 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:15] "GET / HTTP/1.1" 200 -
2025-08-12 01:28:20,065 - __main__ - INFO - Fetching fresh weather data for 40.71, -74.01
2025-08-12 01:28:20,067 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:28:20,067 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:20,067 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:28:20,068 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:20,068 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 01:28:20,068 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:28:20.068294
2025-08-12 01:28:20,068 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:20,068 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:28:20,068 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:20,068 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 01:28:20,068 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:28:20,069 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 01:28:21,142 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:28:21,142 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 01:28:21,968 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:28:21,969 - etl.extract - INFO - Data extraction completed in 1.90 seconds
2025-08-12 01:28:21,969 - etl.extract - INFO - Data validation successful
2025-08-12 01:28:21,969 - etl.pipeline - INFO - Extraction completed in 1.90 seconds
2025-08-12 01:28:21,969 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:28:21,969 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:28:21,969 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:21,969 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:28:21,970 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:21,970 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:28:21,970 - etl.transform - INFO - Starting data transformation
2025-08-12 01:28:21,970 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:28:21,970 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:28:21,970 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:28:21,970 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 01:28:21,971 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:28:21,971 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:28:21,971 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:28:21,972 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:28:21,980 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:28:21,990 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-08-12 01:28:21,996 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_012821.csv
2025-08-12 01:28:22,008 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 01:28:22,009 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:28:22,009 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.94 SECONDS
2025-08-12 01:28:22,009 - etl.pipeline - INFO - ============================================================
2025-08-12 01:28:22,011 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:22] "[32mGET /weather?lat=40.71&lon=-74.01 HTTP/1.1[0m" 302 -
2025-08-12 01:28:22,016 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:28:22] "GET / HTTP/1.1" 200 -
2025-08-12 01:41:57,758 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:41:57] "GET / HTTP/1.1" 200 -
2025-08-12 01:42:01,022 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:01] "GET /weather?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 01:42:06,267 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:42:06,267 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:06,268 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:42:06,268 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:06,268 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-08-12 01:42:06,268 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:42:06.268682
2025-08-12 01:42:06,268 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:06,269 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:42:06,269 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:06,269 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-08-12 01:42:06,269 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:42:06,269 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-08-12 01:42:07,392 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:42:07,393 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-08-12 01:42:08,251 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:42:08,251 - etl.extract - INFO - Data extraction completed in 1.98 seconds
2025-08-12 01:42:08,251 - etl.extract - INFO - Data validation successful
2025-08-12 01:42:08,252 - etl.pipeline - INFO - Extraction completed in 1.98 seconds
2025-08-12 01:42:08,252 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:42:08,252 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:42:08,252 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:08,252 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:42:08,252 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:08,253 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:42:08,253 - etl.transform - INFO - Starting data transformation
2025-08-12 01:42:08,253 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:42:08,253 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:42:08,253 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:42:08,254 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 01:42:08,254 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:08,254 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:42:08,254 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:08,256 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:42:08,257 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:42:08,260 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-08-12 01:42:08,267 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_014208.csv
2025-08-12 01:42:08,278 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 01:42:08,279 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:42:08,279 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.01 SECONDS
2025-08-12 01:42:08,279 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:08,280 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:08] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-12 01:42:09,278 - __main__ - ERROR - Error in history route: type object 'WeatherRecord' has no attribute 'query'
2025-08-12 01:42:09,279 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:09] "[32mGET /history?lat=51.51&lon=-0.13 HTTP/1.1[0m" 302 -
2025-08-12 01:42:09,283 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:09] "GET / HTTP/1.1" 200 -
2025-08-12 01:42:12,438 - __main__ - INFO - Fetching fresh weather data for 27.7, 85.3
2025-08-12 01:42:12,439 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:42:12,440 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:12,440 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:42:12,440 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:12,440 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 01:42:12,440 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:42:12.440829
2025-08-12 01:42:12,440 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:12,441 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:42:12,441 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:12,441 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 01:42:12,441 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:42:12,441 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 01:42:13,537 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:42:13,537 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 01:42:14,420 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:42:14,420 - etl.extract - INFO - Data extraction completed in 1.98 seconds
2025-08-12 01:42:14,420 - etl.extract - INFO - Data validation successful
2025-08-12 01:42:14,420 - etl.pipeline - INFO - Extraction completed in 1.98 seconds
2025-08-12 01:42:14,420 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:42:14,420 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:42:14,421 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:14,421 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:42:14,421 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:14,421 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:42:14,421 - etl.transform - INFO - Starting data transformation
2025-08-12 01:42:14,421 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:42:14,422 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:42:14,422 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:42:14,422 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 01:42:14,422 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:42:14,422 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:42:14,422 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:42:14,424 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:42:14,434 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:42:14,437 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-08-12 01:42:14,443 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_014214.csv
2025-08-12 01:42:14,454 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 01:42:14,454 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:42:14,454 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.01 SECONDS
2025-08-12 01:42:14,454 - etl.pipeline - INFO - ============================================================
2025-08-12 01:42:14,456 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:14] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 01:42:14,460 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:42:14] "GET / HTTP/1.1" 200 -
2025-08-12 01:46:50,412 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:46:50,412 - etl.pipeline - INFO - ============================================================
2025-08-12 01:46:50,412 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:46:50,413 - etl.pipeline - INFO - ============================================================
2025-08-12 01:46:50,413 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 01:46:50,413 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:46:50.413289
2025-08-12 01:46:50,413 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:46:50,413 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:46:50,413 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:46:50,413 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 01:46:50,414 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:46:50,414 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 01:46:51,516 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:46:51,516 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 01:46:52,336 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:46:52,336 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 01:46:52,336 - etl.extract - INFO - Data validation successful
2025-08-12 01:46:52,337 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 01:46:52,337 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:46:52,337 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:46:52,337 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:46:52,337 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:46:52,337 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:46:52,337 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:46:52,337 - etl.transform - INFO - Starting data transformation
2025-08-12 01:46:52,338 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:46:52,338 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:46:52,338 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:46:52,338 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 01:46:52,338 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:46:52,338 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:46:52,339 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:46:52,341 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:46:52,349 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:46:52,353 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-08-12 01:46:52,353 - etl.pipeline - ERROR -  Failed to save to database
2025-08-12 01:46:52,358 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_014652.csv
2025-08-12 01:46:52,358 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_014652.csv
2025-08-12 01:46:52,360 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 01:46:52,360 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:46:52,360 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.95 SECONDS
2025-08-12 01:46:52,360 - etl.pipeline - INFO - ============================================================
2025-08-12 01:46:52,362 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:46:52] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 01:46:52,367 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:46:52] "GET / HTTP/1.1" 200 -
2025-08-12 01:48:21,636 - __main__ - INFO - Fetching fresh weather data for 40.71, -74.01
2025-08-12 01:48:21,637 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:48:21,637 - etl.pipeline - INFO - ============================================================
2025-08-12 01:48:21,638 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:48:21,638 - etl.pipeline - INFO - ============================================================
2025-08-12 01:48:21,638 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 01:48:21,638 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:48:21.638349
2025-08-12 01:48:21,638 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:48:21,638 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:48:21,638 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:48:21,638 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 01:48:21,638 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:48:21,638 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 01:48:22,751 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:48:22,752 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 01:48:23,571 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:48:23,571 - etl.extract - INFO - Data extraction completed in 1.93 seconds
2025-08-12 01:48:23,571 - etl.extract - INFO - Data validation successful
2025-08-12 01:48:23,571 - etl.pipeline - INFO - Extraction completed in 1.93 seconds
2025-08-12 01:48:23,571 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:48:23,571 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:48:23,572 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:48:23,572 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:48:23,572 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:48:23,572 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:48:23,572 - etl.transform - INFO - Starting data transformation
2025-08-12 01:48:23,572 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:48:23,573 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:48:23,573 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:48:23,573 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 01:48:23,573 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:48:23,573 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:48:23,573 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:48:23,575 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:48:23,577 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:48:23,579 - etl.load - ERROR - SQLite error: UNIQUE constraint failed: weather_records.date, weather_records.latitude, weather_records.longitude
2025-08-12 01:48:23,580 - etl.pipeline - ERROR -  Failed to save to database
2025-08-12 01:48:23,583 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_014823.csv
2025-08-12 01:48:23,583 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_014823.csv
2025-08-12 01:48:23,590 - etl.pipeline - INFO - Data loading completed in 0.01 seconds
2025-08-12 01:48:23,590 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:48:23,590 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.95 SECONDS
2025-08-12 01:48:23,590 - etl.pipeline - INFO - ============================================================
2025-08-12 01:48:23,593 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:23] "[32mGET /weather?lat=40.71&lon=-74.01 HTTP/1.1[0m" 302 -
2025-08-12 01:48:23,598 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:23] "GET / HTTP/1.1" 200 -
2025-08-12 01:48:26,529 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:26] "GET /weather?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 01:48:35,716 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:35] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 01:48:36,953 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:36] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-12 01:48:39,241 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:39] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-12 01:48:40,252 - app - ERROR - Exception on /dashboard [GET]
Traceback (most recent call last):
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\blanx\OneDrive\Desktop\Python Project\weatherpipeline\frontend\app.py", line 243, in dashboard
    return render_template('dashboard.html', dashboard_data=dashboard_data)
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\flask\templating.py", line 149, in render_template
    template = app.jinja_env.get_or_select_template(template_name_or_list)
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py", line 1087, in get_or_select_template
    return self.get_template(template_name_or_list, parent, globals)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py", line 1016, in get_template
    return self._load_template(name, globals)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py", line 975, in _load_template
    template = self.loader.load(self, name, self.make_globals(globals))
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\loaders.py", line 138, in load
    code = environment.compile(source, name, filename)
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py", line 771, in compile
    self.handle_exception(source=source_hint)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\blanx\AppData\Roaming\Python\Python313\site-packages\jinja2\environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\blanx\OneDrive\Desktop\Python Project\weatherpipeline\frontend\templates\dashboard.html", line 44, in template
    {% block title %}Statistics - Weather Insight Engine{% endblock %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.TemplateAssertionError: block 'title' defined twice
2025-08-12 01:48:40,256 - __main__ - ERROR - Internal server error: 500 Internal Server Error: The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
2025-08-12 01:48:40,258 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:40] "[35m[1mGET /dashboard HTTP/1.1[0m" 500 -
2025-08-12 01:48:41,988 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:41] "GET / HTTP/1.1" 200 -
2025-08-12 01:48:43,680 - models.database - ERROR - Error getting database stats: (sqlite3.OperationalError) no such column: data_quality_log.pipeline_version
[SQL: SELECT count(*) AS count_1 
FROM (SELECT data_quality_log.id AS data_quality_log_id, data_quality_log.timestamp AS data_quality_log_timestamp, data_quality_log.records_processed AS data_quality_log_records_processed, data_quality_log.records_saved AS data_quality_log_records_saved, data_quality_log.errors_count AS data_quality_log_errors_count, data_quality_log.processing_time_seconds AS data_quality_log_processing_time_seconds, data_quality_log.location_lat AS data_quality_log_location_lat, data_quality_log.location_lon AS data_quality_log_location_lon, data_quality_log.notes AS data_quality_log_notes, data_quality_log.pipeline_version AS data_quality_log_pipeline_version 
FROM data_quality_log) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-12 01:48:43,681 - __main__ - ERROR - Stats error: stats.html
2025-08-12 01:48:43,681 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:43] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-08-12 01:48:43,686 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:43] "GET / HTTP/1.1" 200 -
2025-08-12 01:48:45,460 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 01:48:45] "GET / HTTP/1.1" 200 -
2025-08-12 01:53:49,736 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 01:53:49,737 - etl.pipeline - INFO - ============================================================
2025-08-12 01:53:49,737 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 01:53:49,737 - etl.pipeline - INFO - ============================================================
2025-08-12 01:53:49,737 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 01:53:49,737 - etl.pipeline - INFO - Timestamp: 2025-08-12T01:53:49.737572
2025-08-12 01:53:49,737 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:53:49,737 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 01:53:49,737 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:53:49,738 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 01:53:49,738 - etl.extract - INFO - Starting complete data extraction
2025-08-12 01:53:49,738 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 01:53:50,858 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 01:53:50,858 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 01:53:51,711 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 01:53:51,711 - etl.extract - INFO - Data extraction completed in 1.97 seconds
2025-08-12 01:53:51,711 - etl.extract - INFO - Data validation successful
2025-08-12 01:53:51,712 - etl.pipeline - INFO - Extraction completed in 1.97 seconds
2025-08-12 01:53:51,712 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 01:53:51,712 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 01:53:51,712 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:53:51,712 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 01:53:51,712 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:53:51,712 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 01:53:51,712 - etl.transform - INFO - Starting data transformation
2025-08-12 01:53:51,713 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 01:53:51,713 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 01:53:51,713 - etl.pipeline - INFO - Records created: 7
2025-08-12 01:53:51,713 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 01:53:51,713 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 01:53:51,713 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 01:53:51,713 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 01:53:51,715 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 01:53:51,724 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 01:53:51,728 - etl.load - INFO - Successfully saved 7 records to SQLite: data\weather_data.db
2025-08-12 01:53:51,729 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 01:53:51,738 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 01:53:51,738 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:53:51,738 - etl.pipeline - INFO - EXECUTION SUMMARY
2025-08-12 01:53:51,738 - etl.pipeline - INFO - ============================================================
2025-08-12 01:53:51,739 - etl.pipeline - INFO - 
Location: 27.75, 85.25
2025-08-12 01:53:51,739 - etl.pipeline - INFO - Timezone: Asia/Kathmandu
2025-08-12 01:53:51,739 - etl.pipeline - INFO - Data source: open-meteo
2025-08-12 01:53:51,739 - etl.pipeline - INFO - 
Current Conditions:
2025-08-12 01:53:51,739 - etl.pipeline - INFO -   Temperature: 21.5°C
2025-08-12 01:53:51,739 - etl.pipeline - INFO -   Condition: Overcast
2025-08-12 01:53:51,739 - etl.pipeline - INFO -   Wind: 0.5 km/h SE
2025-08-12 01:53:51,739 - etl.pipeline - INFO - 
Air Quality:
2025-08-12 01:53:51,739 - etl.pipeline - INFO -   PM2.5: 0.0 µg/m³
2025-08-12 01:53:51,740 - etl.pipeline - INFO -   PM10: 0.0 µg/m³
2025-08-12 01:53:51,740 - etl.pipeline - INFO -   US AQI: 0 (Good)
2025-08-12 01:53:51,740 - etl.pipeline - INFO - 
Forecast Preview (Next 3 Days):
2025-08-12 01:53:51,740 - etl.pipeline - INFO -   2025-08-12: 21.2°C to 25.3°C, Thunderstorm
2025-08-12 01:53:51,740 - etl.pipeline - INFO -     Precipitation: 5.7 mm, UV Index: 8.95
2025-08-12 01:53:51,740 - etl.pipeline - INFO -   2025-08-13: 21.4°C to 24.5°C, Thunderstorm
2025-08-12 01:53:51,740 - etl.pipeline - INFO -     Precipitation: 22.2 mm, UV Index: 4.65
2025-08-12 01:53:51,741 - etl.pipeline - INFO -   2025-08-14: 20.5°C to 22.4°C, Thunderstorm
2025-08-12 01:53:51,741 - etl.pipeline - INFO -     Precipitation: 8.8 mm, UV Index: 1.5
2025-08-12 01:53:51,741 - etl.pipeline - INFO - 
Performance Statistics:
2025-08-12 01:53:51,741 - etl.pipeline - INFO -   Extract time: 1.97s
2025-08-12 01:53:51,741 - etl.pipeline - INFO -   Transform time: 0.00s
2025-08-12 01:53:51,741 - etl.pipeline - INFO -   Load time: 0.02s
2025-08-12 01:53:51,741 - etl.pipeline - INFO -   Total time: 2.00s
2025-08-12 01:53:51,742 - etl.pipeline - INFO - 
Data Storage:
2025-08-12 01:53:51,742 - etl.pipeline - INFO -   DATABASE: [SUCCESS] Success
2025-08-12 01:53:51,742 - etl.pipeline - INFO - 
============================================================
2025-08-12 01:53:51,742 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.00 SECONDS
2025-08-12 01:53:51,742 - etl.pipeline - INFO - ============================================================
2025-08-12 02:17:39,470 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:17:39,471 - etl.pipeline - INFO - ============================================================
2025-08-12 02:17:39,471 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:17:39,471 - etl.pipeline - INFO - ============================================================
2025-08-12 02:17:39,471 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:17:39,471 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:17:39.471380
2025-08-12 02:17:39,471 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:17:39,471 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:17:39,471 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:17:39,472 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:17:39,472 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:17:39,472 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:17:40,596 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:17:40,597 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:17:41,474 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:17:41,475 - etl.extract - INFO - Data extraction completed in 2.00 seconds
2025-08-12 02:17:41,475 - etl.extract - INFO - Data validation successful
2025-08-12 02:17:41,475 - etl.pipeline - INFO - Extraction completed in 2.00 seconds
2025-08-12 02:17:41,475 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:17:41,476 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:17:41,476 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:17:41,476 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:17:41,476 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:17:41,476 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:17:41,476 - etl.transform - INFO - Starting data transformation
2025-08-12 02:17:41,477 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:17:41,477 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:17:41,477 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:17:41,477 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:17:41,477 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:17:41,478 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:17:41,478 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:17:41,479 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:17:41,495 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:17:41,503 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:17:41,503 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:17:41,503 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:17:41,504 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:17:41,510 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_021741.csv
2025-08-12 02:17:41,511 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_021741.csv
2025-08-12 02:17:41,523 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:17:41,523 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:17:41,523 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.05 SECONDS
2025-08-12 02:17:41,523 - etl.pipeline - INFO - ============================================================
2025-08-12 02:17:41,525 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:17:41] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 02:17:41,530 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:17:41] "GET / HTTP/1.1" 200 -
2025-08-12 02:20:08,884 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:20:08,884 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:08,884 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:20:08,884 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:08,884 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:20:08,884 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:20:08.884818
2025-08-12 02:20:08,884 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:08,885 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:20:08,885 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:08,885 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:20:08,885 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:20:08,885 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:20:09,998 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:20:09,998 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:20:10,837 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:20:10,838 - etl.extract - INFO - Data extraction completed in 1.95 seconds
2025-08-12 02:20:10,838 - etl.extract - INFO - Data validation successful
2025-08-12 02:20:10,838 - etl.pipeline - INFO - Extraction completed in 1.95 seconds
2025-08-12 02:20:10,838 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:20:10,838 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:20:10,838 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:10,839 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:20:10,839 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:10,839 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:20:10,839 - etl.transform - INFO - Starting data transformation
2025-08-12 02:20:10,839 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:20:10,840 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:20:10,840 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:20:10,840 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:20:10,840 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:10,840 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:20:10,840 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:10,843 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:20:10,852 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:20:10,863 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:20:10,863 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:20:10,863 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:20:10,863 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:20:10,868 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022010.csv
2025-08-12 02:20:10,868 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022010.csv
2025-08-12 02:20:10,880 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:20:10,881 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:20:10,881 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.00 SECONDS
2025-08-12 02:20:10,881 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:10,881 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:20:10,881 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:20:10,882 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:20:10,883 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:20:10,884 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:20:10,884 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:20:10,885 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:20:10,885 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:20:10,885 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:20:10,885 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:20:10,885 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:20:10,885 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:20:10,885 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:10,886 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:20:10,914 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:10] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:20:16,968 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:16,968 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:20:16,996 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:16] "GET /forecast?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:20:20,488 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-12 02:20:21,335 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-12 02:20:21,337 - __main__ - INFO - Latest record found: False
2025-08-12 02:20:21,337 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:20:21,338 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:20:21,339 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:21,339 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:20:21,339 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:21,339 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:20:21,339 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:20:21.339877
2025-08-12 02:20:21,340 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:21,340 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:20:21,340 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:21,340 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:20:21,340 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:20:21,341 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:20:22,460 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:20:22,460 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:20:23,269 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:20:23,269 - etl.extract - INFO - Data extraction completed in 1.93 seconds
2025-08-12 02:20:23,269 - etl.extract - INFO - Data validation successful
2025-08-12 02:20:23,269 - etl.pipeline - INFO - Extraction completed in 1.93 seconds
2025-08-12 02:20:23,270 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:20:23,270 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:20:23,270 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:23,270 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:20:23,270 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:23,270 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:20:23,270 - etl.transform - INFO - Starting data transformation
2025-08-12 02:20:23,271 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:20:23,271 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:20:23,271 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:20:23,271 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:20:23,271 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:23,272 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:20:23,272 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:23,274 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:20:23,283 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:20:23,293 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:20:23,293 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:20:23,293 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:20:23,294 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:20:23,297 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022023.csv
2025-08-12 02:20:23,298 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022023.csv
2025-08-12 02:20:23,308 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:20:23,308 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:20:23,309 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.97 SECONDS
2025-08-12 02:20:23,309 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:23,309 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:20:23,309 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:20:23,310 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:20:23,311 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:20:23,312 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:20:23,312 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:20:23,312 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:20:23,312 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:20:23,312 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:20:23,313 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:20:23,313 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:20:23,313 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:20:23,313 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:23,313 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:20:23,316 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:23] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:20:25,240 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:20:25,241 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:25,241 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:20:25,241 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:25,241 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:20:25,242 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:20:25.242027
2025-08-12 02:20:25,242 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:25,242 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:20:25,242 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:25,242 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:20:25,242 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:20:25,243 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:20:26,339 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:20:26,340 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:20:27,164 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:20:27,165 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:20:27,165 - etl.extract - INFO - Data validation successful
2025-08-12 02:20:27,165 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 02:20:27,165 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:20:27,165 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:20:27,165 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:27,166 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:20:27,166 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:27,166 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:20:27,166 - etl.transform - INFO - Starting data transformation
2025-08-12 02:20:27,167 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:20:27,167 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:20:27,167 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:20:27,167 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:20:27,167 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:27,167 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:20:27,168 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:27,169 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:20:27,180 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:20:27,185 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:20:27,185 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:20:27,185 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:20:27,185 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:20:27,189 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022027.csv
2025-08-12 02:20:27,189 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_022027.csv
2025-08-12 02:20:27,200 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:20:27,201 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:20:27,201 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 02:20:27,201 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:27,202 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:27] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-12 02:20:27,235 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-12 02:20:27,236 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:27] "[32mGET /history?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 02:20:27,242 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:27] "GET / HTTP/1.1" 200 -
2025-08-12 02:20:30,468 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:30] "GET /stats HTTP/1.1" 200 -
2025-08-12 02:20:33,915 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:33] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 02:20:35,959 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:35] "GET / HTTP/1.1" 200 -
2025-08-12 02:20:37,701 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-12 02:20:38,566 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-12 02:20:38,568 - __main__ - INFO - Latest record found: False
2025-08-12 02:20:38,568 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:20:38,569 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:20:38,569 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:38,570 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:20:38,570 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:38,570 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 02:20:38,570 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:20:38.570823
2025-08-12 02:20:38,571 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:38,571 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:20:38,571 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:38,571 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 02:20:38,571 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:20:38,571 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 02:20:39,663 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:20:39,663 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 02:20:40,483 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:20:40,483 - etl.extract - INFO - Data extraction completed in 1.91 seconds
2025-08-12 02:20:40,484 - etl.extract - INFO - Data validation successful
2025-08-12 02:20:40,484 - etl.pipeline - INFO - Extraction completed in 1.91 seconds
2025-08-12 02:20:40,484 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:20:40,484 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:20:40,484 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:40,484 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:20:40,484 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:40,485 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:20:40,485 - etl.transform - INFO - Starting data transformation
2025-08-12 02:20:40,485 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:20:40,485 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:20:40,485 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:20:40,486 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:20:40,486 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:40,486 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:20:40,486 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:40,489 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:20:40,498 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:20:40,507 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:20:40,508 - etl.load - INFO -   - Inserted: 7 new records
2025-08-12 02:20:40,508 - etl.load - INFO -   - Updated: 0 existing records
2025-08-12 02:20:40,508 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:20:40,511 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_022040.csv
2025-08-12 02:20:40,511 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_022040.csv
2025-08-12 02:20:40,521 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:20:40,522 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:20:40,522 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.95 SECONDS
2025-08-12 02:20:40,522 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:40,522 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:20:40,522 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-12 02:20:40,524 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:20:40,524 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:20:40,525 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:20:40,525 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-12 02:20:40,525 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-12 02:20:40,526 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485570
2025-08-12 02:20:40,526 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485549
2025-08-12 02:20:40,526 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485537
2025-08-12 02:20:40,526 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-12 02:20:40,526 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:20:40,526 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:40,527 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:20:40,529 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:40] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:20:43,553 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:43] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 02:20:46,048 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:46,048 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:20:46,050 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:46] "GET /forecast?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:20:54,585 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-12 02:20:55,474 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-12 02:20:55,475 - __main__ - INFO - Latest record found: False
2025-08-12 02:20:55,475 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:20:55,477 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:20:55,477 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:55,477 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:20:55,477 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:55,477 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 02:20:55,478 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:20:55.477992
2025-08-12 02:20:55,478 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:55,478 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:20:55,478 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:55,478 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 02:20:55,478 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:20:55,478 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 02:20:56,583 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:20:56,583 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 02:20:57,394 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:20:57,394 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:20:57,395 - etl.extract - INFO - Data validation successful
2025-08-12 02:20:57,395 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 02:20:57,395 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:20:57,395 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:20:57,395 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:57,395 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:20:57,395 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:57,396 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:20:57,396 - etl.transform - INFO - Starting data transformation
2025-08-12 02:20:57,396 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:20:57,396 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:20:57,396 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:20:57,401 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:20:57,401 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:20:57,401 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:20:57,401 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:20:57,403 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:20:57,414 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:20:57,419 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:20:57,420 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:20:57,420 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:20:57,420 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:20:57,422 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_022057.csv
2025-08-12 02:20:57,423 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_022057.csv
2025-08-12 02:20:57,434 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:20:57,435 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:20:57,435 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 02:20:57,435 - etl.pipeline - INFO - ============================================================
2025-08-12 02:20:57,435 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:20:57,435 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-12 02:20:57,436 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:20:57,436 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:20:57,437 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:20:57,437 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-12 02:20:57,437 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-12 02:20:57,438 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485570
2025-08-12 02:20:57,438 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485549
2025-08-12 02:20:57,438 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485537
2025-08-12 02:20:57,438 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-12 02:20:57,438 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:20:57,438 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:20:57,438 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:20:57,441 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:20:57] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:21:11,019 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:21:11] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-12 02:21:13,371 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:21:13] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 02:21:19,650 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:21:19] "GET / HTTP/1.1" 200 -
2025-08-12 02:22:25,157 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:25] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 02:22:26,376 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:26] "GET /stats HTTP/1.1" 200 -
2025-08-12 02:22:29,022 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:29] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 02:22:30,006 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:30] "GET / HTTP/1.1" 200 -
2025-08-12 02:22:32,641 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 02:22:33,509 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 02:22:33,509 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 02:22:33,510 - __main__ - INFO - Latest record found: False
2025-08-12 02:22:33,511 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:22:33,513 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:22:33,513 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:33,513 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:22:33,513 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:33,513 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:22:33,513 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:22:33.513928
2025-08-12 02:22:33,514 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:33,514 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:22:33,514 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:33,514 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:22:33,514 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:22:33,514 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:22:34,612 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:22:34,612 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:22:35,453 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:22:35,454 - etl.extract - INFO - Data extraction completed in 1.94 seconds
2025-08-12 02:22:35,454 - etl.extract - INFO - Data validation successful
2025-08-12 02:22:35,454 - etl.pipeline - INFO - Extraction completed in 1.94 seconds
2025-08-12 02:22:35,454 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:22:35,454 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:22:35,454 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:35,455 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:22:35,455 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:35,455 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:22:35,455 - etl.transform - INFO - Starting data transformation
2025-08-12 02:22:35,456 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:22:35,456 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:22:35,456 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:22:35,456 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:22:35,456 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:35,456 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:22:35,456 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:35,458 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:22:35,459 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:22:35,471 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:22:35,471 - etl.load - INFO -   - Inserted: 7 new records
2025-08-12 02:22:35,471 - etl.load - INFO -   - Updated: 0 existing records
2025-08-12 02:22:35,471 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:22:35,474 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022235.csv
2025-08-12 02:22:35,474 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022235.csv
2025-08-12 02:22:35,485 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:22:35,486 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:22:35,486 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.97 SECONDS
2025-08-12 02:22:35,486 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:35,486 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:22:35,486 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 02:22:35,487 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:22:35,488 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:22:35,488 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:22:35,489 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 02:22:35,489 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 02:22:35,489 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 02:22:35,489 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 02:22:35,489 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 02:22:35,489 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 02:22:35,490 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:22:35,490 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:22:35,490 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:22:35,491 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 02:22:35,492 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:35] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:22:41,284 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:22:41,284 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:41,285 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:22:41,285 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:41,285 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:22:41,285 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:22:41.285651
2025-08-12 02:22:41,285 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:41,286 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:22:41,286 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:41,286 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:22:41,286 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:22:41,286 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:22:42,404 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:22:42,405 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:22:43,208 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:22:43,208 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:22:43,208 - etl.extract - INFO - Data validation successful
2025-08-12 02:22:43,208 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 02:22:43,208 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:22:43,209 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:22:43,209 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:43,209 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:22:43,209 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:43,209 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:22:43,209 - etl.transform - INFO - Starting data transformation
2025-08-12 02:22:43,210 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:22:43,210 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:22:43,210 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:22:43,210 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:22:43,210 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:43,210 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:22:43,211 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:43,212 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:22:43,222 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:22:43,232 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:22:43,233 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:22:43,233 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:22:43,233 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:22:43,236 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022243.csv
2025-08-12 02:22:43,236 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022243.csv
2025-08-12 02:22:43,248 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:22:43,248 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:22:43,248 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 02:22:43,249 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:43,249 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:43] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-12 02:22:44,768 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 02:22:45,620 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 02:22:45,621 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 02:22:45,622 - __main__ - INFO - Latest record found: False
2025-08-12 02:22:45,622 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:22:45,623 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:22:45,623 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:45,624 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:22:45,624 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:45,624 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:22:45,624 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:22:45.624544
2025-08-12 02:22:45,624 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:45,624 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:22:45,624 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:45,625 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:22:45,625 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:22:45,625 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:22:46,635 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:22:46,635 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:22:46,637 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:46] "GET /forecast?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:22:46,725 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:22:46,726 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:22:47,601 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:22:47,602 - etl.extract - INFO - Data extraction completed in 1.98 seconds
2025-08-12 02:22:47,602 - etl.extract - INFO - Data validation successful
2025-08-12 02:22:47,602 - etl.pipeline - INFO - Extraction completed in 1.98 seconds
2025-08-12 02:22:47,602 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:22:47,602 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:22:47,603 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:47,603 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:22:47,603 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:47,603 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:22:47,603 - etl.transform - INFO - Starting data transformation
2025-08-12 02:22:47,604 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:22:47,604 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:22:47,604 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:22:47,604 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:22:47,604 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:47,604 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:22:47,605 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:47,606 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:22:47,617 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:22:47,627 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:22:47,628 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:22:47,628 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:22:47,628 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:22:47,631 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022247.csv
2025-08-12 02:22:47,632 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022247.csv
2025-08-12 02:22:47,641 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:22:47,642 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:22:47,642 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.02 SECONDS
2025-08-12 02:22:47,642 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:47,642 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:22:47,642 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 02:22:47,644 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:22:47,644 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:22:47,645 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:22:47,645 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 02:22:47,645 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 02:22:47,645 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 02:22:47,645 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 02:22:47,645 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 02:22:47,646 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 02:22:47,646 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:22:47,646 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:22:47,646 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:22:47,647 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 02:22:47,648 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:47] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:22:48,340 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 02:22:49,217 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 02:22:49,218 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 02:22:49,219 - __main__ - INFO - Latest record found: False
2025-08-12 02:22:49,219 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:22:49,220 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:22:49,220 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:49,220 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:22:49,221 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:49,221 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:22:49,221 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:22:49.221328
2025-08-12 02:22:49,221 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:49,221 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:22:49,221 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:49,221 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:22:49,222 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:22:49,222 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:22:50,336 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:22:50,336 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:22:51,167 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:22:51,167 - etl.extract - INFO - Data extraction completed in 1.95 seconds
2025-08-12 02:22:51,167 - etl.extract - INFO - Data validation successful
2025-08-12 02:22:51,167 - etl.pipeline - INFO - Extraction completed in 1.95 seconds
2025-08-12 02:22:51,167 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:22:51,168 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:22:51,168 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:51,168 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:22:51,168 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:51,168 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:22:51,168 - etl.transform - INFO - Starting data transformation
2025-08-12 02:22:51,169 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:22:51,169 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:22:51,169 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:22:51,169 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:22:51,169 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:51,169 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:22:51,169 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:51,171 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:22:51,180 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:22:51,185 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:22:51,185 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:22:51,185 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:22:51,186 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:22:51,189 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022251.csv
2025-08-12 02:22:51,189 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_022251.csv
2025-08-12 02:22:51,199 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:22:51,199 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:22:51,199 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.98 SECONDS
2025-08-12 02:22:51,199 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:51,200 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:22:51,200 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 02:22:51,201 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:22:51,201 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:22:51,202 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:22:51,202 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 02:22:51,202 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 02:22:51,202 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 02:22:51,203 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 02:22:51,203 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 02:22:51,203 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 02:22:51,203 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:22:51,203 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:22:51,203 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:22:51,205 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 02:22:51,206 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:51] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:22:52,959 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:52] "GET / HTTP/1.1" 200 -
2025-08-12 02:22:54,577 - __main__ - INFO - Weather route called with lat=51.51, lon=-0.13
2025-08-12 02:22:55,422 - __main__ - INFO - Location name: London, England
2025-08-12 02:22:55,423 - __main__ - INFO - Attempting to get latest record for 51.51, -0.13
2025-08-12 02:22:55,424 - __main__ - INFO - Latest record found: False
2025-08-12 02:22:55,424 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:22:55,425 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:22:55,425 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:55,425 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:22:55,426 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:55,426 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-08-12 02:22:55,426 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:22:55.426455
2025-08-12 02:22:55,426 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:55,426 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:22:55,426 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:55,427 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-08-12 02:22:55,427 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:22:55,427 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-08-12 02:22:56,550 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:22:56,551 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-08-12 02:22:57,408 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:22:57,408 - etl.extract - INFO - Data extraction completed in 1.98 seconds
2025-08-12 02:22:57,409 - etl.extract - INFO - Data validation successful
2025-08-12 02:22:57,409 - etl.pipeline - INFO - Extraction completed in 1.98 seconds
2025-08-12 02:22:57,409 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:22:57,409 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:22:57,409 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:57,409 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:22:57,409 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:57,410 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:22:57,410 - etl.transform - INFO - Starting data transformation
2025-08-12 02:22:57,410 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:22:57,410 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:22:57,410 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:22:57,411 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:22:57,411 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:22:57,411 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:22:57,411 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:22:57,413 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:22:57,421 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:22:57,425 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:22:57,425 - etl.load - INFO -   - Inserted: 7 new records
2025-08-12 02:22:57,426 - etl.load - INFO -   - Updated: 0 existing records
2025-08-12 02:22:57,426 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:22:57,428 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_022257.csv
2025-08-12 02:22:57,429 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_022257.csv
2025-08-12 02:22:57,439 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:22:57,440 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:22:57,440 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.01 SECONDS
2025-08-12 02:22:57,440 - etl.pipeline - INFO - ============================================================
2025-08-12 02:22:57,440 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:22:57,440 - __main__ - INFO - Attempting to get latest record after ETL for 51.51, -0.13
2025-08-12 02:22:57,441 - __main__ - INFO - Latest record after ETL: True
2025-08-12 02:22:57,442 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:22:57,442 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:22:57,442 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.51, -0.13
2025-08-12 02:22:57,451 - __main__ - INFO - Rendering weather template for London, England
2025-08-12 02:22:57,452 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:22:57] "GET /weather?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 02:23:03,724 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:23:03,724 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 51.51, -0.13
2025-08-12 02:23:03,727 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:23:03] "GET /forecast?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 02:23:12,125 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:23:12,125 - etl.pipeline - INFO - ============================================================
2025-08-12 02:23:12,125 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:23:12,125 - etl.pipeline - INFO - ============================================================
2025-08-12 02:23:12,125 - etl.pipeline - INFO - Location: 51.51, -0.13
2025-08-12 02:23:12,126 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:23:12.125991
2025-08-12 02:23:12,126 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:23:12,126 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:23:12,126 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:23:12,126 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.51, -0.13
2025-08-12 02:23:12,126 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:23:12,126 - etl.extract - INFO - Fetching weather forecast for 51.51, -0.13
2025-08-12 02:23:13,233 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:23:13,234 - etl.extract - INFO - Fetching air quality data for 51.51, -0.13
2025-08-12 02:23:14,043 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:23:14,044 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:23:14,044 - etl.extract - INFO - Data validation successful
2025-08-12 02:23:14,044 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 02:23:14,044 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:23:14,044 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:23:14,044 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:23:14,044 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:23:14,044 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:23:14,045 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:23:14,045 - etl.transform - INFO - Starting data transformation
2025-08-12 02:23:14,045 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:23:14,045 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:23:14,045 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:23:14,046 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:23:14,046 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:23:14,046 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:23:14,046 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:23:14,048 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:23:14,058 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:23:14,068 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:23:14,069 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:23:14,069 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:23:14,069 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:23:14,079 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_022314.csv
2025-08-12 02:23:14,079 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250812_022314.csv
2025-08-12 02:23:14,091 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:23:14,091 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:23:14,091 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.97 SECONDS
2025-08-12 02:23:14,091 - etl.pipeline - INFO - ============================================================
2025-08-12 02:23:14,092 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:23:14] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-12 02:23:16,991 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:23:16,992 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 51.51, -0.13
2025-08-12 02:23:16,995 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:23:16] "GET /forecast?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 02:39:57,931 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:39:57,931 - etl.pipeline - INFO - ============================================================
2025-08-12 02:39:57,932 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:39:57,932 - etl.pipeline - INFO - ============================================================
2025-08-12 02:39:57,932 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:39:57,932 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:39:57.932354
2025-08-12 02:39:57,932 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:39:57,932 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:39:57,932 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:39:57,932 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:39:57,932 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:39:57,933 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:39:59,032 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:39:59,032 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:39:59,888 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:39:59,889 - etl.extract - INFO - Data extraction completed in 1.96 seconds
2025-08-12 02:39:59,889 - etl.extract - INFO - Data validation successful
2025-08-12 02:39:59,889 - etl.pipeline - INFO - Extraction completed in 1.96 seconds
2025-08-12 02:39:59,889 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:39:59,889 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:39:59,889 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:39:59,889 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:39:59,890 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:39:59,890 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:39:59,890 - etl.transform - INFO - Starting data transformation
2025-08-12 02:39:59,890 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:39:59,890 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:39:59,890 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:39:59,891 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:39:59,891 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:39:59,891 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:39:59,891 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:39:59,892 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:39:59,901 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:39:59,904 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:39:59,904 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:39:59,905 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:39:59,905 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:39:59,911 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_023959.csv
2025-08-12 02:39:59,911 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_023959.csv
2025-08-12 02:39:59,921 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:39:59,921 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:39:59,921 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.99 SECONDS
2025-08-12 02:39:59,921 - etl.pipeline - INFO - ============================================================
2025-08-12 02:39:59,921 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:39:59,922 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:39:59,923 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:39:59,923 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:39:59,925 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:39:59,926 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:39:59,926 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:39:59,926 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:39:59,926 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:39:59,926 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:39:59,926 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:39:59,927 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:39:59,927 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:39:59,927 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:40:00,022 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:40:00] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:40:03,297 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:40:03] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 02:40:19,216 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:40:19,217 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:40:19,273 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:40:19] "GET /forecast?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:40:20,801 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-12 02:40:21,644 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-12 02:40:21,645 - __main__ - INFO - Latest record found: False
2025-08-12 02:40:21,645 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:40:21,647 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:40:21,647 - etl.pipeline - INFO - ============================================================
2025-08-12 02:40:21,647 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:40:21,647 - etl.pipeline - INFO - ============================================================
2025-08-12 02:40:21,648 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:40:21,648 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:40:21.648181
2025-08-12 02:40:21,648 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:40:21,648 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:40:21,648 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:40:21,648 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:40:21,648 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:40:21,649 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:40:22,741 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:40:22,741 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:40:23,573 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:40:23,573 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:40:23,574 - etl.extract - INFO - Data validation successful
2025-08-12 02:40:23,574 - etl.pipeline - INFO - Extraction completed in 1.93 seconds
2025-08-12 02:40:23,574 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:40:23,574 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:40:23,574 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:40:23,574 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:40:23,575 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:40:23,575 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:40:23,575 - etl.transform - INFO - Starting data transformation
2025-08-12 02:40:23,575 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:40:23,575 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:40:23,576 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:40:23,576 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:40:23,576 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:40:23,576 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:40:23,576 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:40:23,578 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:40:23,588 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:40:23,598 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:40:23,598 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:40:23,598 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:40:23,598 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:40:23,601 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_024023.csv
2025-08-12 02:40:23,601 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_024023.csv
2025-08-12 02:40:23,612 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:40:23,612 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:40:23,612 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.97 SECONDS
2025-08-12 02:40:23,613 - etl.pipeline - INFO - ============================================================
2025-08-12 02:40:23,613 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:40:23,613 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:40:23,614 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:40:23,614 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:40:23,615 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:40:23,615 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:40:23,615 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:40:23,615 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:40:23,615 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:40:23,615 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:40:23,616 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:40:23,616 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:40:23,616 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:40:23,616 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:40:23,618 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:40:23] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:49:54,841 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:49:54,842 - etl.pipeline - INFO - ============================================================
2025-08-12 02:49:54,842 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:49:54,842 - etl.pipeline - INFO - ============================================================
2025-08-12 02:49:54,842 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:49:54,842 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:49:54.842685
2025-08-12 02:49:54,842 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:49:54,843 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:49:54,843 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:49:54,843 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:49:54,843 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:49:54,843 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:49:55,979 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:49:55,979 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:49:56,854 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:49:56,854 - etl.extract - INFO - Data extraction completed in 2.01 seconds
2025-08-12 02:49:56,854 - etl.extract - INFO - Data validation successful
2025-08-12 02:49:56,855 - etl.pipeline - INFO - Extraction completed in 2.01 seconds
2025-08-12 02:49:56,855 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:49:56,855 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:49:56,855 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:49:56,855 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:49:56,855 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:49:56,855 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:49:56,855 - etl.transform - INFO - Starting data transformation
2025-08-12 02:49:56,856 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:49:56,856 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:49:56,856 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:49:56,856 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:49:56,856 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:49:56,856 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:49:56,856 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:49:56,858 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:49:56,874 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:49:56,878 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:49:56,878 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:49:56,878 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:49:56,878 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:49:56,883 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_024956.csv
2025-08-12 02:49:56,884 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_024956.csv
2025-08-12 02:49:56,894 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-12 02:49:56,894 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:49:56,894 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.05 SECONDS
2025-08-12 02:49:56,894 - etl.pipeline - INFO - ============================================================
2025-08-12 02:49:56,894 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:49:56,894 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 02:49:56,895 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:49:56,895 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:49:56,897 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:49:56,897 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 02:49:56,897 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 02:49:56,898 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 02:49:56,898 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 02:49:56,898 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 02:49:56,898 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 02:49:56,898 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:49:56,898 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:49:56,898 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:49:56,900 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 02:49:56,918 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:49:56] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:50:00,056 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:00] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 02:50:03,398 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:03] "GET / HTTP/1.1" 200 -
2025-08-12 02:50:04,797 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-12 02:50:05,649 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-12 02:50:05,651 - __main__ - INFO - Latest record found: False
2025-08-12 02:50:05,651 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:50:05,653 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:50:05,653 - etl.pipeline - INFO - ============================================================
2025-08-12 02:50:05,653 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:50:05,653 - etl.pipeline - INFO - ============================================================
2025-08-12 02:50:05,653 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:50:05,653 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:50:05.653946
2025-08-12 02:50:05,654 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:50:05,654 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:50:05,654 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:50:05,654 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:50:05,654 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:50:05,654 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:50:06,769 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:50:06,769 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:50:07,583 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:50:07,583 - etl.extract - INFO - Data extraction completed in 1.93 seconds
2025-08-12 02:50:07,584 - etl.extract - INFO - Data validation successful
2025-08-12 02:50:07,584 - etl.pipeline - INFO - Extraction completed in 1.93 seconds
2025-08-12 02:50:07,584 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:50:07,584 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:50:07,584 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:50:07,584 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:50:07,584 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:50:07,585 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:50:07,585 - etl.transform - INFO - Starting data transformation
2025-08-12 02:50:07,585 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:50:07,585 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:50:07,586 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:50:07,586 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:50:07,586 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:50:07,586 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:50:07,586 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:50:07,588 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:50:07,597 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:50:07,601 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:50:07,601 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:50:07,602 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:50:07,602 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:50:07,606 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_025007.csv
2025-08-12 02:50:07,606 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_025007.csv
2025-08-12 02:50:07,615 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:50:07,616 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:50:07,616 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 02:50:07,616 - etl.pipeline - INFO - ============================================================
2025-08-12 02:50:07,616 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:50:07,616 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:50:07,618 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:50:07,618 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:50:07,619 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:50:07,619 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:50:07,619 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:50:07,619 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:50:07,620 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:50:07,620 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:50:07,620 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:50:07,620 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:50:07,620 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:50:07,621 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:50:07,624 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:07] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:50:09,444 - __main__ - ERROR - Stats error: stats.html
2025-08-12 02:50:09,445 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:09] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-08-12 02:50:09,453 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:09] "GET / HTTP/1.1" 200 -
2025-08-12 02:50:11,070 - __main__ - ERROR - Stats error: stats.html
2025-08-12 02:50:11,071 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:11] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-08-12 02:50:11,076 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:11] "GET / HTTP/1.1" 200 -
2025-08-12 02:50:12,290 - __main__ - ERROR - Stats error: stats.html
2025-08-12 02:50:12,291 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:12] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-08-12 02:50:12,296 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:12] "GET / HTTP/1.1" 200 -
2025-08-12 02:50:13,953 - __main__ - ERROR - Stats error: stats.html
2025-08-12 02:50:13,954 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:13] "[32mGET /stats HTTP/1.1[0m" 302 -
2025-08-12 02:50:13,958 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:50:13] "GET / HTTP/1.1" 200 -
2025-08-12 02:52:31,462 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:31] "GET /stats HTTP/1.1" 200 -
2025-08-12 02:52:35,254 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:35] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 02:52:38,833 - __main__ - INFO - Weather route called with lat=51.51, lon=-0.13
2025-08-12 02:52:39,696 - __main__ - INFO - Location name: London, England
2025-08-12 02:52:39,697 - __main__ - INFO - Attempting to get latest record for 51.51, -0.13
2025-08-12 02:52:39,698 - __main__ - INFO - Latest record found: True
2025-08-12 02:52:39,698 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:52:39,698 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:52:39,698 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.51, -0.13
2025-08-12 02:52:39,701 - __main__ - INFO - Rendering weather template for London, England
2025-08-12 02:52:39,702 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:39] "GET /weather?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 02:52:42,905 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:42] "GET / HTTP/1.1" 200 -
2025-08-12 02:52:44,408 - __main__ - INFO - Weather route called with lat=-33.87, lon=151.21
2025-08-12 02:52:45,312 - __main__ - INFO - Location name: Sydney, New South Wales
2025-08-12 02:52:45,312 - __main__ - INFO - Attempting to get latest record for -33.87, 151.21
2025-08-12 02:52:45,313 - __main__ - INFO - Latest record found: False
2025-08-12 02:52:45,313 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:52:45,315 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:52:45,315 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:45,315 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:52:45,315 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:45,315 - etl.pipeline - INFO - Location: -33.87, 151.21
2025-08-12 02:52:45,315 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:52:45.315895
2025-08-12 02:52:45,316 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:45,316 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:52:45,316 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:45,316 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.87, 151.21
2025-08-12 02:52:45,316 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:52:45,316 - etl.extract - INFO - Fetching weather forecast for -33.87, 151.21
2025-08-12 02:52:46,414 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:52:46,414 - etl.extract - INFO - Fetching air quality data for -33.87, 151.21
2025-08-12 02:52:47,233 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:52:47,233 - etl.extract - INFO - Data extraction completed in 1.92 seconds
2025-08-12 02:52:47,233 - etl.extract - INFO - Data validation successful
2025-08-12 02:52:47,234 - etl.pipeline - INFO - Extraction completed in 1.92 seconds
2025-08-12 02:52:47,234 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:52:47,234 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:52:47,234 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:47,234 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:52:47,234 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:47,234 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:52:47,235 - etl.transform - ERROR - Input data validation failed
2025-08-12 02:52:47,235 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:52:47,235 - etl.pipeline - INFO - Records created: 0
2025-08-12 02:52:47,235 - etl.pipeline - INFO - Date range: None to None
2025-08-12 02:52:47,235 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-12 02:52:47,235 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-12 02:52:47,236 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-12 02:52:47,236 - __main__ - INFO - ETL pipeline success: False
2025-08-12 02:52:47,236 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:47] "[32mGET /weather?lat=-33.87&lon=151.21 HTTP/1.1[0m" 302 -
2025-08-12 02:52:47,242 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:47] "GET / HTTP/1.1" 200 -
2025-08-12 02:52:50,211 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-12 02:52:51,075 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-12 02:52:51,076 - __main__ - INFO - Latest record found: False
2025-08-12 02:52:51,076 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:52:51,078 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:52:51,078 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:51,078 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:52:51,078 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:51,078 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 02:52:51,078 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:52:51.078919
2025-08-12 02:52:51,079 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:51,079 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:52:51,079 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:51,079 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 02:52:51,079 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:52:51,079 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 02:52:52,169 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:52:52,169 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 02:52:53,046 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:52:53,047 - etl.extract - INFO - Data extraction completed in 1.97 seconds
2025-08-12 02:52:53,047 - etl.extract - INFO - Data validation successful
2025-08-12 02:52:53,047 - etl.pipeline - INFO - Extraction completed in 1.97 seconds
2025-08-12 02:52:53,047 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:52:53,047 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:52:53,048 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:53,048 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:52:53,048 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:53,048 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:52:53,048 - etl.transform - INFO - Starting data transformation
2025-08-12 02:52:53,049 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:52:53,049 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:52:53,049 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:52:53,049 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:52:53,049 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:53,050 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:52:53,050 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:53,051 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:52:53,053 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:52:53,056 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:52:53,056 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:52:53,057 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:52:53,057 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:52:53,059 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025253.csv
2025-08-12 02:52:53,059 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025253.csv
2025-08-12 02:52:53,070 - etl.pipeline - INFO - Data loading completed in 0.01 seconds
2025-08-12 02:52:53,070 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:52:53,070 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.99 SECONDS
2025-08-12 02:52:53,070 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:53,071 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:52:53,071 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-12 02:52:53,072 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:52:53,072 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:52:53,073 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:52:53,073 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-12 02:52:53,074 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-12 02:52:53,074 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485570
2025-08-12 02:52:53,074 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485549
2025-08-12 02:52:53,074 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485537
2025-08-12 02:52:53,074 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-12 02:52:53,074 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:52:53,075 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:52:53,075 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:52:53,077 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:53] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:52:56,013 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:52:56] "GET / HTTP/1.1" 200 -
2025-08-12 02:52:58,040 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-12 02:52:58,910 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-12 02:52:58,911 - __main__ - INFO - Latest record found: False
2025-08-12 02:52:58,912 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:52:58,913 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:52:58,913 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:58,913 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:52:58,913 - etl.pipeline - INFO - ============================================================
2025-08-12 02:52:58,914 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 02:52:58,914 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:52:58.914158
2025-08-12 02:52:58,914 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:52:58,914 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:52:58,914 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:52:58,914 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 02:52:58,914 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:52:58,915 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 02:53:00,013 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:53:00,013 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 02:53:00,876 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:53:00,876 - etl.extract - INFO - Data extraction completed in 1.96 seconds
2025-08-12 02:53:00,876 - etl.extract - INFO - Data validation successful
2025-08-12 02:53:00,876 - etl.pipeline - INFO - Extraction completed in 1.96 seconds
2025-08-12 02:53:00,876 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:53:00,876 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:53:00,877 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:00,877 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:53:00,877 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:00,877 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:53:00,877 - etl.transform - INFO - Starting data transformation
2025-08-12 02:53:00,878 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:53:00,878 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:53:00,878 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:53:00,878 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:53:00,878 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:00,879 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:53:00,879 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:00,880 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:53:00,889 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:53:00,899 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:53:00,899 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:53:00,899 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:53:00,899 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:53:00,902 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_025300.csv
2025-08-12 02:53:00,902 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_025300.csv
2025-08-12 02:53:00,911 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:53:00,912 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:53:00,912 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.00 SECONDS
2025-08-12 02:53:00,912 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:00,912 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:53:00,912 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 02:53:00,913 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:53:00,914 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:53:00,914 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:53:00,915 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 02:53:00,915 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 02:53:00,915 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 02:53:00,915 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 02:53:00,915 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 02:53:00,916 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 02:53:00,916 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:53:00,916 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:53:00,916 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 02:53:00,919 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:00] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 02:53:02,829 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:02] "GET / HTTP/1.1" 200 -
2025-08-12 02:53:04,451 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 02:53:05,304 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 02:53:05,304 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 02:53:05,305 - __main__ - INFO - Latest record found: False
2025-08-12 02:53:05,305 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:53:05,307 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:53:05,307 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:05,307 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:53:05,307 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:05,307 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 02:53:05,308 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:53:05.308142
2025-08-12 02:53:05,308 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:05,308 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:53:05,308 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:05,308 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 02:53:05,308 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:53:05,309 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 02:53:06,415 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:53:06,415 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 02:53:07,250 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:53:07,250 - etl.extract - INFO - Data extraction completed in 1.94 seconds
2025-08-12 02:53:07,250 - etl.extract - INFO - Data validation successful
2025-08-12 02:53:07,251 - etl.pipeline - INFO - Extraction completed in 1.94 seconds
2025-08-12 02:53:07,251 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:53:07,251 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:53:07,251 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:07,251 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:53:07,252 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:07,252 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:53:07,252 - etl.transform - INFO - Starting data transformation
2025-08-12 02:53:07,252 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:53:07,252 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:53:07,253 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:53:07,253 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 02:53:07,253 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:07,253 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:53:07,253 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:07,255 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:53:07,264 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:53:07,274 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:53:07,274 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:53:07,274 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:53:07,274 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:53:07,277 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_025307.csv
2025-08-12 02:53:07,278 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_025307.csv
2025-08-12 02:53:07,286 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:53:07,286 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:53:07,286 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.98 SECONDS
2025-08-12 02:53:07,286 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:07,286 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:53:07,287 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 02:53:07,288 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:53:07,288 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:53:07,289 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:53:07,289 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 02:53:07,289 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 02:53:07,289 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 02:53:07,290 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 02:53:07,290 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 02:53:07,290 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 02:53:07,290 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:53:07,290 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:53:07,290 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 02:53:07,292 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 02:53:07,293 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:07] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 02:53:09,302 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:09] "GET / HTTP/1.1" 200 -
2025-08-12 02:53:10,870 - __main__ - INFO - Weather route called with lat=51.51, lon=-0.13
2025-08-12 02:53:12,734 - __main__ - INFO - Location name: London, England
2025-08-12 02:53:12,734 - __main__ - INFO - Attempting to get latest record for 51.51, -0.13
2025-08-12 02:53:12,735 - __main__ - INFO - Latest record found: True
2025-08-12 02:53:12,735 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:53:12,736 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:53:12,736 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.51, -0.13
2025-08-12 02:53:12,738 - __main__ - INFO - Rendering weather template for London, England
2025-08-12 02:53:12,739 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:12] "GET /weather?lat=51.51&lon=-0.13 HTTP/1.1" 200 -
2025-08-12 02:53:16,405 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:16] "GET / HTTP/1.1" 200 -
2025-08-12 02:53:18,260 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-12 02:53:19,119 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-12 02:53:19,120 - __main__ - INFO - Latest record found: False
2025-08-12 02:53:19,120 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:53:19,122 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:53:19,122 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:19,122 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:53:19,122 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:19,122 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 02:53:19,122 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:53:19.122956
2025-08-12 02:53:19,123 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:19,123 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:53:19,123 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:19,123 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 02:53:19,123 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:53:19,123 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 02:53:20,235 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:53:20,235 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 02:53:21,074 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:53:21,074 - etl.extract - INFO - Data extraction completed in 1.95 seconds
2025-08-12 02:53:21,075 - etl.extract - INFO - Data validation successful
2025-08-12 02:53:21,075 - etl.pipeline - INFO - Extraction completed in 1.95 seconds
2025-08-12 02:53:21,075 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:53:21,075 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:53:21,075 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:21,075 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:53:21,075 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:21,076 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:53:21,076 - etl.transform - INFO - Starting data transformation
2025-08-12 02:53:21,076 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:53:21,076 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:53:21,076 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:53:21,077 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:53:21,077 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:21,077 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:53:21,077 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:21,079 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:53:21,087 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:53:21,096 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:53:21,097 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:53:21,097 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:53:21,097 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:53:21,100 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025321.csv
2025-08-12 02:53:21,100 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025321.csv
2025-08-12 02:53:21,109 - etl.pipeline - INFO - Data loading completed in 0.02 seconds
2025-08-12 02:53:21,110 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:53:21,110 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.99 SECONDS
2025-08-12 02:53:21,110 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:21,110 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:53:21,111 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-12 02:53:21,112 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:53:21,112 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:53:21,113 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:53:21,113 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-12 02:53:21,113 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-12 02:53:21,113 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485570
2025-08-12 02:53:21,113 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485549
2025-08-12 02:53:21,114 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485537
2025-08-12 02:53:21,114 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-12 02:53:21,114 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:53:21,114 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:53:21,114 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:53:21,117 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:21] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:53:22,943 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:22] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-12 02:53:23,582 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:23] "GET / HTTP/1.1" 200 -
2025-08-12 02:53:24,901 - __main__ - INFO - Weather route called with lat=-33.87, lon=151.21
2025-08-12 02:53:25,773 - __main__ - INFO - Location name: Sydney, New South Wales
2025-08-12 02:53:25,773 - __main__ - INFO - Attempting to get latest record for -33.87, 151.21
2025-08-12 02:53:25,774 - __main__ - INFO - Latest record found: False
2025-08-12 02:53:25,775 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:53:25,776 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:53:25,776 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:25,776 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:53:25,776 - etl.pipeline - INFO - ============================================================
2025-08-12 02:53:25,777 - etl.pipeline - INFO - Location: -33.87, 151.21
2025-08-12 02:53:25,777 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:53:25.777214
2025-08-12 02:53:25,777 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:25,777 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:53:25,777 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:25,777 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.87, 151.21
2025-08-12 02:53:25,778 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:53:25,778 - etl.extract - INFO - Fetching weather forecast for -33.87, 151.21
2025-08-12 02:53:27,147 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:53:27,147 - etl.extract - INFO - Fetching air quality data for -33.87, 151.21
2025-08-12 02:53:28,050 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:53:28,050 - etl.extract - INFO - Data extraction completed in 2.27 seconds
2025-08-12 02:53:28,051 - etl.extract - INFO - Data validation successful
2025-08-12 02:53:28,051 - etl.pipeline - INFO - Extraction completed in 2.27 seconds
2025-08-12 02:53:28,051 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:53:28,051 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:53:28,051 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:53:28,052 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:53:28,052 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:53:28,052 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:53:28,052 - etl.transform - ERROR - Input data validation failed
2025-08-12 02:53:28,052 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:53:28,052 - etl.pipeline - INFO - Records created: 0
2025-08-12 02:53:28,052 - etl.pipeline - INFO - Date range: None to None
2025-08-12 02:53:28,053 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-12 02:53:28,053 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-12 02:53:28,053 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-12 02:53:28,053 - __main__ - INFO - ETL pipeline success: False
2025-08-12 02:53:28,054 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:28] "[32mGET /weather?lat=-33.87&lon=151.21 HTTP/1.1[0m" 302 -
2025-08-12 02:53:28,060 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:53:28] "GET / HTTP/1.1" 200 -
2025-08-12 02:55:38,721 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-12 02:55:39,608 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-12 02:55:39,609 - __main__ - INFO - Latest record found: False
2025-08-12 02:55:39,609 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 02:55:39,610 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 02:55:39,610 - etl.pipeline - INFO - ============================================================
2025-08-12 02:55:39,611 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 02:55:39,611 - etl.pipeline - INFO - ============================================================
2025-08-12 02:55:39,611 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-12 02:55:39,611 - etl.pipeline - INFO - Timestamp: 2025-08-12T02:55:39.611431
2025-08-12 02:55:39,611 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:55:39,611 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 02:55:39,611 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:55:39,612 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-12 02:55:39,612 - etl.extract - INFO - Starting complete data extraction
2025-08-12 02:55:39,612 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-12 02:55:40,727 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 02:55:40,727 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-12 02:55:41,547 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 02:55:41,548 - etl.extract - INFO - Data extraction completed in 1.94 seconds
2025-08-12 02:55:41,548 - etl.extract - INFO - Data validation successful
2025-08-12 02:55:41,548 - etl.pipeline - INFO - Extraction completed in 1.94 seconds
2025-08-12 02:55:41,548 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 02:55:41,548 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 02:55:41,548 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:55:41,548 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 02:55:41,549 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:55:41,549 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 02:55:41,549 - etl.transform - INFO - Starting data transformation
2025-08-12 02:55:41,549 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 02:55:41,549 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 02:55:41,549 - etl.pipeline - INFO - Records created: 7
2025-08-12 02:55:41,550 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 02:55:41,550 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 02:55:41,550 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 02:55:41,550 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 02:55:41,551 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 02:55:41,552 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 02:55:41,561 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 02:55:41,562 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 02:55:41,562 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 02:55:41,562 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 02:55:41,564 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025541.csv
2025-08-12 02:55:41,564 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250812_025541.csv
2025-08-12 02:55:41,573 - etl.pipeline - INFO - Data loading completed in 0.01 seconds
2025-08-12 02:55:41,573 - etl.pipeline - INFO - 
============================================================
2025-08-12 02:55:41,573 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.96 SECONDS
2025-08-12 02:55:41,573 - etl.pipeline - INFO - ============================================================
2025-08-12 02:55:41,573 - __main__ - INFO - ETL pipeline success: True
2025-08-12 02:55:41,574 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-12 02:55:41,574 - __main__ - INFO - Latest record after ETL: False
2025-08-12 02:55:41,575 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 02:55:41,575 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 02:55:41,575 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-12 02:55:41,575 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-12 02:55:41,576 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485570
2025-08-12 02:55:41,576 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485549
2025-08-12 02:55:41,576 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485537
2025-08-12 02:55:41,576 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-12 02:55:41,576 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 02:55:41,576 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 02:55:41,576 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-12 02:55:41,579 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:55:41] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-12 02:55:44,632 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-12 02:55:44,632 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:55:44] "[32mGET /history?lat=35.69&lon=139.69 HTTP/1.1[0m" 302 -
2025-08-12 02:55:44,637 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 02:55:44] "GET / HTTP/1.1" 200 -
2025-08-12 07:46:58,071 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 07:46:58,071 - etl.pipeline - INFO - ============================================================
2025-08-12 07:46:58,072 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 07:46:58,072 - etl.pipeline - INFO - ============================================================
2025-08-12 07:46:58,072 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 07:46:58,073 - etl.pipeline - INFO - Timestamp: 2025-08-12T07:46:58.073221
2025-08-12 07:46:58,073 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:46:58,073 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 07:46:58,074 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:46:58,074 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 07:46:58,074 - etl.extract - INFO - Starting complete data extraction
2025-08-12 07:46:58,074 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 07:47:00,001 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 07:47:00,002 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 07:47:01,536 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 07:47:01,536 - etl.extract - INFO - Data extraction completed in 3.46 seconds
2025-08-12 07:47:01,537 - etl.extract - INFO - Data validation successful
2025-08-12 07:47:01,537 - etl.pipeline - INFO - Extraction completed in 3.46 seconds
2025-08-12 07:47:01,538 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 07:47:01,538 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 07:47:01,538 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:01,538 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 07:47:01,539 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:01,539 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 07:47:01,539 - etl.transform - INFO - Starting data transformation
2025-08-12 07:47:01,540 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 07:47:01,540 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 07:47:01,541 - etl.pipeline - INFO - Records created: 7
2025-08-12 07:47:01,541 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 07:47:01,541 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:01,541 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 07:47:01,542 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:01,557 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 07:47:01,579 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 07:47:01,592 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 07:47:01,593 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 07:47:01,593 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 07:47:01,593 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 07:47:01,612 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_074701.csv
2025-08-12 07:47:01,613 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_074701.csv
2025-08-12 07:47:01,636 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-08-12 07:47:01,637 - etl.pipeline - INFO - 
============================================================
2025-08-12 07:47:01,637 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 3.57 SECONDS
2025-08-12 07:47:01,638 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:01,638 - __main__ - INFO - ETL pipeline success: True
2025-08-12 07:47:01,638 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 07:47:01,641 - __main__ - INFO - Latest record after ETL: False
2025-08-12 07:47:01,641 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 07:47:01,645 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 07:47:01,645 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 07:47:01,645 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 07:47:01,646 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 07:47:01,646 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 07:47:01,646 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 07:47:01,647 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 07:47:01,647 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 07:47:01,647 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 07:47:01,648 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 07:47:01,654 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 07:47:01,693 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:01] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 07:47:12,907 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 07:47:12,908 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 40.71, -74.01
2025-08-12 07:47:12,960 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:12] "GET /forecast?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 07:47:16,498 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:16] "GET / HTTP/1.1" 200 -
2025-08-12 07:47:18,515 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-12 07:47:19,478 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-12 07:47:19,480 - __main__ - INFO - Latest record found: False
2025-08-12 07:47:19,481 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 07:47:19,483 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 07:47:19,483 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:19,483 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 07:47:19,484 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:19,484 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-12 07:47:19,484 - etl.pipeline - INFO - Timestamp: 2025-08-12T07:47:19.484757
2025-08-12 07:47:19,485 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:19,486 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 07:47:19,486 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:19,487 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-12 07:47:19,487 - etl.extract - INFO - Starting complete data extraction
2025-08-12 07:47:19,487 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-12 07:47:20,684 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 07:47:20,685 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-12 07:47:22,021 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 07:47:22,022 - etl.extract - INFO - Data extraction completed in 2.53 seconds
2025-08-12 07:47:22,022 - etl.extract - INFO - Data validation successful
2025-08-12 07:47:22,023 - etl.pipeline - INFO - Extraction completed in 2.54 seconds
2025-08-12 07:47:22,023 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 07:47:22,023 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 07:47:22,024 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:22,024 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 07:47:22,024 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:22,024 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 07:47:22,025 - etl.transform - INFO - Starting data transformation
2025-08-12 07:47:22,025 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 07:47:22,026 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 07:47:22,026 - etl.pipeline - INFO - Records created: 7
2025-08-12 07:47:22,027 - etl.pipeline - INFO - Date range: 2025-08-12 to 2025-08-18
2025-08-12 07:47:22,027 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:22,027 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 07:47:22,028 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:22,032 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 07:47:22,053 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 07:47:22,061 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 07:47:22,061 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 07:47:22,061 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 07:47:22,062 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 07:47:22,068 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_074722.csv
2025-08-12 07:47:22,069 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250812_074722.csv
2025-08-12 07:47:22,091 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-12 07:47:22,091 - etl.pipeline - INFO - 
============================================================
2025-08-12 07:47:22,092 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.61 SECONDS
2025-08-12 07:47:22,092 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:22,092 - __main__ - INFO - ETL pipeline success: True
2025-08-12 07:47:22,093 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-12 07:47:22,095 - __main__ - INFO - Latest record after ETL: False
2025-08-12 07:47:22,095 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 07:47:22,097 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 07:47:22,097 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-12 07:47:22,097 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-12 07:47:22,098 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-12 07:47:22,098 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712963
2025-08-12 07:47:22,098 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712951
2025-08-12 07:47:22,099 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-12 07:47:22,099 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 07:47:22,099 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 07:47:22,099 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-12 07:47:22,105 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:22] "GET /weather?lat=27.7&lon=85.3 HTTP/1.1" 200 -
2025-08-12 07:47:47,006 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:47] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 07:47:49,316 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-12 07:47:49,317 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:49] "[32mGET /history?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-12 07:47:49,329 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:49] "GET / HTTP/1.1" 200 -
2025-08-12 07:47:55,308 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 07:47:56,220 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 07:47:56,221 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 07:47:56,224 - __main__ - INFO - Latest record found: False
2025-08-12 07:47:56,225 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 07:47:56,229 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 07:47:56,229 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:56,230 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 07:47:56,230 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:56,231 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 07:47:56,232 - etl.pipeline - INFO - Timestamp: 2025-08-12T07:47:56.231977
2025-08-12 07:47:56,232 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:56,232 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 07:47:56,232 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:56,233 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 07:47:56,233 - etl.extract - INFO - Starting complete data extraction
2025-08-12 07:47:56,234 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 07:47:57,455 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 07:47:57,455 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 07:47:58,790 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 07:47:58,790 - etl.extract - INFO - Data extraction completed in 2.56 seconds
2025-08-12 07:47:58,791 - etl.extract - INFO - Data validation successful
2025-08-12 07:47:58,791 - etl.pipeline - INFO - Extraction completed in 2.56 seconds
2025-08-12 07:47:58,791 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 07:47:58,792 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 07:47:58,792 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:58,792 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 07:47:58,792 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:58,793 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 07:47:58,793 - etl.transform - INFO - Starting data transformation
2025-08-12 07:47:58,794 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 07:47:58,794 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 07:47:58,794 - etl.pipeline - INFO - Records created: 7
2025-08-12 07:47:58,795 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 07:47:58,795 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:47:58,795 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 07:47:58,795 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:47:58,799 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 07:47:58,818 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 07:47:58,830 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 07:47:58,830 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 07:47:58,830 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 07:47:58,831 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 07:47:58,836 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_074758.csv
2025-08-12 07:47:58,836 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_074758.csv
2025-08-12 07:47:58,853 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-12 07:47:58,854 - etl.pipeline - INFO - 
============================================================
2025-08-12 07:47:58,854 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.62 SECONDS
2025-08-12 07:47:58,854 - etl.pipeline - INFO - ============================================================
2025-08-12 07:47:58,854 - __main__ - INFO - ETL pipeline success: True
2025-08-12 07:47:58,855 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 07:47:58,858 - __main__ - INFO - Latest record after ETL: False
2025-08-12 07:47:58,858 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 07:47:58,860 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 07:47:58,861 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 07:47:58,861 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 07:47:58,861 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 07:47:58,862 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 07:47:58,862 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 07:47:58,862 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 07:47:58,863 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 07:47:58,863 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 07:47:58,863 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 07:47:58,866 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 07:47:58,868 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:47:58] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 07:58:00,084 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 07:58:00,085 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:00,085 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 07:58:00,085 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:00,086 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 07:58:00,087 - etl.pipeline - INFO - Timestamp: 2025-08-12T07:58:00.087243
2025-08-12 07:58:00,087 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:00,087 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 07:58:00,088 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:00,088 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 07:58:00,088 - etl.extract - INFO - Starting complete data extraction
2025-08-12 07:58:00,088 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 07:58:01,638 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 07:58:01,638 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 07:58:02,973 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 07:58:02,974 - etl.extract - INFO - Data extraction completed in 2.89 seconds
2025-08-12 07:58:02,974 - etl.extract - INFO - Data validation successful
2025-08-12 07:58:02,974 - etl.pipeline - INFO - Extraction completed in 2.89 seconds
2025-08-12 07:58:02,975 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 07:58:02,975 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 07:58:02,975 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:02,976 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 07:58:02,976 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:02,976 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 07:58:02,976 - etl.transform - INFO - Starting data transformation
2025-08-12 07:58:02,977 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 07:58:02,977 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 07:58:02,978 - etl.pipeline - INFO - Records created: 7
2025-08-12 07:58:02,978 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 07:58:02,978 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:02,979 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 07:58:02,979 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:02,982 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 07:58:03,013 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 07:58:03,020 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 07:58:03,020 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 07:58:03,020 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 07:58:03,021 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 07:58:03,026 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_075803.csv
2025-08-12 07:58:03,026 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_075803.csv
2025-08-12 07:58:03,044 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-12 07:58:03,045 - etl.pipeline - INFO - 
============================================================
2025-08-12 07:58:03,045 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.96 SECONDS
2025-08-12 07:58:03,045 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:03,046 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:58:03] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-12 07:58:05,092 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-12 07:58:06,134 - __main__ - INFO - Location name: City of New York, New York
2025-08-12 07:58:06,134 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-12 07:58:06,136 - __main__ - INFO - Latest record found: False
2025-08-12 07:58:06,137 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 07:58:06,139 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 07:58:06,140 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:06,140 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 07:58:06,140 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:06,141 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-12 07:58:06,141 - etl.pipeline - INFO - Timestamp: 2025-08-12T07:58:06.141310
2025-08-12 07:58:06,141 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:06,141 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 07:58:06,142 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:06,142 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-12 07:58:06,142 - etl.extract - INFO - Starting complete data extraction
2025-08-12 07:58:06,143 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-12 07:58:07,300 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 07:58:07,301 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-12 07:58:08,475 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 07:58:08,476 - etl.extract - INFO - Data extraction completed in 2.33 seconds
2025-08-12 07:58:08,476 - etl.extract - INFO - Data validation successful
2025-08-12 07:58:08,477 - etl.pipeline - INFO - Extraction completed in 2.33 seconds
2025-08-12 07:58:08,477 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 07:58:08,477 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 07:58:08,477 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:08,478 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 07:58:08,478 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:08,478 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 07:58:08,479 - etl.transform - INFO - Starting data transformation
2025-08-12 07:58:08,479 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-12 07:58:08,480 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 07:58:08,480 - etl.pipeline - INFO - Records created: 7
2025-08-12 07:58:08,480 - etl.pipeline - INFO - Date range: 2025-08-11 to 2025-08-17
2025-08-12 07:58:08,481 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 07:58:08,481 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-12 07:58:08,481 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 07:58:08,484 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-12 07:58:08,499 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-12 07:58:08,511 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-12 07:58:08,512 - etl.load - INFO -   - Inserted: 0 new records
2025-08-12 07:58:08,512 - etl.load - INFO -   - Updated: 7 existing records
2025-08-12 07:58:08,513 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-12 07:58:08,518 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_075808.csv
2025-08-12 07:58:08,519 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250812_075808.csv
2025-08-12 07:58:08,536 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-12 07:58:08,536 - etl.pipeline - INFO - 
============================================================
2025-08-12 07:58:08,537 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 2.40 SECONDS
2025-08-12 07:58:08,537 - etl.pipeline - INFO - ============================================================
2025-08-12 07:58:08,537 - __main__ - INFO - ETL pipeline success: True
2025-08-12 07:58:08,538 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-12 07:58:08,539 - __main__ - INFO - Latest record after ETL: False
2025-08-12 07:58:08,540 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-12 07:58:08,541 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-12 07:58:08,542 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-12 07:58:08,542 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-12 07:58:08,542 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456026
2025-08-12 07:58:08,543 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456015
2025-08-12 07:58:08,543 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456002
2025-08-12 07:58:08,544 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-12 07:58:08,544 - __main__ - INFO - Weather record found: temp=N/A
2025-08-12 07:58:08,544 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-12 07:58:08,545 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-12 07:58:08,557 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-12 07:58:08,559 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 07:58:08] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-12 08:03:36,286 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:36] "POST /add-favorite HTTP/1.1" 200 -
2025-08-12 08:03:37,435 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:37] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 08:03:40,012 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:40] "GET / HTTP/1.1" 200 -
2025-08-12 08:03:48,142 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:48] "GET /dashboard HTTP/1.1" 200 -
2025-08-12 08:03:49,516 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:49] "GET /stats HTTP/1.1" 200 -
2025-08-12 08:03:55,805 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:03:55] "GET / HTTP/1.1" 200 -
2025-08-12 08:04:07,459 - __main__ - INFO - Weather route called with lat=-33.87, lon=151.21
2025-08-12 08:04:08,548 - __main__ - INFO - Location name: Sydney, New South Wales
2025-08-12 08:04:08,548 - __main__ - INFO - Attempting to get latest record for -33.87, 151.21
2025-08-12 08:04:08,550 - __main__ - INFO - Latest record found: False
2025-08-12 08:04:08,550 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-12 08:04:08,552 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-12 08:04:08,553 - etl.pipeline - INFO - ============================================================
2025-08-12 08:04:08,553 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-12 08:04:08,554 - etl.pipeline - INFO - ============================================================
2025-08-12 08:04:08,554 - etl.pipeline - INFO - Location: -33.87, 151.21
2025-08-12 08:04:08,554 - etl.pipeline - INFO - Timestamp: 2025-08-12T08:04:08.554717
2025-08-12 08:04:08,555 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 08:04:08,555 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-12 08:04:08,555 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 08:04:08,555 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.87, 151.21
2025-08-12 08:04:08,556 - etl.extract - INFO - Starting complete data extraction
2025-08-12 08:04:08,556 - etl.extract - INFO - Fetching weather forecast for -33.87, 151.21
2025-08-12 08:04:09,875 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-12 08:04:09,875 - etl.extract - INFO - Fetching air quality data for -33.87, 151.21
2025-08-12 08:04:11,102 - etl.extract - INFO - Air quality data fetched successfully
2025-08-12 08:04:11,102 - etl.extract - INFO - Data extraction completed in 2.55 seconds
2025-08-12 08:04:11,102 - etl.extract - INFO - Data validation successful
2025-08-12 08:04:11,103 - etl.pipeline - INFO - Extraction completed in 2.55 seconds
2025-08-12 08:04:11,103 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-12 08:04:11,104 - etl.pipeline - INFO - Air quality data points: 120
2025-08-12 08:04:11,104 - etl.pipeline - INFO - 
----------------------------------------
2025-08-12 08:04:11,104 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-12 08:04:11,104 - etl.pipeline - INFO - ----------------------------------------
2025-08-12 08:04:11,105 - etl.transform - INFO - WeatherTransformer initialized
2025-08-12 08:04:11,105 - etl.transform - ERROR - Input data validation failed
2025-08-12 08:04:11,105 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-12 08:04:11,105 - etl.pipeline - INFO - Records created: 0
2025-08-12 08:04:11,106 - etl.pipeline - INFO - Date range: None to None
2025-08-12 08:04:11,106 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-12 08:04:11,106 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-12 08:04:11,107 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-12 08:04:11,107 - __main__ - INFO - ETL pipeline success: False
2025-08-12 08:04:11,108 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:04:11] "[32mGET /weather?lat=-33.87&lon=151.21 HTTP/1.1[0m" 302 -
2025-08-12 08:04:11,116 - werkzeug - INFO - 127.0.0.1 - - [12/Aug/2025 08:04:11] "GET / HTTP/1.1" 200 -
2025-08-14 22:14:40,595 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:14:40,596 - etl.pipeline - INFO - ============================================================
2025-08-14 22:14:40,596 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:14:40,596 - etl.pipeline - INFO - ============================================================
2025-08-14 22:14:40,597 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 22:14:40,597 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:14:40.597701
2025-08-14 22:14:40,597 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:14:40,598 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:14:40,598 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:14:40,598 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 22:14:40,599 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:14:40,599 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 22:14:41,420 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:14:41,420 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 22:14:42,266 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:14:42,267 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 22:14:42,267 - etl.extract - INFO - Data validation successful
2025-08-14 22:14:42,267 - etl.pipeline - INFO - Extraction completed in 1.67 seconds
2025-08-14 22:14:42,268 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:14:42,268 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:14:42,268 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:14:42,269 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:14:42,269 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:14:42,269 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:14:42,269 - etl.transform - INFO - Starting data transformation
2025-08-14 22:14:42,270 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:14:42,270 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:14:42,270 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:14:42,271 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:14:42,271 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:14:42,271 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:14:42,272 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:14:42,291 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:14:42,296 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:14:42,319 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:14:42,320 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 22:14:42,321 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 22:14:42,321 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:14:42,366 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_221442.csv
2025-08-14 22:14:42,367 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_221442.csv
2025-08-14 22:14:42,398 - etl.pipeline - INFO - Data loading completed in 0.10 seconds
2025-08-14 22:14:42,399 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:14:42,401 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.80 SECONDS
2025-08-14 22:14:42,402 - etl.pipeline - INFO - ============================================================
2025-08-14 22:14:42,403 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:14:42,403 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 22:14:42,406 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:14:42,406 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:14:42,417 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:14:42,418 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:14:42,418 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:14:42,418 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:14:42,418 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:14:42,420 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:14:42,420 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 22:14:42,420 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:14:42,420 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:14:42,421 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 22:14:42,686 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:14:42] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 22:24:43,282 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:24:43,283 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:43,284 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:24:43,286 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:43,287 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 22:24:43,288 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:24:43.287778
2025-08-14 22:24:43,289 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:43,291 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:24:43,292 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:43,293 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 22:24:43,293 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:24:43,295 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 22:24:44,130 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:24:44,131 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 22:24:44,971 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:24:44,971 - etl.extract - INFO - Data extraction completed in 1.68 seconds
2025-08-14 22:24:44,972 - etl.extract - INFO - Data validation successful
2025-08-14 22:24:44,973 - etl.pipeline - INFO - Extraction completed in 1.68 seconds
2025-08-14 22:24:44,974 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:24:44,975 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:24:44,975 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:44,976 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:24:44,977 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:44,977 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:24:44,979 - etl.transform - INFO - Starting data transformation
2025-08-14 22:24:44,981 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:24:44,981 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:24:44,983 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:24:44,984 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:24:44,985 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:44,985 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:24:44,986 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:45,002 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:24:45,008 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:24:45,048 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:24:45,048 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 22:24:45,049 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 22:24:45,049 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:24:45,062 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_222445.csv
2025-08-14 22:24:45,062 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_222445.csv
2025-08-14 22:24:45,086 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 22:24:45,086 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:24:45,088 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.80 SECONDS
2025-08-14 22:24:45,089 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:45,092 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:24:45] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-14 22:24:47,247 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 22:24:48,510 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 22:24:48,535 - __main__ - INFO - Latest record found: False
2025-08-14 22:24:48,536 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 22:24:48,541 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:24:48,542 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:48,542 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:24:48,543 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:48,544 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 22:24:48,545 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:24:48.545612
2025-08-14 22:24:48,546 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:48,547 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:24:48,548 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:48,549 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 22:24:48,550 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:24:48,551 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 22:24:49,355 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:24:49,355 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 22:24:50,215 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:24:50,216 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 22:24:50,216 - etl.extract - INFO - Data validation successful
2025-08-14 22:24:50,216 - etl.pipeline - INFO - Extraction completed in 1.67 seconds
2025-08-14 22:24:50,218 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:24:50,218 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:24:50,218 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:50,218 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:24:50,219 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:50,219 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:24:50,219 - etl.transform - INFO - Starting data transformation
2025-08-14 22:24:50,220 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:24:50,220 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:24:50,221 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:24:50,222 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:24:50,222 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:24:50,222 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:24:50,223 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:24:50,228 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:24:50,246 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:24:50,253 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:24:50,254 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 22:24:50,254 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 22:24:50,255 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:24:50,258 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_222450.csv
2025-08-14 22:24:50,258 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_222450.csv
2025-08-14 22:24:50,291 - etl.pipeline - INFO - Data loading completed in 0.03 seconds
2025-08-14 22:24:50,291 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:24:50,292 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-08-14 22:24:50,292 - etl.pipeline - INFO - ============================================================
2025-08-14 22:24:50,293 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:24:50,293 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 22:24:50,294 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:24:50,294 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:24:50,296 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:24:50,296 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:24:50,297 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:24:50,297 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:24:50,297 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:24:50,298 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:24:50,298 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 22:24:50,298 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:24:50,298 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:24:50,299 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 22:24:50,303 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:24:50] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 22:34:28,731 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:28] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 22:34:30,191 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:30] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 22:34:33,271 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:33] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 22:34:35,924 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:35] "GET / HTTP/1.1" 200 -
2025-08-14 22:34:44,084 - __main__ - INFO - Weather route called with lat=26.6622505, lon=87.2748964
2025-08-14 22:34:45,252 - __main__ - INFO - Attempting to get latest record for 26.6622505, 87.2748964
2025-08-14 22:34:45,258 - __main__ - INFO - Latest record found: False
2025-08-14 22:34:45,259 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 22:34:45,274 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:34:45,276 - etl.pipeline - INFO - ============================================================
2025-08-14 22:34:45,277 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:34:45,278 - etl.pipeline - INFO - ============================================================
2025-08-14 22:34:45,279 - etl.pipeline - INFO - Location: 26.6622505, 87.2748964
2025-08-14 22:34:45,285 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:34:45.284346
2025-08-14 22:34:45,289 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:34:45,291 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:34:45,292 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:34:45,293 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.6622505, 87.2748964
2025-08-14 22:34:45,295 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:34:45,295 - etl.extract - INFO - Fetching weather forecast for 26.6622505, 87.2748964
2025-08-14 22:34:46,093 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:34:46,094 - etl.extract - INFO - Fetching air quality data for 26.6622505, 87.2748964
2025-08-14 22:34:46,968 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:34:46,969 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 22:34:46,969 - etl.extract - INFO - Data validation successful
2025-08-14 22:34:46,969 - etl.pipeline - INFO - Extraction completed in 1.68 seconds
2025-08-14 22:34:46,969 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:34:46,970 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:34:46,970 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:34:46,970 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:34:46,970 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:34:46,971 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:34:46,971 - etl.transform - INFO - Starting data transformation
2025-08-14 22:34:46,972 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:34:46,973 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:34:46,973 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:34:46,973 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:34:46,974 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:34:46,974 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:34:46,974 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:34:46,994 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:34:46,998 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:34:47,012 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:34:47,013 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 22:34:47,015 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 22:34:47,015 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:34:47,036 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_223447.csv
2025-08-14 22:34:47,037 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_223447.csv
2025-08-14 22:34:47,076 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 22:34:47,077 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:34:47,078 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.80 SECONDS
2025-08-14 22:34:47,079 - etl.pipeline - INFO - ============================================================
2025-08-14 22:34:47,079 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:34:47,079 - __main__ - INFO - Attempting to get latest record after ETL for 26.6622505, 87.2748964
2025-08-14 22:34:47,082 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:34:47,083 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:34:47,087 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:34:47,089 - __main__ - INFO - Record 1: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:34:47,091 - __main__ - INFO - Record 2: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:34:47,091 - __main__ - INFO - Record 3: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:34:47,092 - __main__ - INFO - Record 4: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:34:47,092 - __main__ - INFO - Record 5: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:34:47,092 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.25
2025-08-14 22:34:47,093 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:34:47,093 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:34:47,094 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.6622505, 87.2748964
2025-08-14 22:34:47,103 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:47] "GET /weather?lat=26.6622505&lon=87.2748964 HTTP/1.1" 200 -
2025-08-14 22:34:51,822 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:51] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 22:34:53,865 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:34:53] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 22:35:06,916 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-14 22:35:06,919 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:35:06] "[32mGET /history?lat=26.6622505&lon=87.2748964 HTTP/1.1[0m" 302 -
2025-08-14 22:35:06,928 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:35:06] "GET / HTTP/1.1" 200 -
2025-08-14 22:36:09,701 - __main__ - INFO - Weather route called with lat=26.6622505, lon=87.2748964
2025-08-14 22:36:10,866 - __main__ - INFO - Attempting to get latest record for 26.6622505, 87.2748964
2025-08-14 22:36:10,876 - __main__ - INFO - Latest record found: False
2025-08-14 22:36:10,878 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 22:36:10,894 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:36:10,895 - etl.pipeline - INFO - ============================================================
2025-08-14 22:36:10,896 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:36:10,897 - etl.pipeline - INFO - ============================================================
2025-08-14 22:36:10,898 - etl.pipeline - INFO - Location: 26.6622505, 87.2748964
2025-08-14 22:36:10,898 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:36:10.898985
2025-08-14 22:36:10,900 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:36:10,902 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:36:10,903 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:36:10,905 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.6622505, 87.2748964
2025-08-14 22:36:10,907 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:36:10,908 - etl.extract - INFO - Fetching weather forecast for 26.6622505, 87.2748964
2025-08-14 22:36:11,706 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:36:11,707 - etl.extract - INFO - Fetching air quality data for 26.6622505, 87.2748964
2025-08-14 22:36:12,630 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:36:12,632 - etl.extract - INFO - Data extraction completed in 1.72 seconds
2025-08-14 22:36:12,633 - etl.extract - INFO - Data validation successful
2025-08-14 22:36:12,637 - etl.pipeline - INFO - Extraction completed in 1.73 seconds
2025-08-14 22:36:12,639 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:36:12,639 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:36:12,640 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:36:12,642 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:36:12,642 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:36:12,642 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:36:12,644 - etl.transform - INFO - Starting data transformation
2025-08-14 22:36:12,646 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:36:12,646 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:36:12,647 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:36:12,647 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:36:12,648 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:36:12,648 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:36:12,649 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:36:12,655 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:36:12,659 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:36:12,677 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:36:12,678 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 22:36:12,678 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 22:36:12,679 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:36:12,696 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_223612.csv
2025-08-14 22:36:12,697 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_223612.csv
2025-08-14 22:36:12,731 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-14 22:36:12,733 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:36:12,735 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.84 SECONDS
2025-08-14 22:36:12,736 - etl.pipeline - INFO - ============================================================
2025-08-14 22:36:12,737 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:36:12,737 - __main__ - INFO - Attempting to get latest record after ETL for 26.6622505, 87.2748964
2025-08-14 22:36:12,741 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:36:12,742 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:36:12,749 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:36:12,750 - __main__ - INFO - Record 1: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:36:12,751 - __main__ - INFO - Record 2: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:36:12,752 - __main__ - INFO - Record 3: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:36:12,753 - __main__ - INFO - Record 4: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:36:12,754 - __main__ - INFO - Record 5: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:36:12,754 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.25
2025-08-14 22:36:12,755 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:36:12,755 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:36:12,756 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.6622505, 87.2748964
2025-08-14 22:36:12,769 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:36:12] "GET /weather?lat=26.6622505&lon=87.2748964 HTTP/1.1" 200 -
2025-08-14 22:36:24,089 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-14 22:36:24,091 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:36:24] "[32mGET /history?lat=26.6622505&lon=87.2748964 HTTP/1.1[0m" 302 -
2025-08-14 22:36:24,102 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:36:24] "GET / HTTP/1.1" 200 -
2025-08-14 22:40:15,810 - __main__ - INFO - Weather route called with lat=26.6622505, lon=87.2748964
2025-08-14 22:40:17,008 - __main__ - INFO - Attempting to get latest record for 26.6622505, 87.2748964
2025-08-14 22:40:17,010 - __main__ - INFO - Latest record found: False
2025-08-14 22:40:17,010 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 22:40:17,013 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:40:17,013 - etl.pipeline - INFO - ============================================================
2025-08-14 22:40:17,014 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:40:17,014 - etl.pipeline - INFO - ============================================================
2025-08-14 22:40:17,015 - etl.pipeline - INFO - Location: 26.6622505, 87.2748964
2025-08-14 22:40:17,015 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:40:17.015712
2025-08-14 22:40:17,015 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:40:17,017 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:40:17,018 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:40:17,019 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.6622505, 87.2748964
2025-08-14 22:40:17,019 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:40:17,020 - etl.extract - INFO - Fetching weather forecast for 26.6622505, 87.2748964
2025-08-14 22:40:17,842 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:40:17,842 - etl.extract - INFO - Fetching air quality data for 26.6622505, 87.2748964
2025-08-14 22:40:18,705 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:40:18,705 - etl.extract - INFO - Data extraction completed in 1.69 seconds
2025-08-14 22:40:18,706 - etl.extract - INFO - Data validation successful
2025-08-14 22:40:18,706 - etl.pipeline - INFO - Extraction completed in 1.69 seconds
2025-08-14 22:40:18,706 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:40:18,706 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:40:18,707 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:40:18,707 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:40:18,708 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:40:18,709 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:40:18,709 - etl.transform - INFO - Starting data transformation
2025-08-14 22:40:18,710 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:40:18,710 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:40:18,711 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:40:18,711 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:40:18,711 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:40:18,712 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:40:18,712 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:40:18,715 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:40:18,718 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:40:18,730 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:40:18,731 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 22:40:18,741 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 22:40:18,741 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:40:18,749 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_224018.csv
2025-08-14 22:40:18,753 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_224018.csv
2025-08-14 22:40:18,781 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-14 22:40:18,785 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:40:18,786 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.77 SECONDS
2025-08-14 22:40:18,786 - etl.pipeline - INFO - ============================================================
2025-08-14 22:40:18,787 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:40:18,787 - __main__ - INFO - Attempting to get latest record after ETL for 26.6622505, 87.2748964
2025-08-14 22:40:18,789 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:40:18,789 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:40:18,792 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:40:18,793 - __main__ - INFO - Record 1: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:40:18,793 - __main__ - INFO - Record 2: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:40:18,793 - __main__ - INFO - Record 3: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:40:18,794 - __main__ - INFO - Record 4: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:40:18,794 - __main__ - INFO - Record 5: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 22:40:18,794 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.25
2025-08-14 22:40:18,795 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:40:18,795 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:40:18,795 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.6622505, 87.2748964
2025-08-14 22:40:18,802 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:40:18] "GET /weather?lat=26.6622505&lon=87.2748964 HTTP/1.1" 200 -
2025-08-14 22:41:56,934 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 22:41:56] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 22:50:42,305 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 22:50:42,306 - etl.pipeline - INFO - ============================================================
2025-08-14 22:50:42,307 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 22:50:42,307 - etl.pipeline - INFO - ============================================================
2025-08-14 22:50:42,309 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 22:50:42,311 - etl.pipeline - INFO - Timestamp: 2025-08-14T22:50:42.311315
2025-08-14 22:50:42,312 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:50:42,313 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 22:50:42,317 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:50:42,319 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 22:50:42,322 - etl.extract - INFO - Starting complete data extraction
2025-08-14 22:50:42,322 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 22:50:43,151 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 22:50:43,152 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 22:50:43,976 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 22:50:43,977 - etl.extract - INFO - Data extraction completed in 1.65 seconds
2025-08-14 22:50:43,977 - etl.extract - INFO - Data validation successful
2025-08-14 22:50:43,978 - etl.pipeline - INFO - Extraction completed in 1.66 seconds
2025-08-14 22:50:43,978 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 22:50:43,978 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 22:50:43,979 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:50:43,980 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 22:50:43,980 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:50:43,980 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 22:50:43,980 - etl.transform - INFO - Starting data transformation
2025-08-14 22:50:43,982 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 22:50:43,983 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 22:50:43,983 - etl.pipeline - INFO - Records created: 7
2025-08-14 22:50:43,983 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 22:50:43,984 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 22:50:43,984 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 22:50:43,984 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 22:50:43,988 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 22:50:43,993 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 22:50:44,008 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 22:50:44,011 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 22:50:44,012 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 22:50:44,015 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 22:50:44,030 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_225044.csv
2025-08-14 22:50:44,032 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_225044.csv
2025-08-14 22:50:44,061 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-14 22:50:44,062 - etl.pipeline - INFO - 
============================================================
2025-08-14 22:50:44,062 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.76 SECONDS
2025-08-14 22:50:44,063 - etl.pipeline - INFO - ============================================================
2025-08-14 22:50:44,064 - __main__ - INFO - ETL pipeline success: True
2025-08-14 22:50:44,064 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 22:50:44,068 - __main__ - INFO - Latest record after ETL: False
2025-08-14 22:50:44,069 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 22:50:44,078 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 22:50:44,078 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:50:44,079 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:50:44,079 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:50:44,079 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:50:44,079 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 22:50:44,081 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 22:50:44,081 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 22:50:44,082 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 22:50:44,082 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 22:50:44,163 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 22:50:44] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 22:50:50,286 - __main__ - INFO - Found 0 historical records for 26.8128974, 87.2839978
2025-08-14 22:50:50,293 - __main__ - INFO - Found 7 records with wider tolerance
2025-08-14 22:50:50,353 - __main__ - ERROR - Error in history route: 'str object' has no attribute 'date'
2025-08-14 22:50:50,356 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 22:50:50] "[32mGET /history?lat=26.8128974&lon=87.2839978 HTTP/1.1[0m" 302 -
2025-08-14 22:50:50,369 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 22:50:50] "GET / HTTP/1.1" 200 -
2025-08-14 23:10:13,974 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:10:13,976 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:13,976 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:10:13,977 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:13,981 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:10:13,985 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:10:13.985431
2025-08-14 23:10:13,986 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:13,990 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:10:13,991 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:13,992 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:10:13,993 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:10:13,994 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:10:14,813 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:10:14,816 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:10:15,633 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:10:15,636 - etl.extract - INFO - Data extraction completed in 1.64 seconds
2025-08-14 23:10:15,637 - etl.extract - INFO - Data validation successful
2025-08-14 23:10:15,640 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:10:15,642 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:10:15,643 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:10:15,643 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:15,646 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:10:15,647 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:15,649 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:10:15,650 - etl.transform - INFO - Starting data transformation
2025-08-14 23:10:15,653 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:10:15,654 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:10:15,655 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:10:15,657 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:10:15,659 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:15,660 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:10:15,661 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:15,688 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:10:15,693 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:10:15,724 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:10:15,725 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:10:15,726 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:10:15,727 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:10:15,759 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231015.csv
2025-08-14 23:10:15,760 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231015.csv
2025-08-14 23:10:15,798 - etl.pipeline - INFO - Data loading completed in 0.10 seconds
2025-08-14 23:10:15,799 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:10:15,800 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.82 SECONDS
2025-08-14 23:10:15,800 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:15,800 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:10:15,802 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:10:15,805 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:10:15,805 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:10:15,815 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:10:15,816 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:15,817 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:15,818 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:15,819 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:15,820 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:15,820 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:10:15,821 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:10:15,821 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:10:15,822 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:10:15,913 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:10:15,925 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:15] "[32mGET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1[0m" 302 -
2025-08-14 23:10:15,940 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:15] "GET / HTTP/1.1" 200 -
2025-08-14 23:10:21,223 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:10:22,318 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:10:22,324 - __main__ - INFO - Latest record found: False
2025-08-14 23:10:22,325 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:10:22,330 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:10:22,332 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:22,332 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:10:22,335 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:22,337 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:10:22,339 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:10:22.339382
2025-08-14 23:10:22,340 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:22,342 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:10:22,344 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:22,346 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:10:22,348 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:10:22,354 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:10:23,205 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:10:23,208 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:10:24,106 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:10:24,107 - etl.extract - INFO - Data extraction completed in 1.75 seconds
2025-08-14 23:10:24,108 - etl.extract - INFO - Data validation successful
2025-08-14 23:10:24,108 - etl.pipeline - INFO - Extraction completed in 1.76 seconds
2025-08-14 23:10:24,109 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:10:24,109 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:10:24,110 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:24,110 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:10:24,110 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:24,111 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:10:24,111 - etl.transform - INFO - Starting data transformation
2025-08-14 23:10:24,112 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:10:24,113 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:10:24,114 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:10:24,114 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:10:24,114 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:24,116 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:10:24,118 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:24,134 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:10:24,145 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:10:24,174 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:10:24,176 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:10:24,176 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:10:24,176 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:10:24,204 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231024.csv
2025-08-14 23:10:24,205 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231024.csv
2025-08-14 23:10:24,245 - etl.pipeline - INFO - Data loading completed in 0.09 seconds
2025-08-14 23:10:24,245 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:10:24,246 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.91 SECONDS
2025-08-14 23:10:24,246 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:24,246 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:10:24,246 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:10:24,250 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:10:24,253 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:10:24,265 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:10:24,269 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:24,270 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:24,271 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:24,272 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:24,272 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:10:24,274 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:10:24,275 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:10:24,276 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:10:24,277 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:10:24,288 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:10:24,297 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:24] "[32mGET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1[0m" 302 -
2025-08-14 23:10:24,313 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:24] "GET / HTTP/1.1" 200 -
2025-08-14 23:10:27,450 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-14 23:10:28,629 - __main__ - INFO - Location name: City of New York, New York
2025-08-14 23:10:28,629 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-14 23:10:28,633 - __main__ - INFO - Latest record found: False
2025-08-14 23:10:28,634 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:10:28,642 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:10:28,643 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:28,645 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:10:28,646 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:28,647 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-14 23:10:28,647 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:10:28.647064
2025-08-14 23:10:28,650 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:28,651 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:10:28,652 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:28,674 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-14 23:10:28,680 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:10:28,681 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-14 23:10:29,477 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:10:29,479 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-14 23:10:30,298 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:10:30,299 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-08-14 23:10:30,301 - etl.extract - INFO - Data validation successful
2025-08-14 23:10:30,302 - etl.pipeline - INFO - Extraction completed in 1.63 seconds
2025-08-14 23:10:30,303 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:10:30,304 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:10:30,305 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:30,306 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:10:30,307 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:30,308 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:10:30,309 - etl.transform - INFO - Starting data transformation
2025-08-14 23:10:30,310 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:10:30,312 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:10:30,312 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:10:30,314 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:10:30,316 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:30,319 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:10:30,320 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:30,337 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:10:30,345 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:10:30,376 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:10:30,377 - etl.load - INFO -   - Inserted: 3 new records
2025-08-14 23:10:30,378 - etl.load - INFO -   - Updated: 4 existing records
2025-08-14 23:10:30,380 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:10:30,398 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250814_231030.csv
2025-08-14 23:10:30,403 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250814_231030.csv
2025-08-14 23:10:30,450 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:10:30,451 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:10:30,452 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.81 SECONDS
2025-08-14 23:10:30,452 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:30,453 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:10:30,453 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-14 23:10:30,454 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:10:30,455 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:10:30,457 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:10:30,458 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:10:30,459 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:10:30,461 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:10:30,462 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-14 23:10:30,464 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-14 23:10:30,465 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-14 23:10:30,467 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:10:30,469 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:10:30,470 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-14 23:10:30,472 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-14 23:10:30,476 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:10:30,482 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:30] "[32mGET /weather?lat=40.71&lon=-74.01 HTTP/1.1[0m" 302 -
2025-08-14 23:10:30,503 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:30] "GET / HTTP/1.1" 200 -
2025-08-14 23:10:33,000 - __main__ - INFO - Weather route called with lat=27.7, lon=85.3
2025-08-14 23:10:34,141 - __main__ - INFO - Attempting to get latest record for 27.7, 85.3
2025-08-14 23:10:34,150 - __main__ - INFO - Latest record found: False
2025-08-14 23:10:34,151 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:10:34,163 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:10:34,165 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:34,171 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:10:34,179 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:34,191 - etl.pipeline - INFO - Location: 27.7, 85.3
2025-08-14 23:10:34,193 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:10:34.193671
2025-08-14 23:10:34,196 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:34,197 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:10:34,198 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:34,199 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.7, 85.3
2025-08-14 23:10:34,203 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:10:34,212 - etl.extract - INFO - Fetching weather forecast for 27.7, 85.3
2025-08-14 23:10:35,011 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:10:35,012 - etl.extract - INFO - Fetching air quality data for 27.7, 85.3
2025-08-14 23:10:35,879 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:10:35,880 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 23:10:35,881 - etl.extract - INFO - Data validation successful
2025-08-14 23:10:35,881 - etl.pipeline - INFO - Extraction completed in 1.68 seconds
2025-08-14 23:10:35,882 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:10:35,882 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:10:35,883 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:35,883 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:10:35,883 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:35,884 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:10:35,884 - etl.transform - INFO - Starting data transformation
2025-08-14 23:10:35,885 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:10:35,886 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:10:35,886 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:10:35,887 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:10:35,887 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:10:35,887 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:10:35,889 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:10:35,894 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:10:35,897 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:10:35,923 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:10:35,924 - etl.load - INFO -   - Inserted: 2 new records
2025-08-14 23:10:35,925 - etl.load - INFO -   - Updated: 5 existing records
2025-08-14 23:10:35,926 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:10:35,952 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250814_231035.csv
2025-08-14 23:10:35,955 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat27.75_lon85.25_20250814_231035.csv
2025-08-14 23:10:35,991 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-08-14 23:10:35,992 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:10:35,993 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.83 SECONDS
2025-08-14 23:10:35,993 - etl.pipeline - INFO - ============================================================
2025-08-14 23:10:35,993 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:10:35,994 - __main__ - INFO - Attempting to get latest record after ETL for 27.7, 85.3
2025-08-14 23:10:35,995 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:10:35,996 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:10:35,997 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:10:35,998 - __main__ - INFO - Record 1: lat=27.75, lon=85.25, created=2025-08-14 17:25:35.885624
2025-08-14 23:10:35,998 - __main__ - INFO - Record 2: lat=27.75, lon=85.25, created=2025-08-14 17:25:35.885624
2025-08-14 23:10:35,998 - __main__ - INFO - Record 3: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.713000
2025-08-14 23:10:36,004 - __main__ - INFO - Record 4: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712988
2025-08-14 23:10:36,004 - __main__ - INFO - Record 5: lat=27.75, lon=85.25, created=2025-08-11 20:08:51.712976
2025-08-14 23:10:36,005 - __main__ - INFO - Using nearby record: lat=27.75, lon=85.25
2025-08-14 23:10:36,005 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:10:36,007 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:10:36,007 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 27.7, 85.3
2025-08-14 23:10:36,022 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:10:36,026 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:36] "[32mGET /weather?lat=27.7&lon=85.3 HTTP/1.1[0m" 302 -
2025-08-14 23:10:36,041 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:10:36] "GET / HTTP/1.1" 200 -
2025-08-14 23:11:16,382 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:11:16,382 - etl.pipeline - INFO - ============================================================
2025-08-14 23:11:16,383 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:11:16,383 - etl.pipeline - INFO - ============================================================
2025-08-14 23:11:16,383 - etl.pipeline - INFO - Location: 26.6622505, 87.2748964
2025-08-14 23:11:16,384 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:11:16.384498
2025-08-14 23:11:16,385 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:11:16,385 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:11:16,388 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:11:16,389 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.6622505, 87.2748964
2025-08-14 23:11:16,389 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:11:16,390 - etl.extract - INFO - Fetching weather forecast for 26.6622505, 87.2748964
2025-08-14 23:11:17,193 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:11:17,194 - etl.extract - INFO - Fetching air quality data for 26.6622505, 87.2748964
2025-08-14 23:11:18,084 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:11:18,085 - etl.extract - INFO - Data extraction completed in 1.70 seconds
2025-08-14 23:11:18,087 - etl.extract - INFO - Data validation successful
2025-08-14 23:11:18,088 - etl.pipeline - INFO - Extraction completed in 1.70 seconds
2025-08-14 23:11:18,090 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:11:18,090 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:11:18,091 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:11:18,092 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:11:18,093 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:11:18,097 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:11:18,097 - etl.transform - INFO - Starting data transformation
2025-08-14 23:11:18,100 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:11:18,100 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:11:18,102 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:11:18,104 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:11:18,105 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:11:18,107 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:11:18,108 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:11:18,122 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:11:18,127 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:11:18,144 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:11:18,145 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:11:18,146 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:11:18,147 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:11:18,183 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_231118.csv
2025-08-14 23:11:18,189 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.25_20250814_231118.csv
2025-08-14 23:11:18,225 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:11:18,226 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:11:18,226 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.84 SECONDS
2025-08-14 23:11:18,226 - etl.pipeline - INFO - ============================================================
2025-08-14 23:11:18,227 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:11:18,227 - __main__ - INFO - Attempting to get latest record after ETL for 26.6622505, 87.2748964
2025-08-14 23:11:18,228 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:11:18,228 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:11:18,232 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:11:18,232 - __main__ - INFO - Record 1: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 23:11:18,233 - __main__ - INFO - Record 2: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 23:11:18,233 - __main__ - INFO - Record 3: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 23:11:18,233 - __main__ - INFO - Record 4: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 23:11:18,236 - __main__ - INFO - Record 5: lat=26.625, lon=87.25, created=2025-08-14 16:49:46.972968
2025-08-14 23:11:18,237 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.25
2025-08-14 23:11:18,238 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:11:18,239 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:11:18,239 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.6622505, 87.2748964
2025-08-14 23:11:18,328 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:11:18,336 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:11:18] "[32mGET /weather?lat=26.6622505&lon=87.2748964 HTTP/1.1[0m" 302 -
2025-08-14 23:11:18,359 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:11:18] "GET / HTTP/1.1" 200 -
2025-08-14 23:15:59,496 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:15:59] "GET / HTTP/1.1" 200 -
2025-08-14 23:16:00,677 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:16:00] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-08-14 23:16:10,072 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:16:11,215 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:16:11,220 - __main__ - INFO - Latest record found: False
2025-08-14 23:16:11,221 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:16:11,232 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:16:11,233 - etl.pipeline - INFO - ============================================================
2025-08-14 23:16:11,234 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:16:11,235 - etl.pipeline - INFO - ============================================================
2025-08-14 23:16:11,237 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:16:11,239 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:16:11.239234
2025-08-14 23:16:11,241 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:16:11,242 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:16:11,243 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:16:11,245 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:16:11,247 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:16:11,247 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:16:12,068 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:16:12,069 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:16:12,950 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:16:12,951 - etl.extract - INFO - Data extraction completed in 1.70 seconds
2025-08-14 23:16:12,953 - etl.extract - INFO - Data validation successful
2025-08-14 23:16:12,955 - etl.pipeline - INFO - Extraction completed in 1.71 seconds
2025-08-14 23:16:12,956 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:16:12,957 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:16:12,958 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:16:12,959 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:16:12,960 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:16:12,961 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:16:12,961 - etl.transform - INFO - Starting data transformation
2025-08-14 23:16:12,964 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:16:12,965 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:16:12,966 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:16:12,967 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:16:12,969 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:16:12,970 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:16:12,971 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:16:12,982 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:16:12,990 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:16:13,002 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:16:13,004 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:16:13,005 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:16:13,006 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:16:13,034 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231613.csv
2025-08-14 23:16:13,038 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_231613.csv
2025-08-14 23:16:13,078 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-08-14 23:16:13,078 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:16:13,078 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.85 SECONDS
2025-08-14 23:16:13,079 - etl.pipeline - INFO - ============================================================
2025-08-14 23:16:13,080 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:16:13,081 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:16:13,083 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:16:13,083 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:16:13,088 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:16:13,089 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:16:13,090 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:16:13,090 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:16:13,091 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:16:13,092 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:16:13,094 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:16:13,094 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:16:13,095 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:16:13,095 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:16:13,106 - __main__ - ERROR - Error in weather route: 'datetime.datetime' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 18, in block 'content'
    Last updated: {{ weather.current.last_updated[:19] if weather.current.last_updated else 'Unknown' }}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
2025-08-14 23:16:13,110 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:16:13] "[32mGET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1[0m" 302 -
2025-08-14 23:16:13,132 - werkzeug - INFO - 192.168.1.90 - - [14/Aug/2025 23:16:13] "GET / HTTP/1.1" 200 -
2025-08-14 23:25:57,591 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:25:57,596 - etl.pipeline - INFO - ============================================================
2025-08-14 23:25:57,596 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:25:57,597 - etl.pipeline - INFO - ============================================================
2025-08-14 23:25:57,598 - etl.pipeline - INFO - Location: 51.5074456, -0.1277653
2025-08-14 23:25:57,599 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:25:57.599995
2025-08-14 23:25:57,601 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:25:57,602 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:25:57,603 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:25:57,604 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.5074456, -0.1277653
2025-08-14 23:25:57,604 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:25:57,604 - etl.extract - INFO - Fetching weather forecast for 51.5074456, -0.1277653
2025-08-14 23:25:58,440 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:25:58,441 - etl.extract - INFO - Fetching air quality data for 51.5074456, -0.1277653
2025-08-14 23:25:59,257 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:25:59,258 - etl.extract - INFO - Data extraction completed in 1.65 seconds
2025-08-14 23:25:59,258 - etl.extract - INFO - Data validation successful
2025-08-14 23:25:59,258 - etl.pipeline - INFO - Extraction completed in 1.66 seconds
2025-08-14 23:25:59,258 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:25:59,258 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:25:59,260 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:25:59,260 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:25:59,260 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:25:59,261 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:25:59,261 - etl.transform - INFO - Starting data transformation
2025-08-14 23:25:59,261 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:25:59,262 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:25:59,262 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:25:59,262 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:25:59,262 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:25:59,263 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:25:59,263 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:25:59,266 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:25:59,271 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:25:59,300 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:25:59,301 - etl.load - INFO -   - Inserted: 3 new records
2025-08-14 23:25:59,302 - etl.load - INFO -   - Updated: 4 existing records
2025-08-14 23:25:59,302 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:25:59,323 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250814_232559.csv
2025-08-14 23:25:59,324 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat51.50_lon-0.12_20250814_232559.csv
2025-08-14 23:25:59,354 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 23:25:59,354 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:25:59,355 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.76 SECONDS
2025-08-14 23:25:59,355 - etl.pipeline - INFO - ============================================================
2025-08-14 23:25:59,355 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:25:59,356 - __main__ - INFO - Attempting to get latest record after ETL for 51.5074456, -0.1277653
2025-08-14 23:25:59,358 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:25:59,359 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:25:59,359 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:25:59,359 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.5074456, -0.1277653
2025-08-14 23:25:59,392 - models.forecast.core - INFO - WeatherForecaster initialized with ARIMA order (2, 1, 2)
2025-08-14 23:25:59,394 - models.forecast.core - INFO - Data prepared successfully: 10 data points
2025-08-14 23:25:59,397 - models.forecast.core - INFO - Date range: 2025-08-11 00:00:00 to 2025-08-20 00:00:00
2025-08-14 23:25:59,397 - models.forecast.core - INFO - Temperature range: 18.1°C to 25.4°C
2025-08-14 23:25:59,431 - models.forecast.core - INFO - Stationarity test: Stationary (p-value: 0.0009)
2025-08-14 23:25:59,431 - models.forecast.core - INFO - Fitting ARIMA(2, 1, 2) model...
2025-08-14 23:26:02,524 - models.forecast.core - INFO - Model fitted successfully
2025-08-14 23:26:02,525 - models.forecast.core - INFO - AIC: 35.96
2025-08-14 23:26:02,526 - models.forecast.core - INFO - BIC: 36.94
2025-08-14 23:26:02,526 - models.forecast.core - INFO - Log Likelihood: -12.98
2025-08-14 23:26:02,530 - models.forecast.validation - ERROR - Error validating model: operands could not be broadcast together with shapes (9,) (10,) 
2025-08-14 23:26:02,530 - models.forecast.core - INFO - Generating 3-step forecast...
2025-08-14 23:26:02,552 - models.forecast.core - INFO - Forecast generated successfully
2025-08-14 23:26:02,558 - models.forecast.core - INFO - Mean forecast temperature: 19.6°C
2025-08-14 23:26:02,559 - models.forecast.core - INFO - Temperature trend: decreasing
2025-08-14 23:26:02,559 - models.forecast.manager - INFO - Forecast created successfully for 51.5074456, -0.1277653
2025-08-14 23:26:02,559 - __main__ - INFO - Rendering weather template for City of Westminster, England
2025-08-14 23:26:02,613 - __main__ - ERROR - Error in weather route: Object of type bool is not JSON serializable
Traceback (most recent call last):
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\app.py", line 193, in weather
    return render_template('weather.html', weather=weather_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 1304, in render
    self.environment.handle_exception()
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\environment.py", line 939, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\base.html", line 345, in top-level template code
    <main class="flex-1">{% block content %}{% endblock %}</main>
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\Dropbox\PC\Desktop\ASSIGNMENTS\PRG400_Advance python\prg wk8\AirQuality\weatherpipeline\frontend\templates\weather.html", line 377, in block 'content'
    "forecast": {% if weather.forecast %}{{ weather.forecast | tojson }}{% else %}null{% endif %}
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\filters.py", line 1714, in do_tojson
    return htmlsafe_json_dumps(value, dumps=dumps, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\jinja2\utils.py", line 658, in htmlsafe_json_dumps
    dumps(obj, **kwargs)
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\json\provider.py", line 179, in dumps
    return json.dumps(obj, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\json\encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Aayush.R\AppData\Local\Programs\Python\Python312\Lib\site-packages\flask\json\provider.py", line 121, in _default
    raise TypeError(f"Object of type {type(o).__name__} is not JSON serializable")
TypeError: Object of type bool is not JSON serializable
2025-08-14 23:26:02,806 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:26:02] "[32mGET /weather?lat=51.5074456&lon=-0.1277653 HTTP/1.1[0m" 302 -
2025-08-14 23:26:02,824 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:26:02] "GET / HTTP/1.1" 200 -
2025-08-14 23:31:00,183 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:00] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-08-14 23:31:19,387 - __main__ - INFO - Weather route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:31:20,516 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:31:20,517 - __main__ - INFO - Attempting to get latest record for 51.4893335, -0.1440551
2025-08-14 23:31:20,521 - __main__ - INFO - Latest record found: False
2025-08-14 23:31:20,523 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:31:20,537 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:31:20,540 - etl.pipeline - INFO - ============================================================
2025-08-14 23:31:20,541 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:31:20,544 - etl.pipeline - INFO - ============================================================
2025-08-14 23:31:20,545 - etl.pipeline - INFO - Location: 51.4893335, -0.1440551
2025-08-14 23:31:20,547 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:31:20.547977
2025-08-14 23:31:20,550 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:31:20,552 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:31:20,553 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:31:20,554 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 51.4893335, -0.1440551
2025-08-14 23:31:20,556 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:31:20,557 - etl.extract - INFO - Fetching weather forecast for 51.4893335, -0.1440551
2025-08-14 23:31:21,363 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:31:21,363 - etl.extract - INFO - Fetching air quality data for 51.4893335, -0.1440551
2025-08-14 23:31:22,274 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:31:22,274 - etl.extract - INFO - Data extraction completed in 1.72 seconds
2025-08-14 23:31:22,278 - etl.extract - INFO - Data validation successful
2025-08-14 23:31:22,280 - etl.pipeline - INFO - Extraction completed in 1.73 seconds
2025-08-14 23:31:22,280 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:31:22,280 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:31:22,281 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:31:22,282 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:31:22,283 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:31:22,283 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:31:22,284 - etl.transform - INFO - Starting data transformation
2025-08-14 23:31:22,284 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:31:22,285 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:31:22,285 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:31:22,285 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:31:22,286 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:31:22,287 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:31:22,287 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:31:22,290 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:31:22,294 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:31:22,305 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:31:22,306 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:31:22,306 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:31:22,307 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:31:22,327 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat51.48_lon-0.14_20250814_233122.csv
2025-08-14 23:31:22,328 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat51.48_lon-0.14_20250814_233122.csv
2025-08-14 23:31:22,363 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-14 23:31:22,364 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:31:22,365 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.83 SECONDS
2025-08-14 23:31:22,366 - etl.pipeline - INFO - ============================================================
2025-08-14 23:31:22,366 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:31:22,367 - __main__ - INFO - Attempting to get latest record after ETL for 51.4893335, -0.1440551
2025-08-14 23:31:22,370 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:31:22,370 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:31:22,371 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:31:22,371 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.4893335, -0.1440551
2025-08-14 23:31:22,378 - __main__ - INFO - Rendering weather template for City of Westminster, England
2025-08-14 23:31:22,383 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:22] "GET /weather?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:31:28,472 - __main__ - INFO - History route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:31:29,572 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:31:29,577 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-14 23:31:29,580 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:31:29,582 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:31:29,665 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:29] "GET /history?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:31:40,472 - __main__ - INFO - Weather route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:31:41,568 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:31:41,569 - __main__ - INFO - Attempting to get latest record for 51.4893335, -0.1440551
2025-08-14 23:31:41,574 - __main__ - INFO - Latest record found: True
2025-08-14 23:31:41,576 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:31:41,577 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:31:41,578 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.4893335, -0.1440551
2025-08-14 23:31:41,595 - __main__ - INFO - Rendering weather template for City of Westminster, England
2025-08-14 23:31:41,600 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:41] "GET /weather?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:31:42,642 - __main__ - INFO - History route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:31:43,773 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:31:43,777 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-14 23:31:43,778 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:31:43,780 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:31:43,790 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:43] "GET /history?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:31:55,804 - __main__ - INFO - Weather route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:31:56,936 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:31:56,936 - __main__ - INFO - Attempting to get latest record for 51.4893335, -0.1440551
2025-08-14 23:31:56,939 - __main__ - INFO - Latest record found: True
2025-08-14 23:31:56,940 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:31:56,940 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:31:56,941 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.4893335, -0.1440551
2025-08-14 23:31:56,948 - __main__ - INFO - Rendering weather template for City of Westminster, England
2025-08-14 23:31:56,950 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:56] "GET /weather?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:31:59,764 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:31:59] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:32:02,333 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:02] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:32:05,618 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:05] "GET / HTTP/1.1" 200 -
2025-08-14 23:32:11,088 - __main__ - INFO - Weather route called with lat=28.3780464, lon=83.9999901
2025-08-14 23:32:12,277 - __main__ - INFO - Attempting to get latest record for 28.3780464, 83.9999901
2025-08-14 23:32:12,288 - __main__ - INFO - Latest record found: False
2025-08-14 23:32:12,291 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:32:12,305 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:32:12,308 - etl.pipeline - INFO - ============================================================
2025-08-14 23:32:12,313 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:32:12,314 - etl.pipeline - INFO - ============================================================
2025-08-14 23:32:12,315 - etl.pipeline - INFO - Location: 28.3780464, 83.9999901
2025-08-14 23:32:12,316 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:32:12.316238
2025-08-14 23:32:12,317 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:32:12,320 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:32:12,321 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:32:12,323 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 28.3780464, 83.9999901
2025-08-14 23:32:12,324 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:32:12,326 - etl.extract - INFO - Fetching weather forecast for 28.3780464, 83.9999901
2025-08-14 23:32:13,122 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:32:13,123 - etl.extract - INFO - Fetching air quality data for 28.3780464, 83.9999901
2025-08-14 23:32:13,939 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:32:13,942 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-08-14 23:32:13,944 - etl.extract - INFO - Data validation successful
2025-08-14 23:32:13,947 - etl.pipeline - INFO - Extraction completed in 1.62 seconds
2025-08-14 23:32:13,948 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:32:13,949 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:32:13,950 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:32:13,952 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:32:13,957 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:32:13,958 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:32:13,959 - etl.transform - INFO - Starting data transformation
2025-08-14 23:32:13,962 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:32:13,963 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:32:13,965 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:32:13,965 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:32:13,974 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:32:13,975 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:32:13,976 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:32:13,992 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:32:13,995 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:32:14,009 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:32:14,009 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:32:14,010 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:32:14,013 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:32:14,023 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat28.38_lon84.00_20250814_233214.csv
2025-08-14 23:32:14,024 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat28.38_lon84.00_20250814_233214.csv
2025-08-14 23:32:14,058 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-14 23:32:14,058 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:32:14,059 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-08-14 23:32:14,059 - etl.pipeline - INFO - ============================================================
2025-08-14 23:32:14,059 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:32:14,059 - __main__ - INFO - Attempting to get latest record after ETL for 28.3780464, 83.9999901
2025-08-14 23:32:14,062 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:32:14,062 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:32:14,062 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:32:14,063 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 28.3780464, 83.9999901
2025-08-14 23:32:14,074 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:14] "GET /weather?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
2025-08-14 23:32:18,547 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:18] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:32:23,128 - __main__ - INFO - History route called with lat=28.3780464, lon=83.9999901
2025-08-14 23:32:24,261 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-14 23:32:24,264 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:32:24,265 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:32:24,270 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:24] "GET /history?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
2025-08-14 23:32:30,650 - __main__ - INFO - Weather route called with lat=28.3780464, lon=83.9999901
2025-08-14 23:32:31,745 - __main__ - INFO - Attempting to get latest record for 28.3780464, 83.9999901
2025-08-14 23:32:31,750 - __main__ - INFO - Latest record found: True
2025-08-14 23:32:31,758 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:32:31,760 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:32:31,760 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 28.3780464, 83.9999901
2025-08-14 23:32:31,792 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:31] "GET /weather?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
2025-08-14 23:32:32,715 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:32:32] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:47:42,269 - __main__ - INFO - History route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:47:43,370 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:47:43,376 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-14 23:47:43,379 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:47:43,380 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:47:43,388 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:47:43] "GET /history?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:48:57,441 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:48:57] "GET / HTTP/1.1" 200 -
2025-08-14 23:49:03,157 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:49:04,290 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:49:04,293 - __main__ - INFO - Latest record found: False
2025-08-14 23:49:04,294 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:49:04,312 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:49:04,313 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:04,314 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:49:04,317 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:04,319 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:49:04,323 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:49:04.323187
2025-08-14 23:49:04,324 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:04,325 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:49:04,325 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:04,326 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:49:04,328 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:49:04,330 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:49:05,175 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:49:05,176 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:49:06,023 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:49:06,025 - etl.extract - INFO - Data extraction completed in 1.69 seconds
2025-08-14 23:49:06,026 - etl.extract - INFO - Data validation successful
2025-08-14 23:49:06,028 - etl.pipeline - INFO - Extraction completed in 1.70 seconds
2025-08-14 23:49:06,032 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:49:06,033 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:49:06,036 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:06,037 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:49:06,037 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:06,038 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:49:06,041 - etl.transform - INFO - Starting data transformation
2025-08-14 23:49:06,044 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:49:06,044 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:49:06,045 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:49:06,046 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:49:06,047 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:06,048 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:49:06,050 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:06,062 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:49:06,077 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:49:06,099 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:49:06,100 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:49:06,104 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:49:06,107 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:49:06,126 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234906.csv
2025-08-14 23:49:06,128 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234906.csv
2025-08-14 23:49:06,165 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:49:06,167 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:49:06,167 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.85 SECONDS
2025-08-14 23:49:06,168 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:06,170 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:49:06,170 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:49:06,173 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:49:06,174 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:49:06,191 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:49:06,192 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:06,193 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:06,193 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:06,196 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:06,201 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:06,202 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:49:06,203 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:49:06,204 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:49:06,204 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:49:06,212 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:06] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:49:09,910 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:09] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:49:13,339 - __main__ - INFO - History route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:49:14,422 - __main__ - INFO - Found 0 records with tight tolerance (0.01)
2025-08-14 23:49:14,426 - __main__ - INFO - Found 7 records with medium tolerance (0.1)
2025-08-14 23:49:14,428 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:49:14,430 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:49:14,441 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:14] "GET /history?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:49:25,723 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:49:26,784 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:49:26,794 - __main__ - INFO - Latest record found: False
2025-08-14 23:49:26,795 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:49:26,801 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:49:26,806 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:26,807 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:49:26,809 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:26,809 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:49:26,811 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:49:26.810951
2025-08-14 23:49:26,811 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:26,812 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:49:26,813 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:26,815 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:49:26,816 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:49:26,817 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:49:27,664 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:49:27,666 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:49:28,517 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:49:28,518 - etl.extract - INFO - Data extraction completed in 1.70 seconds
2025-08-14 23:49:28,519 - etl.extract - INFO - Data validation successful
2025-08-14 23:49:28,520 - etl.pipeline - INFO - Extraction completed in 1.71 seconds
2025-08-14 23:49:28,521 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:49:28,522 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:49:28,523 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:28,524 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:49:28,524 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:28,524 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:49:28,526 - etl.transform - INFO - Starting data transformation
2025-08-14 23:49:28,528 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:49:28,529 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:49:28,532 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:49:28,534 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:49:28,535 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:28,541 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:49:28,544 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:28,554 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:49:28,564 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:49:28,591 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:49:28,592 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:49:28,593 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:49:28,594 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:49:28,617 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234928.csv
2025-08-14 23:49:28,622 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234928.csv
2025-08-14 23:49:28,661 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:49:28,662 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:49:28,662 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.86 SECONDS
2025-08-14 23:49:28,663 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:28,663 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:49:28,664 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:49:28,666 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:49:28,667 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:49:28,674 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:49:28,676 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:28,677 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:28,678 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:28,679 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:28,679 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:28,681 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:49:28,682 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:49:28,682 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:49:28,683 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:49:28,693 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:28] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:49:32,198 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:49:32,200 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:49:32,518 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:32] "GET /forecast?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:49:39,743 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:39] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:49:43,901 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:43] "GET / HTTP/1.1" 200 -
2025-08-14 23:49:48,721 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:49:49,858 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:49:49,864 - __main__ - INFO - Latest record found: False
2025-08-14 23:49:49,865 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:49:49,881 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:49:49,887 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:49,890 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:49:49,894 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:49,895 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:49:49,896 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:49:49.896364
2025-08-14 23:49:49,897 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:49,898 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:49:49,899 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:49,901 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:49:49,902 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:49:49,903 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:49:50,692 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:49:50,694 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:49:51,584 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:49:51,585 - etl.extract - INFO - Data extraction completed in 1.68 seconds
2025-08-14 23:49:51,585 - etl.extract - INFO - Data validation successful
2025-08-14 23:49:51,587 - etl.pipeline - INFO - Extraction completed in 1.69 seconds
2025-08-14 23:49:51,588 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:49:51,588 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:49:51,589 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:51,590 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:49:51,591 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:51,593 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:49:51,597 - etl.transform - INFO - Starting data transformation
2025-08-14 23:49:51,601 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:49:51,603 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:49:51,604 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:49:51,607 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:49:51,612 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:49:51,613 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:49:51,614 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:49:51,631 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:49:51,638 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:49:51,664 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:49:51,668 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:49:51,670 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:49:51,677 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:49:51,700 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234951.csv
2025-08-14 23:49:51,701 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_234951.csv
2025-08-14 23:49:51,744 - etl.pipeline - INFO - Data loading completed in 0.09 seconds
2025-08-14 23:49:51,744 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:49:51,745 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.86 SECONDS
2025-08-14 23:49:51,745 - etl.pipeline - INFO - ============================================================
2025-08-14 23:49:51,745 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:49:51,746 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:49:51,747 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:49:51,749 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:49:51,752 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:49:51,753 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:51,754 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:51,757 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:51,759 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:51,761 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:49:51,761 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:49:51,762 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:49:51,763 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:49:51,764 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:49:51,777 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:51] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:49:54,589 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:54] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 23:49:57,954 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:57] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 23:49:58,834 - __main__ - INFO - History route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:49:59,894 - __main__ - INFO - Found 0 records with tight tolerance (0.01)
2025-08-14 23:49:59,907 - __main__ - INFO - Found 7 records with medium tolerance (0.1)
2025-08-14 23:49:59,913 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-14 23:49:59,915 - __main__ - INFO - Rendering history template with 7 records
2025-08-14 23:49:59,922 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:49:59] "GET /history?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:50:09,776 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:09] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:50:23,726 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:23] "POST /remove-favorite HTTP/1.1" 200 -
2025-08-14 23:50:24,765 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:24] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:50:27,328 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:27] "GET / HTTP/1.1" 200 -
2025-08-14 23:50:31,529 - __main__ - INFO - Weather route called with lat=26.8128974, lon=87.2839978
2025-08-14 23:50:32,596 - __main__ - INFO - Attempting to get latest record for 26.8128974, 87.2839978
2025-08-14 23:50:32,599 - __main__ - INFO - Latest record found: False
2025-08-14 23:50:32,600 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:50:32,612 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:50:32,614 - etl.pipeline - INFO - ============================================================
2025-08-14 23:50:32,615 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:50:32,616 - etl.pipeline - INFO - ============================================================
2025-08-14 23:50:32,621 - etl.pipeline - INFO - Location: 26.8128974, 87.2839978
2025-08-14 23:50:32,624 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:50:32.624062
2025-08-14 23:50:32,626 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:50:32,627 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:50:32,629 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:50:32,630 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.8128974, 87.2839978
2025-08-14 23:50:32,632 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:50:32,633 - etl.extract - INFO - Fetching weather forecast for 26.8128974, 87.2839978
2025-08-14 23:50:33,422 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:50:33,423 - etl.extract - INFO - Fetching air quality data for 26.8128974, 87.2839978
2025-08-14 23:50:34,276 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:50:34,278 - etl.extract - INFO - Data extraction completed in 1.64 seconds
2025-08-14 23:50:34,279 - etl.extract - INFO - Data validation successful
2025-08-14 23:50:34,280 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:50:34,281 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:50:34,282 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:50:34,282 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:50:34,283 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:50:34,284 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:50:34,284 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:50:34,286 - etl.transform - INFO - Starting data transformation
2025-08-14 23:50:34,289 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:50:34,291 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:50:34,297 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:50:34,298 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:50:34,299 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:50:34,303 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:50:34,306 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:50:34,318 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:50:34,324 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:50:34,349 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:50:34,350 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:50:34,350 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:50:34,351 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:50:34,381 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_235034.csv
2025-08-14 23:50:34,382 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.75_lon87.38_20250814_235034.csv
2025-08-14 23:50:34,418 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:50:34,419 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:50:34,419 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.80 SECONDS
2025-08-14 23:50:34,420 - etl.pipeline - INFO - ============================================================
2025-08-14 23:50:34,420 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:50:34,421 - __main__ - INFO - Attempting to get latest record after ETL for 26.8128974, 87.2839978
2025-08-14 23:50:34,425 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:50:34,426 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:50:34,432 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:50:34,432 - __main__ - INFO - Record 1: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:50:34,434 - __main__ - INFO - Record 2: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:50:34,435 - __main__ - INFO - Record 3: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:50:34,441 - __main__ - INFO - Record 4: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:50:34,443 - __main__ - INFO - Record 5: lat=26.75, lon=87.375, created=2025-08-14 16:29:42.270553
2025-08-14 23:50:34,444 - __main__ - INFO - Using nearby record: lat=26.75, lon=87.375
2025-08-14 23:50:34,445 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:50:34,445 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:50:34,446 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.8128974, 87.2839978
2025-08-14 23:50:34,455 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:34] "GET /weather?lat=26.8128974&lon=87.2839978 HTTP/1.1" 200 -
2025-08-14 23:50:37,578 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:37] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 23:50:40,148 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:40] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 23:50:41,407 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:41] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:50:46,167 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:50:46] "GET / HTTP/1.1" 200 -
2025-08-14 23:50:51,965 - __main__ - INFO - Weather route called with lat=27.708317, lon=85.3205817
2025-08-14 23:50:53,127 - __main__ - INFO - Attempting to get latest record for 27.708317, 85.3205817
2025-08-14 23:50:53,131 - __main__ - INFO - Latest record found: False
2025-08-14 23:50:53,132 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:50:53,135 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:50:53,136 - etl.pipeline - INFO - ============================================================
2025-08-14 23:50:53,136 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:50:53,137 - etl.pipeline - INFO - ============================================================
2025-08-14 23:50:53,139 - etl.pipeline - INFO - Location: 27.708317, 85.3205817
2025-08-14 23:50:53,141 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:50:53.141252
2025-08-14 23:50:53,142 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:50:53,143 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:50:53,143 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:50:53,144 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 27.708317, 85.3205817
2025-08-14 23:50:53,145 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:50:53,145 - etl.extract - INFO - Fetching weather forecast for 27.708317, 85.3205817
2025-08-14 23:50:53,970 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:50:53,971 - etl.extract - INFO - Fetching air quality data for 27.708317, 85.3205817
2025-08-14 23:51:14,382 - __main__ - INFO - Weather route called with lat=40.71, lon=-74.01
2025-08-14 23:51:15,471 - __main__ - INFO - Location name: City of New York, New York
2025-08-14 23:51:15,472 - __main__ - INFO - Attempting to get latest record for 40.71, -74.01
2025-08-14 23:51:15,476 - __main__ - INFO - Latest record found: False
2025-08-14 23:51:15,477 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:51:15,486 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:51:15,489 - etl.pipeline - INFO - ============================================================
2025-08-14 23:51:15,500 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:51:15,502 - etl.pipeline - INFO - ============================================================
2025-08-14 23:51:15,504 - etl.pipeline - INFO - Location: 40.71, -74.01
2025-08-14 23:51:15,505 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:51:15.505739
2025-08-14 23:51:15,507 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:51:15,509 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:51:15,509 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:51:15,518 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 40.71, -74.01
2025-08-14 23:51:15,519 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:51:15,520 - etl.extract - INFO - Fetching weather forecast for 40.71, -74.01
2025-08-14 23:51:16,147 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:51:16,148 - etl.extract - INFO - Data extraction completed in 23.00 seconds
2025-08-14 23:51:16,148 - etl.extract - INFO - Data validation successful
2025-08-14 23:51:16,149 - etl.pipeline - INFO - Extraction completed in 23.01 seconds
2025-08-14 23:51:16,149 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:51:16,150 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:51:16,151 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:51:16,151 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:51:16,153 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:51:16,153 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:51:16,154 - etl.transform - ERROR - Input data validation failed
2025-08-14 23:51:16,155 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:51:16,157 - etl.pipeline - INFO - Records created: 0
2025-08-14 23:51:16,157 - etl.pipeline - INFO - Date range: None to None
2025-08-14 23:51:16,158 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-14 23:51:16,159 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-14 23:51:16,160 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-14 23:51:16,161 - __main__ - INFO - ETL pipeline success: False
2025-08-14 23:51:16,168 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:16] "[32mGET /weather?lat=27.708317&lon=85.3205817 HTTP/1.1[0m" 302 -
2025-08-14 23:51:16,319 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:51:16,322 - etl.extract - INFO - Fetching air quality data for 40.71, -74.01
2025-08-14 23:51:17,148 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:51:17,151 - etl.extract - INFO - Data extraction completed in 1.63 seconds
2025-08-14 23:51:17,152 - etl.extract - INFO - Data validation successful
2025-08-14 23:51:17,153 - etl.pipeline - INFO - Extraction completed in 1.64 seconds
2025-08-14 23:51:17,154 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:51:17,155 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:51:17,158 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:51:17,159 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:51:17,161 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:51:17,164 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:51:17,167 - etl.transform - INFO - Starting data transformation
2025-08-14 23:51:17,169 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:51:17,171 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:51:17,171 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:51:17,173 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:51:17,177 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:51:17,180 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:51:17,188 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:51:17,209 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:51:17,222 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:51:17,255 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:51:17,259 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:51:17,262 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:51:17,265 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:51:17,290 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250814_235117.csv
2025-08-14 23:51:17,294 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat40.71_lon-73.99_20250814_235117.csv
2025-08-14 23:51:17,332 - etl.pipeline - INFO - Data loading completed in 0.10 seconds
2025-08-14 23:51:17,334 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:51:17,336 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.85 SECONDS
2025-08-14 23:51:17,337 - etl.pipeline - INFO - ============================================================
2025-08-14 23:51:17,340 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:51:17,342 - __main__ - INFO - Attempting to get latest record after ETL for 40.71, -74.01
2025-08-14 23:51:17,349 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:51:17,349 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:51:17,352 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:51:17,354 - __main__ - INFO - Record 1: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:51:17,354 - __main__ - INFO - Record 2: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:51:17,354 - __main__ - INFO - Record 3: lat=40.710335, lon=-73.99309, created=2025-08-14 17:25:30.310717
2025-08-14 23:51:17,355 - __main__ - INFO - Record 4: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456050
2025-08-14 23:51:17,355 - __main__ - INFO - Record 5: lat=40.710335, lon=-73.99309, created=2025-08-11 20:37:35.456038
2025-08-14 23:51:17,355 - __main__ - INFO - Using nearby record: lat=40.710335, lon=-73.99309
2025-08-14 23:51:17,356 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:51:17,357 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:51:17,357 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 40.71, -74.01
2025-08-14 23:51:17,360 - __main__ - INFO - Rendering weather template for City of New York, New York
2025-08-14 23:51:17,362 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:17] "GET /weather?lat=40.71&lon=-74.01 HTTP/1.1" 200 -
2025-08-14 23:51:21,610 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:21] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:51:24,517 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:24] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:51:31,307 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:31] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:51:31,892 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:31] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-08-14 23:51:36,194 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:36] "GET / HTTP/1.1" 200 -
2025-08-14 23:51:42,465 - __main__ - INFO - Weather route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:51:43,635 - __main__ - INFO - Location name: City of Westminster, England
2025-08-14 23:51:43,636 - __main__ - INFO - Attempting to get latest record for 51.4893335, -0.1440551
2025-08-14 23:51:43,639 - __main__ - INFO - Latest record found: True
2025-08-14 23:51:43,640 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:51:43,642 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:51:43,643 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.4893335, -0.1440551
2025-08-14 23:51:43,672 - __main__ - INFO - Rendering weather template for City of Westminster, England
2025-08-14 23:51:43,678 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:43] "GET /weather?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:51:48,670 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:48] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:51:50,491 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:50] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:51:56,096 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:51:56] "GET / HTTP/1.1" 200 -
2025-08-14 23:52:08,203 - __main__ - INFO - Weather route called with lat=28.0654626, lon=82.535642
2025-08-14 23:52:09,387 - __main__ - INFO - Attempting to get latest record for 28.0654626, 82.535642
2025-08-14 23:52:09,390 - __main__ - INFO - Latest record found: False
2025-08-14 23:52:09,391 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:52:09,401 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:52:09,406 - etl.pipeline - INFO - ============================================================
2025-08-14 23:52:09,409 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:52:09,410 - etl.pipeline - INFO - ============================================================
2025-08-14 23:52:09,414 - etl.pipeline - INFO - Location: 28.0654626, 82.535642
2025-08-14 23:52:09,417 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:52:09.417015
2025-08-14 23:52:09,418 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:52:09,419 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:52:09,420 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:52:09,421 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 28.0654626, 82.535642
2025-08-14 23:52:09,422 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:52:09,425 - etl.extract - INFO - Fetching weather forecast for 28.0654626, 82.535642
2025-08-14 23:52:10,233 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:52:10,235 - etl.extract - INFO - Fetching air quality data for 28.0654626, 82.535642
2025-08-14 23:52:11,069 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:52:11,070 - etl.extract - INFO - Data extraction completed in 1.64 seconds
2025-08-14 23:52:11,070 - etl.extract - INFO - Data validation successful
2025-08-14 23:52:11,071 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:52:11,072 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:52:11,073 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:52:11,075 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:52:11,078 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:52:11,081 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:52:11,083 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:52:11,085 - etl.transform - INFO - Starting data transformation
2025-08-14 23:52:11,101 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:52:11,102 - etl.pipeline - INFO - Transformation completed in 0.02 seconds
2025-08-14 23:52:11,103 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:52:11,105 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:52:11,106 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:52:11,107 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:52:11,108 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:52:11,125 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:52:11,137 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:52:11,173 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:52:11,175 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:52:11,177 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:52:11,178 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:52:11,201 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat28.12_lon82.50_20250814_235211.csv
2025-08-14 23:52:11,201 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat28.12_lon82.50_20250814_235211.csv
2025-08-14 23:52:11,243 - etl.pipeline - INFO - Data loading completed in 0.09 seconds
2025-08-14 23:52:11,244 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:52:11,244 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.84 SECONDS
2025-08-14 23:52:11,245 - etl.pipeline - INFO - ============================================================
2025-08-14 23:52:11,246 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:52:11,247 - __main__ - INFO - Attempting to get latest record after ETL for 28.0654626, 82.535642
2025-08-14 23:52:11,251 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:52:11,252 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:52:11,261 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:52:11,262 - __main__ - INFO - Record 1: lat=28.125, lon=82.5, created=2025-08-14 18:07:11.099890
2025-08-14 23:52:11,262 - __main__ - INFO - Record 2: lat=28.125, lon=82.5, created=2025-08-14 18:07:11.099890
2025-08-14 23:52:11,265 - __main__ - INFO - Record 3: lat=28.125, lon=82.5, created=2025-08-14 18:07:11.099890
2025-08-14 23:52:11,265 - __main__ - INFO - Record 4: lat=28.125, lon=82.5, created=2025-08-14 18:07:11.099890
2025-08-14 23:52:11,266 - __main__ - INFO - Record 5: lat=28.125, lon=82.5, created=2025-08-14 18:07:11.098894
2025-08-14 23:52:11,267 - __main__ - INFO - Using nearby record: lat=28.125, lon=82.5
2025-08-14 23:52:11,268 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:52:11,269 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:52:11,272 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 28.0654626, 82.535642
2025-08-14 23:52:11,286 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:52:11] "GET /weather?lat=28.0654626&lon=82.535642 HTTP/1.1" 200 -
2025-08-14 23:52:14,542 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:52:14] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:52:17,577 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:52:17] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:52:30,269 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:52:30] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:52:38,548 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:52:38] "GET /stats HTTP/1.1" 200 -
2025-08-14 23:53:00,774 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:00] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:53:11,842 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:11] "POST /remove-favorite HTTP/1.1" 200 -
2025-08-14 23:53:12,907 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:12] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:53:16,017 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:16] "POST /remove-favorite HTTP/1.1" 200 -
2025-08-14 23:53:17,063 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:17] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:53:19,635 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:19] "GET / HTTP/1.1" 200 -
2025-08-14 23:53:25,681 - __main__ - INFO - Weather route called with lat=26.5837354, lon=87.885701
2025-08-14 23:53:26,816 - __main__ - INFO - Attempting to get latest record for 26.5837354, 87.885701
2025-08-14 23:53:26,821 - __main__ - INFO - Latest record found: False
2025-08-14 23:53:26,823 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:53:26,834 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:53:26,839 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:26,840 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:53:26,841 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:26,844 - etl.pipeline - INFO - Location: 26.5837354, 87.885701
2025-08-14 23:53:26,846 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:53:26.846334
2025-08-14 23:53:26,851 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:26,854 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:53:26,856 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:26,857 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.5837354, 87.885701
2025-08-14 23:53:26,857 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:53:26,860 - etl.extract - INFO - Fetching weather forecast for 26.5837354, 87.885701
2025-08-14 23:53:27,681 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:53:27,681 - etl.extract - INFO - Fetching air quality data for 26.5837354, 87.885701
2025-08-14 23:53:28,506 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:53:28,507 - etl.extract - INFO - Data extraction completed in 1.65 seconds
2025-08-14 23:53:28,509 - etl.extract - INFO - Data validation successful
2025-08-14 23:53:28,511 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:53:28,512 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:53:28,512 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:53:28,514 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:28,517 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:53:28,519 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:28,520 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:53:28,531 - etl.transform - INFO - Starting data transformation
2025-08-14 23:53:28,536 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:53:28,538 - etl.pipeline - INFO - Transformation completed in 0.02 seconds
2025-08-14 23:53:28,539 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:53:28,542 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:53:28,544 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:28,545 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:53:28,546 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:28,559 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:53:28,567 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:53:28,583 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:53:28,584 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:53:28,585 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:53:28,586 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:53:28,596 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235328.csv
2025-08-14 23:53:28,596 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235328.csv
2025-08-14 23:53:28,630 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-14 23:53:28,631 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:53:28,632 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.79 SECONDS
2025-08-14 23:53:28,632 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:28,633 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:53:28,634 - __main__ - INFO - Attempting to get latest record after ETL for 26.5837354, 87.885701
2025-08-14 23:53:28,636 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:53:28,636 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:53:28,637 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:53:28,638 - __main__ - INFO - Record 1: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:28,638 - __main__ - INFO - Record 2: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:28,638 - __main__ - INFO - Record 3: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:28,639 - __main__ - INFO - Record 4: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:28,639 - __main__ - INFO - Record 5: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:28,639 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.875
2025-08-14 23:53:28,640 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:53:28,640 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:53:28,640 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.5837354, 87.885701
2025-08-14 23:53:28,648 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:28] "GET /weather?lat=26.5837354&lon=87.885701 HTTP/1.1" 200 -
2025-08-14 23:53:31,930 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:31] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:53:33,946 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:33] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:53:41,546 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:53:41,548 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:41,549 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:53:41,549 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:41,550 - etl.pipeline - INFO - Location: 26.5837354, 87.885701
2025-08-14 23:53:41,551 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:53:41.551429
2025-08-14 23:53:41,552 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:41,552 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:53:41,552 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:41,553 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.5837354, 87.885701
2025-08-14 23:53:41,555 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:53:41,556 - etl.extract - INFO - Fetching weather forecast for 26.5837354, 87.885701
2025-08-14 23:53:42,388 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:53:42,389 - etl.extract - INFO - Fetching air quality data for 26.5837354, 87.885701
2025-08-14 23:53:43,195 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:53:43,196 - etl.extract - INFO - Data extraction completed in 1.64 seconds
2025-08-14 23:53:43,197 - etl.extract - INFO - Data validation successful
2025-08-14 23:53:43,198 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:53:43,199 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:53:43,201 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:53:43,201 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:43,203 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:53:43,204 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:43,204 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:53:43,205 - etl.transform - INFO - Starting data transformation
2025-08-14 23:53:43,206 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:53:43,208 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:53:43,210 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:53:43,211 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:53:43,212 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:43,213 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:53:43,214 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:43,223 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:53:43,241 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:53:43,271 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:53:43,272 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:53:43,274 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:53:43,275 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:53:43,291 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235343.csv
2025-08-14 23:53:43,292 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235343.csv
2025-08-14 23:53:43,336 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:53:43,338 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:53:43,339 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.79 SECONDS
2025-08-14 23:53:43,340 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:43,342 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:43] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-14 23:53:44,902 - __main__ - INFO - Weather route called with lat=26.5837354, lon=87.885701
2025-08-14 23:53:46,004 - __main__ - INFO - Attempting to get latest record for 26.5837354, 87.885701
2025-08-14 23:53:46,012 - __main__ - INFO - Latest record found: False
2025-08-14 23:53:46,014 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:53:46,025 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:53:46,026 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:46,028 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:53:46,029 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:46,030 - etl.pipeline - INFO - Location: 26.5837354, 87.885701
2025-08-14 23:53:46,034 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:53:46.033206
2025-08-14 23:53:46,034 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:46,035 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:53:46,036 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:46,038 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 26.5837354, 87.885701
2025-08-14 23:53:46,039 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:53:46,040 - etl.extract - INFO - Fetching weather forecast for 26.5837354, 87.885701
2025-08-14 23:53:46,840 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:53:46,841 - etl.extract - INFO - Fetching air quality data for 26.5837354, 87.885701
2025-08-14 23:53:47,659 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:53:47,660 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-08-14 23:53:47,661 - etl.extract - INFO - Data validation successful
2025-08-14 23:53:47,663 - etl.pipeline - INFO - Extraction completed in 1.62 seconds
2025-08-14 23:53:47,664 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:53:47,665 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:53:47,666 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:47,668 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:53:47,669 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:47,669 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:53:47,670 - etl.transform - INFO - Starting data transformation
2025-08-14 23:53:47,673 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:53:47,676 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:53:47,677 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:53:47,678 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:53:47,682 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:53:47,684 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:53:47,685 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:53:47,696 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:53:47,704 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:53:47,727 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:53:47,728 - etl.load - INFO -   - Inserted: 0 new records
2025-08-14 23:53:47,728 - etl.load - INFO -   - Updated: 7 existing records
2025-08-14 23:53:47,732 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:53:47,744 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235347.csv
2025-08-14 23:53:47,745 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat26.62_lon87.88_20250814_235347.csv
2025-08-14 23:53:47,779 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 23:53:47,779 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:53:47,780 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-08-14 23:53:47,780 - etl.pipeline - INFO - ============================================================
2025-08-14 23:53:47,780 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:53:47,781 - __main__ - INFO - Attempting to get latest record after ETL for 26.5837354, 87.885701
2025-08-14 23:53:47,782 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:53:47,782 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:53:47,784 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:53:47,785 - __main__ - INFO - Record 1: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:47,785 - __main__ - INFO - Record 2: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:47,786 - __main__ - INFO - Record 3: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:47,786 - __main__ - INFO - Record 4: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:47,786 - __main__ - INFO - Record 5: lat=26.625, lon=87.875, created=2025-08-14 18:08:28.536723
2025-08-14 23:53:47,786 - __main__ - INFO - Using nearby record: lat=26.625, lon=87.875
2025-08-14 23:53:47,788 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:53:47,788 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:53:47,788 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 26.5837354, 87.885701
2025-08-14 23:53:47,800 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:47] "GET /weather?lat=26.5837354&lon=87.885701 HTTP/1.1" 200 -
2025-08-14 23:53:51,215 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:51] "[31m[1mPOST /add-favorite HTTP/1.1[0m" 400 -
2025-08-14 23:53:53,766 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:53] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:53:57,969 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:53:57] "GET /stats HTTP/1.1" 200 -
2025-08-14 23:54:08,871 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:08] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:54:10,963 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:10] "GET / HTTP/1.1" 200 -
2025-08-14 23:54:18,267 - __main__ - INFO - Weather route called with lat=51.4893335, lon=-0.1440551
2025-08-14 23:54:19,428 - __main__ - INFO - Location name: London, England
2025-08-14 23:54:19,430 - __main__ - INFO - Attempting to get latest record for 51.4893335, -0.1440551
2025-08-14 23:54:19,435 - __main__ - INFO - Latest record found: True
2025-08-14 23:54:19,437 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:54:19,439 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:54:19,440 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 51.4893335, -0.1440551
2025-08-14 23:54:19,457 - __main__ - INFO - Rendering weather template for London, England
2025-08-14 23:54:19,464 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:19] "GET /weather?lat=51.4893335&lon=-0.1440551 HTTP/1.1" 200 -
2025-08-14 23:54:23,488 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:23] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:54:28,605 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:28] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:54:30,383 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:30] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:54:36,049 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:36] "GET / HTTP/1.1" 200 -
2025-08-14 23:54:39,629 - __main__ - INFO - Weather route called with lat=35.69, lon=139.69
2025-08-14 23:54:40,688 - __main__ - INFO - Attempting to get latest record for 35.69, 139.69
2025-08-14 23:54:40,693 - __main__ - INFO - Latest record found: False
2025-08-14 23:54:40,694 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:54:40,713 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:54:40,715 - etl.pipeline - INFO - ============================================================
2025-08-14 23:54:40,722 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:54:40,724 - etl.pipeline - INFO - ============================================================
2025-08-14 23:54:40,725 - etl.pipeline - INFO - Location: 35.69, 139.69
2025-08-14 23:54:40,726 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:54:40.726771
2025-08-14 23:54:40,731 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:54:40,732 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:54:40,735 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:54:40,739 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.69, 139.69
2025-08-14 23:54:40,743 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:54:40,744 - etl.extract - INFO - Fetching weather forecast for 35.69, 139.69
2025-08-14 23:54:41,539 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:54:41,539 - etl.extract - INFO - Fetching air quality data for 35.69, 139.69
2025-08-14 23:54:42,360 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:54:42,361 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-08-14 23:54:42,361 - etl.extract - INFO - Data validation successful
2025-08-14 23:54:42,362 - etl.pipeline - INFO - Extraction completed in 1.62 seconds
2025-08-14 23:54:42,363 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:54:42,363 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:54:42,364 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:54:42,364 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:54:42,364 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:54:42,365 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:54:42,365 - etl.transform - INFO - Starting data transformation
2025-08-14 23:54:42,367 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:54:42,368 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:54:42,368 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:54:42,368 - etl.pipeline - INFO - Date range: 2025-08-15 to 2025-08-21
2025-08-14 23:54:42,369 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:54:42,372 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:54:42,373 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:54:42,383 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:54:42,395 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:54:42,418 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:54:42,419 - etl.load - INFO -   - Inserted: 3 new records
2025-08-14 23:54:42,421 - etl.load - INFO -   - Updated: 4 existing records
2025-08-14 23:54:42,422 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:54:42,433 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250814_235442.csv
2025-08-14 23:54:42,434 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.69_20250814_235442.csv
2025-08-14 23:54:42,468 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 23:54:42,468 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:54:42,469 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-08-14 23:54:42,469 - etl.pipeline - INFO - ============================================================
2025-08-14 23:54:42,469 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:54:42,471 - __main__ - INFO - Attempting to get latest record after ETL for 35.69, 139.69
2025-08-14 23:54:42,473 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:54:42,473 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:54:42,475 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:54:42,475 - __main__ - INFO - Record 1: lat=35.7, lon=139.6875, created=2025-08-14 18:09:42.367278
2025-08-14 23:54:42,476 - __main__ - INFO - Record 2: lat=35.7, lon=139.6875, created=2025-08-14 18:09:42.367278
2025-08-14 23:54:42,476 - __main__ - INFO - Record 3: lat=35.7, lon=139.6875, created=2025-08-14 18:09:42.367278
2025-08-14 23:54:42,477 - __main__ - INFO - Record 4: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485611
2025-08-14 23:54:42,478 - __main__ - INFO - Record 5: lat=35.7, lon=139.6875, created=2025-08-11 20:35:40.485591
2025-08-14 23:54:42,479 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.6875
2025-08-14 23:54:42,479 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:54:42,480 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:54:42,480 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.69, 139.69
2025-08-14 23:54:42,491 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:42] "GET /weather?lat=35.69&lon=139.69 HTTP/1.1" 200 -
2025-08-14 23:54:45,986 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:45] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:54:46,927 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:46] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:54:52,053 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:54:52] "GET / HTTP/1.1" 200 -
2025-08-14 23:54:58,076 - __main__ - INFO - Weather route called with lat=52.4796992, lon=-1.9026911
2025-08-14 23:54:59,194 - __main__ - INFO - Location name: Birmingham, England
2025-08-14 23:54:59,195 - __main__ - INFO - Attempting to get latest record for 52.4796992, -1.9026911
2025-08-14 23:54:59,198 - __main__ - INFO - Latest record found: False
2025-08-14 23:54:59,200 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:54:59,209 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:54:59,210 - etl.pipeline - INFO - ============================================================
2025-08-14 23:54:59,211 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:54:59,212 - etl.pipeline - INFO - ============================================================
2025-08-14 23:54:59,214 - etl.pipeline - INFO - Location: 52.4796992, -1.9026911
2025-08-14 23:54:59,216 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:54:59.216635
2025-08-14 23:54:59,217 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:54:59,218 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:54:59,220 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:54:59,227 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 52.4796992, -1.9026911
2025-08-14 23:54:59,231 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:54:59,233 - etl.extract - INFO - Fetching weather forecast for 52.4796992, -1.9026911
2025-08-14 23:55:00,072 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:55:00,073 - etl.extract - INFO - Fetching air quality data for 52.4796992, -1.9026911
2025-08-14 23:55:00,964 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:55:00,966 - etl.extract - INFO - Data extraction completed in 1.73 seconds
2025-08-14 23:55:00,967 - etl.extract - INFO - Data validation successful
2025-08-14 23:55:00,967 - etl.pipeline - INFO - Extraction completed in 1.75 seconds
2025-08-14 23:55:00,968 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:55:00,969 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:55:00,970 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:55:00,970 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:55:00,971 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:55:00,971 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:55:00,972 - etl.transform - INFO - Starting data transformation
2025-08-14 23:55:00,973 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:55:00,973 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:55:00,973 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:55:00,974 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:55:00,975 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:55:00,976 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:55:00,976 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:55:00,985 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:55:00,988 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:55:01,004 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:55:01,005 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:55:01,006 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:55:01,008 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:55:01,016 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat52.48_lon-1.90_20250814_235501.csv
2025-08-14 23:55:01,017 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat52.48_lon-1.90_20250814_235501.csv
2025-08-14 23:55:01,048 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-14 23:55:01,048 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:55:01,050 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.84 SECONDS
2025-08-14 23:55:01,050 - etl.pipeline - INFO - ============================================================
2025-08-14 23:55:01,051 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:55:01,052 - __main__ - INFO - Attempting to get latest record after ETL for 52.4796992, -1.9026911
2025-08-14 23:55:01,053 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:55:01,054 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:55:01,056 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:55:01,057 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 52.4796992, -1.9026911
2025-08-14 23:55:01,076 - __main__ - INFO - Rendering weather template for Birmingham, England
2025-08-14 23:55:01,078 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:01] "GET /weather?lat=52.4796992&lon=-1.9026911 HTTP/1.1" 200 -
2025-08-14 23:55:05,100 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:05] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:55:07,194 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:07] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:55:12,358 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:12] "GET / HTTP/1.1" 200 -
2025-08-14 23:55:27,209 - __main__ - INFO - Weather route called with lat=35.9263502, lon=136.6068127
2025-08-14 23:55:28,312 - __main__ - INFO - Attempting to get latest record for 35.9263502, 136.6068127
2025-08-14 23:55:28,315 - __main__ - INFO - Latest record found: False
2025-08-14 23:55:28,316 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:55:28,329 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:55:28,332 - etl.pipeline - INFO - ============================================================
2025-08-14 23:55:28,337 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:55:28,338 - etl.pipeline - INFO - ============================================================
2025-08-14 23:55:28,340 - etl.pipeline - INFO - Location: 35.9263502, 136.6068127
2025-08-14 23:55:28,341 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:55:28.340014
2025-08-14 23:55:28,342 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:55:28,343 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:55:28,344 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:55:28,345 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.9263502, 136.6068127
2025-08-14 23:55:28,349 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:55:28,353 - etl.extract - INFO - Fetching weather forecast for 35.9263502, 136.6068127
2025-08-14 23:55:29,182 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:55:29,183 - etl.extract - INFO - Fetching air quality data for 35.9263502, 136.6068127
2025-08-14 23:55:30,031 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:55:30,032 - etl.extract - INFO - Data extraction completed in 1.68 seconds
2025-08-14 23:55:30,035 - etl.extract - INFO - Data validation successful
2025-08-14 23:55:30,037 - etl.pipeline - INFO - Extraction completed in 1.69 seconds
2025-08-14 23:55:30,037 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:55:30,039 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:55:30,039 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:55:30,042 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:55:30,051 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:55:30,054 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:55:30,056 - etl.transform - INFO - Starting data transformation
2025-08-14 23:55:30,057 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:55:30,058 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:55:30,060 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:55:30,061 - etl.pipeline - INFO - Date range: 2025-08-15 to 2025-08-21
2025-08-14 23:55:30,063 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:55:30,064 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:55:30,065 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:55:30,077 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:55:30,091 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:55:30,109 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:55:30,111 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:55:30,112 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:55:30,114 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:55:30,131 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.95_lon136.62_20250814_235530.csv
2025-08-14 23:55:30,132 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.95_lon136.62_20250814_235530.csv
2025-08-14 23:55:30,165 - etl.pipeline - INFO - Data loading completed in 0.07 seconds
2025-08-14 23:55:30,166 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:55:30,167 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.83 SECONDS
2025-08-14 23:55:30,169 - etl.pipeline - INFO - ============================================================
2025-08-14 23:55:30,170 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:55:30,171 - __main__ - INFO - Attempting to get latest record after ETL for 35.9263502, 136.6068127
2025-08-14 23:55:30,174 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:55:30,175 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:55:30,191 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:55:30,192 - __main__ - INFO - Record 1: lat=35.95, lon=136.625, created=2025-08-14 18:10:30.057910
2025-08-14 23:55:30,193 - __main__ - INFO - Record 2: lat=35.95, lon=136.625, created=2025-08-14 18:10:30.057910
2025-08-14 23:55:30,194 - __main__ - INFO - Record 3: lat=35.95, lon=136.625, created=2025-08-14 18:10:30.057910
2025-08-14 23:55:30,195 - __main__ - INFO - Record 4: lat=35.95, lon=136.625, created=2025-08-14 18:10:30.057910
2025-08-14 23:55:30,197 - __main__ - INFO - Record 5: lat=35.95, lon=136.625, created=2025-08-14 18:10:30.057910
2025-08-14 23:55:30,198 - __main__ - INFO - Using nearby record: lat=35.95, lon=136.625
2025-08-14 23:55:30,199 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:55:30,201 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:55:30,202 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.9263502, 136.6068127
2025-08-14 23:55:30,209 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:30] "GET /weather?lat=35.9263502&lon=136.6068127 HTTP/1.1" 200 -
2025-08-14 23:55:34,209 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:34] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:55:35,718 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:35] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:55:39,277 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:39] "GET / HTTP/1.1" 200 -
2025-08-14 23:55:48,312 - __main__ - INFO - Weather route called with lat=28.3780464, lon=83.9999901
2025-08-14 23:55:49,470 - __main__ - INFO - Attempting to get latest record for 28.3780464, 83.9999901
2025-08-14 23:55:49,474 - __main__ - INFO - Latest record found: True
2025-08-14 23:55:49,476 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:55:49,478 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:55:49,479 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 28.3780464, 83.9999901
2025-08-14 23:55:49,511 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:49] "GET /weather?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
2025-08-14 23:55:53,403 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:53] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:55:54,622 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:55:54] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:56:15,434 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:15] "GET / HTTP/1.1" 200 -
2025-08-14 23:56:23,138 - __main__ - INFO - Weather route called with lat=53.4794892, lon=-2.2451148
2025-08-14 23:56:24,212 - __main__ - INFO - Location name: Manchester, England
2025-08-14 23:56:24,212 - __main__ - INFO - Attempting to get latest record for 53.4794892, -2.2451148
2025-08-14 23:56:24,216 - __main__ - INFO - Latest record found: False
2025-08-14 23:56:24,217 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:56:24,226 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:56:24,228 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:24,228 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:56:24,228 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:24,229 - etl.pipeline - INFO - Location: 53.4794892, -2.2451148
2025-08-14 23:56:24,230 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:56:24.229947
2025-08-14 23:56:24,236 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:24,236 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:56:24,238 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:24,238 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 53.4794892, -2.2451148
2025-08-14 23:56:24,239 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:56:24,240 - etl.extract - INFO - Fetching weather forecast for 53.4794892, -2.2451148
2025-08-14 23:56:25,020 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:56:25,021 - etl.extract - INFO - Fetching air quality data for 53.4794892, -2.2451148
2025-08-14 23:56:25,832 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:56:25,835 - etl.extract - INFO - Data extraction completed in 1.59 seconds
2025-08-14 23:56:25,837 - etl.extract - INFO - Data validation successful
2025-08-14 23:56:25,838 - etl.pipeline - INFO - Extraction completed in 1.60 seconds
2025-08-14 23:56:25,839 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:56:25,840 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:56:25,841 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:25,842 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:56:25,843 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:25,844 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:56:25,846 - etl.transform - INFO - Starting data transformation
2025-08-14 23:56:25,848 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:56:25,854 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:56:25,855 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:56:25,856 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:56:25,858 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:25,859 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:56:25,861 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:25,880 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:56:25,893 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:56:25,928 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:56:25,929 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:56:25,930 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:56:25,930 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:56:25,942 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat53.48_lon-2.24_20250814_235625.csv
2025-08-14 23:56:25,943 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat53.48_lon-2.24_20250814_235625.csv
2025-08-14 23:56:25,970 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:56:25,971 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:56:25,972 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.74 SECONDS
2025-08-14 23:56:25,972 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:25,972 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:56:25,973 - __main__ - INFO - Attempting to get latest record after ETL for 53.4794892, -2.2451148
2025-08-14 23:56:25,975 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:56:25,976 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:56:25,977 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:56:25,977 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4794892, -2.2451148
2025-08-14 23:56:25,984 - __main__ - INFO - Rendering weather template for Manchester, England
2025-08-14 23:56:25,986 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:25] "GET /weather?lat=53.4794892&lon=-2.2451148 HTTP/1.1" 200 -
2025-08-14 23:56:29,214 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:29] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:56:30,262 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:30] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:56:45,101 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:45] "GET / HTTP/1.1" 200 -
2025-08-14 23:56:49,030 - __main__ - INFO - Weather route called with lat=35.6768601, lon=139.7638947
2025-08-14 23:56:50,095 - __main__ - INFO - Attempting to get latest record for 35.6768601, 139.7638947
2025-08-14 23:56:50,107 - __main__ - INFO - Latest record found: False
2025-08-14 23:56:50,109 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:56:50,124 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:56:50,126 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:50,127 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:56:50,137 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:50,141 - etl.pipeline - INFO - Location: 35.6768601, 139.7638947
2025-08-14 23:56:50,142 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:56:50.142996
2025-08-14 23:56:50,144 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:50,145 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:56:50,147 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:50,149 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 35.6768601, 139.7638947
2025-08-14 23:56:50,152 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:56:50,154 - etl.extract - INFO - Fetching weather forecast for 35.6768601, 139.7638947
2025-08-14 23:56:50,964 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:56:50,964 - etl.extract - INFO - Fetching air quality data for 35.6768601, 139.7638947
2025-08-14 23:56:51,821 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:56:51,823 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 23:56:51,824 - etl.extract - INFO - Data validation successful
2025-08-14 23:56:51,825 - etl.pipeline - INFO - Extraction completed in 1.68 seconds
2025-08-14 23:56:51,826 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:56:51,827 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:56:51,827 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:51,828 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:56:51,830 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:51,833 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:56:51,833 - etl.transform - INFO - Starting data transformation
2025-08-14 23:56:51,836 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:56:51,838 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:56:51,841 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:56:51,842 - etl.pipeline - INFO - Date range: 2025-08-15 to 2025-08-21
2025-08-14 23:56:51,844 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:56:51,845 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:56:51,845 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:56:51,857 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:56:51,867 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:56:51,889 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:56:51,889 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:56:51,890 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:56:51,890 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:56:51,900 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.75_20250814_235651.csv
2025-08-14 23:56:51,901 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat35.70_lon139.75_20250814_235651.csv
2025-08-14 23:56:51,952 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 23:56:51,953 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:56:51,953 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.83 SECONDS
2025-08-14 23:56:51,954 - etl.pipeline - INFO - ============================================================
2025-08-14 23:56:51,954 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:56:51,954 - __main__ - INFO - Attempting to get latest record after ETL for 35.6768601, 139.7638947
2025-08-14 23:56:51,955 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:56:51,956 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:56:51,958 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:56:51,958 - __main__ - INFO - Record 1: lat=35.7, lon=139.75, created=2025-08-14 18:11:51.836637
2025-08-14 23:56:51,958 - __main__ - INFO - Record 2: lat=35.7, lon=139.75, created=2025-08-14 18:11:51.836637
2025-08-14 23:56:51,960 - __main__ - INFO - Record 3: lat=35.7, lon=139.75, created=2025-08-14 18:11:51.836637
2025-08-14 23:56:51,960 - __main__ - INFO - Record 4: lat=35.7, lon=139.75, created=2025-08-14 18:11:51.836637
2025-08-14 23:56:51,960 - __main__ - INFO - Record 5: lat=35.7, lon=139.75, created=2025-08-14 18:11:51.835686
2025-08-14 23:56:51,961 - __main__ - INFO - Using nearby record: lat=35.7, lon=139.75
2025-08-14 23:56:51,961 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:56:51,961 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:56:51,962 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 35.6768601, 139.7638947
2025-08-14 23:56:51,971 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:51] "GET /weather?lat=35.6768601&lon=139.7638947 HTTP/1.1" 200 -
2025-08-14 23:56:55,643 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:55] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:56:56,781 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:56:56] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:57:01,642 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:01] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:57:03,823 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:03] "GET / HTTP/1.1" 200 -
2025-08-14 23:57:07,556 - __main__ - INFO - Weather route called with lat=36.5748441, lon=139.2394179
2025-08-14 23:57:08,650 - __main__ - INFO - Attempting to get latest record for 36.5748441, 139.2394179
2025-08-14 23:57:08,654 - __main__ - INFO - Latest record found: False
2025-08-14 23:57:08,655 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:57:08,664 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:57:08,668 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:08,670 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:57:08,672 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:08,685 - etl.pipeline - INFO - Location: 36.5748441, 139.2394179
2025-08-14 23:57:08,687 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:57:08.687516
2025-08-14 23:57:08,689 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:08,691 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:57:08,692 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:08,693 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 36.5748441, 139.2394179
2025-08-14 23:57:08,694 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:57:08,695 - etl.extract - INFO - Fetching weather forecast for 36.5748441, 139.2394179
2025-08-14 23:57:09,504 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:57:09,505 - etl.extract - INFO - Fetching air quality data for 36.5748441, 139.2394179
2025-08-14 23:57:10,446 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:57:10,448 - etl.extract - INFO - Data extraction completed in 1.75 seconds
2025-08-14 23:57:10,449 - etl.extract - INFO - Data validation successful
2025-08-14 23:57:10,449 - etl.pipeline - INFO - Extraction completed in 1.76 seconds
2025-08-14 23:57:10,450 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:57:10,451 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:57:10,451 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:10,455 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:57:10,457 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:10,458 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:57:10,460 - etl.transform - INFO - Starting data transformation
2025-08-14 23:57:10,462 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:57:10,463 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:57:10,464 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:57:10,466 - etl.pipeline - INFO - Date range: 2025-08-15 to 2025-08-21
2025-08-14 23:57:10,472 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:10,474 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:57:10,475 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:10,487 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:57:10,494 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:57:10,528 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:57:10,530 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:57:10,531 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:57:10,534 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:57:10,555 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat36.55_lon139.25_20250814_235710.csv
2025-08-14 23:57:10,555 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat36.55_lon139.25_20250814_235710.csv
2025-08-14 23:57:10,594 - etl.pipeline - INFO - Data loading completed in 0.08 seconds
2025-08-14 23:57:10,595 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:57:10,595 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.93 SECONDS
2025-08-14 23:57:10,596 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:10,596 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:57:10,596 - __main__ - INFO - Attempting to get latest record after ETL for 36.5748441, 139.2394179
2025-08-14 23:57:10,598 - __main__ - INFO - Latest record after ETL: False
2025-08-14 23:57:10,598 - __main__ - WARNING - No exact match found, trying with wider tolerance...
2025-08-14 23:57:10,601 - __main__ - INFO - Found 5 records within 0.1 degrees
2025-08-14 23:57:10,603 - __main__ - INFO - Record 1: lat=36.55, lon=139.25, created=2025-08-14 18:12:10.462030
2025-08-14 23:57:10,604 - __main__ - INFO - Record 2: lat=36.55, lon=139.25, created=2025-08-14 18:12:10.462030
2025-08-14 23:57:10,605 - __main__ - INFO - Record 3: lat=36.55, lon=139.25, created=2025-08-14 18:12:10.462030
2025-08-14 23:57:10,605 - __main__ - INFO - Record 4: lat=36.55, lon=139.25, created=2025-08-14 18:12:10.462030
2025-08-14 23:57:10,606 - __main__ - INFO - Record 5: lat=36.55, lon=139.25, created=2025-08-14 18:12:10.462030
2025-08-14 23:57:10,607 - __main__ - INFO - Using nearby record: lat=36.55, lon=139.25
2025-08-14 23:57:10,608 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:57:10,609 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:57:10,613 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 36.5748441, 139.2394179
2025-08-14 23:57:10,621 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:10] "GET /weather?lat=36.5748441&lon=139.2394179 HTTP/1.1" 200 -
2025-08-14 23:57:13,694 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:13] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:57:14,950 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:14] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:57:19,781 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:19] "GET / HTTP/1.1" 200 -
2025-08-14 23:57:36,535 - __main__ - INFO - Weather route called with lat=-33.87, lon=151.21
2025-08-14 23:57:37,638 - __main__ - INFO - Location name: Sydney, New South Wales
2025-08-14 23:57:37,639 - __main__ - INFO - Attempting to get latest record for -33.87, 151.21
2025-08-14 23:57:37,642 - __main__ - INFO - Latest record found: False
2025-08-14 23:57:37,644 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:57:37,649 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:57:37,651 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:37,655 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:57:37,655 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:37,656 - etl.pipeline - INFO - Location: -33.87, 151.21
2025-08-14 23:57:37,658 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:57:37.656997
2025-08-14 23:57:37,658 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:37,659 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:57:37,661 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:37,662 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.87, 151.21
2025-08-14 23:57:37,665 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:57:37,675 - etl.extract - INFO - Fetching weather forecast for -33.87, 151.21
2025-08-14 23:57:38,465 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:57:38,466 - etl.extract - INFO - Fetching air quality data for -33.87, 151.21
2025-08-14 23:57:39,292 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:57:39,292 - etl.extract - INFO - Data extraction completed in 1.62 seconds
2025-08-14 23:57:39,294 - etl.extract - INFO - Data validation successful
2025-08-14 23:57:39,295 - etl.pipeline - INFO - Extraction completed in 1.63 seconds
2025-08-14 23:57:39,296 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:57:39,297 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:57:39,298 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:39,298 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:57:39,299 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:39,301 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:57:39,302 - etl.transform - ERROR - Input data validation failed
2025-08-14 23:57:39,304 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:57:39,306 - etl.pipeline - INFO - Records created: 0
2025-08-14 23:57:39,307 - etl.pipeline - INFO - Date range: None to None
2025-08-14 23:57:39,308 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-14 23:57:39,309 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-14 23:57:39,310 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-14 23:57:39,312 - __main__ - INFO - ETL pipeline success: False
2025-08-14 23:57:39,319 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:39] "[32mGET /weather?lat=-33.87&lon=151.21 HTTP/1.1[0m" 302 -
2025-08-14 23:57:39,351 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:39] "GET / HTTP/1.1" 200 -
2025-08-14 23:57:45,906 - __main__ - INFO - Weather route called with lat=-33.8698439, lon=151.2082848
2025-08-14 23:57:47,051 - __main__ - INFO - Location name: Sydney, New South Wales
2025-08-14 23:57:47,052 - __main__ - INFO - Attempting to get latest record for -33.8698439, 151.2082848
2025-08-14 23:57:47,058 - __main__ - INFO - Latest record found: False
2025-08-14 23:57:47,059 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:57:47,071 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:57:47,072 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:47,074 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:57:47,075 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:47,077 - etl.pipeline - INFO - Location: -33.8698439, 151.2082848
2025-08-14 23:57:47,080 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:57:47.078127
2025-08-14 23:57:47,080 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:47,082 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:57:47,084 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:47,086 - etl.extract - INFO - WeatherExtractor initialized for coordinates: -33.8698439, 151.2082848
2025-08-14 23:57:47,089 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:57:47,094 - etl.extract - INFO - Fetching weather forecast for -33.8698439, 151.2082848
2025-08-14 23:57:47,918 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:57:47,920 - etl.extract - INFO - Fetching air quality data for -33.8698439, 151.2082848
2025-08-14 23:57:48,788 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:57:48,788 - etl.extract - INFO - Data extraction completed in 1.69 seconds
2025-08-14 23:57:48,790 - etl.extract - INFO - Data validation successful
2025-08-14 23:57:48,791 - etl.pipeline - INFO - Extraction completed in 1.71 seconds
2025-08-14 23:57:48,792 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:57:48,793 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:57:48,794 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:48,795 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:57:48,796 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:48,797 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:57:48,799 - etl.transform - ERROR - Input data validation failed
2025-08-14 23:57:48,800 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-14 23:57:48,801 - etl.pipeline - INFO - Records created: 0
2025-08-14 23:57:48,805 - etl.pipeline - INFO - Date range: None to None
2025-08-14 23:57:48,807 - etl.pipeline - WARNING - Transformation completed with 1 errors
2025-08-14 23:57:48,810 - etl.pipeline - WARNING -   - Weather and air quality coordinates don't match
2025-08-14 23:57:48,814 - etl.pipeline - ERROR - Data transformation failed - pipeline terminated
2025-08-14 23:57:48,815 - __main__ - INFO - ETL pipeline success: False
2025-08-14 23:57:48,824 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:48] "[32mGET /weather?lat=-33.8698439&lon=151.2082848 HTTP/1.1[0m" 302 -
2025-08-14 23:57:48,848 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:48] "GET / HTTP/1.1" 200 -
2025-08-14 23:57:55,245 - __main__ - INFO - Weather route called with lat=53.7974185, lon=-1.5437941
2025-08-14 23:57:56,356 - __main__ - INFO - Location name: Leeds, England
2025-08-14 23:57:56,357 - __main__ - INFO - Attempting to get latest record for 53.7974185, -1.5437941
2025-08-14 23:57:56,360 - __main__ - INFO - Latest record found: False
2025-08-14 23:57:56,361 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:57:56,365 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:57:56,366 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:56,367 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:57:56,369 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:56,370 - etl.pipeline - INFO - Location: 53.7974185, -1.5437941
2025-08-14 23:57:56,371 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:57:56.371400
2025-08-14 23:57:56,372 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:56,374 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:57:56,376 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:56,378 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 53.7974185, -1.5437941
2025-08-14 23:57:56,378 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:57:56,380 - etl.extract - INFO - Fetching weather forecast for 53.7974185, -1.5437941
2025-08-14 23:57:57,201 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:57:57,202 - etl.extract - INFO - Fetching air quality data for 53.7974185, -1.5437941
2025-08-14 23:57:58,026 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:57:58,027 - etl.extract - INFO - Data extraction completed in 1.65 seconds
2025-08-14 23:57:58,028 - etl.extract - INFO - Data validation successful
2025-08-14 23:57:58,029 - etl.pipeline - INFO - Extraction completed in 1.65 seconds
2025-08-14 23:57:58,031 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:57:58,031 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:57:58,034 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:58,036 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:57:58,045 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:58,048 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:57:58,049 - etl.transform - INFO - Starting data transformation
2025-08-14 23:57:58,052 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:57:58,061 - etl.pipeline - INFO - Transformation completed in 0.01 seconds
2025-08-14 23:57:58,061 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:57:58,063 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:57:58,065 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:57:58,070 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:57:58,072 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:57:58,087 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:57:58,094 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:57:58,114 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:57:58,115 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:57:58,119 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:57:58,120 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:57:58,136 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat53.80_lon-1.54_20250814_235758.csv
2025-08-14 23:57:58,138 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat53.80_lon-1.54_20250814_235758.csv
2025-08-14 23:57:58,167 - etl.pipeline - INFO - Data loading completed in 0.06 seconds
2025-08-14 23:57:58,168 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:57:58,168 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.80 SECONDS
2025-08-14 23:57:58,170 - etl.pipeline - INFO - ============================================================
2025-08-14 23:57:58,170 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:57:58,171 - __main__ - INFO - Attempting to get latest record after ETL for 53.7974185, -1.5437941
2025-08-14 23:57:58,176 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:57:58,179 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:57:58,180 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:57:58,180 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.7974185, -1.5437941
2025-08-14 23:57:58,188 - __main__ - INFO - Rendering weather template for Leeds, England
2025-08-14 23:57:58,191 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:57:58] "GET /weather?lat=53.7974185&lon=-1.5437941 HTTP/1.1" 200 -
2025-08-14 23:58:02,028 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:02] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:58:03,081 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:03] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:58:15,434 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:15] "GET / HTTP/1.1" 200 -
2025-08-14 23:58:26,697 - __main__ - INFO - Weather route called with lat=53.4071991, lon=-2.99168
2025-08-14 23:58:27,756 - __main__ - INFO - Location name: Liverpool, England
2025-08-14 23:58:27,757 - __main__ - INFO - Attempting to get latest record for 53.4071991, -2.99168
2025-08-14 23:58:27,760 - __main__ - INFO - Latest record found: False
2025-08-14 23:58:27,762 - __main__ - INFO - Running ETL pipeline - latest_record: False, stale: N/A
2025-08-14 23:58:27,782 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-14 23:58:27,788 - etl.pipeline - INFO - ============================================================
2025-08-14 23:58:27,793 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-14 23:58:27,794 - etl.pipeline - INFO - ============================================================
2025-08-14 23:58:27,796 - etl.pipeline - INFO - Location: 53.4071991, -2.99168
2025-08-14 23:58:27,797 - etl.pipeline - INFO - Timestamp: 2025-08-14T23:58:27.797992
2025-08-14 23:58:27,799 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:58:27,803 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-14 23:58:27,806 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:58:27,809 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 53.4071991, -2.99168
2025-08-14 23:58:27,813 - etl.extract - INFO - Starting complete data extraction
2025-08-14 23:58:27,814 - etl.extract - INFO - Fetching weather forecast for 53.4071991, -2.99168
2025-08-14 23:58:28,650 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-14 23:58:28,656 - etl.extract - INFO - Fetching air quality data for 53.4071991, -2.99168
2025-08-14 23:58:29,479 - etl.extract - INFO - Air quality data fetched successfully
2025-08-14 23:58:29,480 - etl.extract - INFO - Data extraction completed in 1.67 seconds
2025-08-14 23:58:29,481 - etl.extract - INFO - Data validation successful
2025-08-14 23:58:29,483 - etl.pipeline - INFO - Extraction completed in 1.67 seconds
2025-08-14 23:58:29,483 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-14 23:58:29,486 - etl.pipeline - INFO - Air quality data points: 120
2025-08-14 23:58:29,489 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:58:29,493 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-14 23:58:29,497 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:58:29,499 - etl.transform - INFO - WeatherTransformer initialized
2025-08-14 23:58:29,503 - etl.transform - INFO - Starting data transformation
2025-08-14 23:58:29,512 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-14 23:58:29,516 - etl.pipeline - INFO - Transformation completed in 0.02 seconds
2025-08-14 23:58:29,518 - etl.pipeline - INFO - Records created: 7
2025-08-14 23:58:29,522 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-14 23:58:29,523 - etl.pipeline - INFO - 
----------------------------------------
2025-08-14 23:58:29,525 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-14 23:58:29,527 - etl.pipeline - INFO - ----------------------------------------
2025-08-14 23:58:29,533 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-14 23:58:29,540 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-14 23:58:29,552 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-14 23:58:29,553 - etl.load - INFO -   - Inserted: 7 new records
2025-08-14 23:58:29,556 - etl.load - INFO -   - Updated: 0 existing records
2025-08-14 23:58:29,559 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-14 23:58:29,573 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat53.41_lon-2.98_20250814_235829.csv
2025-08-14 23:58:29,575 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat53.41_lon-2.98_20250814_235829.csv
2025-08-14 23:58:29,605 - etl.pipeline - INFO - Data loading completed in 0.05 seconds
2025-08-14 23:58:29,608 - etl.pipeline - INFO - 
============================================================
2025-08-14 23:58:29,608 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.82 SECONDS
2025-08-14 23:58:29,609 - etl.pipeline - INFO - ============================================================
2025-08-14 23:58:29,609 - __main__ - INFO - ETL pipeline success: True
2025-08-14 23:58:29,610 - __main__ - INFO - Attempting to get latest record after ETL for 53.4071991, -2.99168
2025-08-14 23:58:29,613 - __main__ - INFO - Latest record after ETL: True
2025-08-14 23:58:29,615 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:58:29,615 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:58:29,616 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4071991, -2.99168
2025-08-14 23:58:29,625 - __main__ - INFO - Rendering weather template for Liverpool, England
2025-08-14 23:58:29,627 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:29] "GET /weather?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-14 23:58:32,482 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:32] "POST /add-favorite HTTP/1.1" 200 -
2025-08-14 23:58:33,757 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:33] "GET /dashboard HTTP/1.1" 200 -
2025-08-14 23:58:40,092 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:58:40,093 - models.forecast.manager - INFO - Creating 7-day avg temperature forecast for 53.4071991, -2.99168
2025-08-14 23:58:40,102 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:40] "GET /forecast?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-14 23:58:57,238 - __main__ - INFO - Weather route called with lat=53.4071991, lon=-2.99168
2025-08-14 23:58:58,406 - __main__ - INFO - Location name: Liverpool, England
2025-08-14 23:58:58,408 - __main__ - INFO - Attempting to get latest record for 53.4071991, -2.99168
2025-08-14 23:58:58,413 - __main__ - INFO - Latest record found: True
2025-08-14 23:58:58,415 - __main__ - INFO - Weather record found: temp=N/A
2025-08-14 23:58:58,416 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-14 23:58:58,417 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4071991, -2.99168
2025-08-14 23:58:58,442 - __main__ - INFO - Rendering weather template for Liverpool, England
2025-08-14 23:58:58,446 - werkzeug - INFO - 127.0.0.1 - - [14/Aug/2025 23:58:58] "GET /weather?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-15 00:05:20,152 - __main__ - INFO - History route called with lat=53.4071991, lon=-2.99168
2025-08-15 00:05:21,241 - __main__ - INFO - Location name: Liverpool, England
2025-08-15 00:05:21,247 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-15 00:05:21,248 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-15 00:05:21,250 - __main__ - INFO - Rendering history template with 7 records
2025-08-15 00:05:21,255 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:05:21] "GET /history?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-15 00:05:28,678 - __main__ - INFO - Weather route called with lat=53.4071991, lon=-2.99168
2025-08-15 00:05:29,719 - __main__ - INFO - Location name: Liverpool, England
2025-08-15 00:05:29,720 - __main__ - INFO - Attempting to get latest record for 53.4071991, -2.99168
2025-08-15 00:05:29,724 - __main__ - INFO - Latest record found: True
2025-08-15 00:05:29,725 - __main__ - INFO - Weather record found: temp=N/A
2025-08-15 00:05:29,727 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-15 00:05:29,727 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4071991, -2.99168
2025-08-15 00:05:29,740 - __main__ - INFO - Rendering weather template for Liverpool, England
2025-08-15 00:05:29,747 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:05:29] "GET /weather?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-15 00:05:32,389 - etl.pipeline - INFO - WeatherETLPipeline initialized
2025-08-15 00:05:32,389 - etl.pipeline - INFO - ============================================================
2025-08-15 00:05:32,390 - etl.pipeline - INFO - WEATHER DATA ETL PIPELINE STARTED
2025-08-15 00:05:32,391 - etl.pipeline - INFO - ============================================================
2025-08-15 00:05:32,391 - etl.pipeline - INFO - Location: 53.4071991, -2.99168
2025-08-15 00:05:32,393 - etl.pipeline - INFO - Timestamp: 2025-08-15T00:05:32.393271
2025-08-15 00:05:32,394 - etl.pipeline - INFO - 
----------------------------------------
2025-08-15 00:05:32,395 - etl.pipeline - INFO - STEP 1: DATA EXTRACTION
2025-08-15 00:05:32,396 - etl.pipeline - INFO - ----------------------------------------
2025-08-15 00:05:32,398 - etl.extract - INFO - WeatherExtractor initialized for coordinates: 53.4071991, -2.99168
2025-08-15 00:05:32,400 - etl.extract - INFO - Starting complete data extraction
2025-08-15 00:05:32,401 - etl.extract - INFO - Fetching weather forecast for 53.4071991, -2.99168
2025-08-15 00:05:33,207 - etl.extract - INFO - Weather forecast fetched successfully
2025-08-15 00:05:33,207 - etl.extract - INFO - Fetching air quality data for 53.4071991, -2.99168
2025-08-15 00:05:34,064 - etl.extract - INFO - Air quality data fetched successfully
2025-08-15 00:05:34,065 - etl.extract - INFO - Data extraction completed in 1.66 seconds
2025-08-15 00:05:34,065 - etl.extract - INFO - Data validation successful
2025-08-15 00:05:34,067 - etl.pipeline - INFO - Extraction completed in 1.67 seconds
2025-08-15 00:05:34,067 - etl.pipeline - INFO - Weather forecast days: 7
2025-08-15 00:05:34,068 - etl.pipeline - INFO - Air quality data points: 120
2025-08-15 00:05:34,069 - etl.pipeline - INFO - 
----------------------------------------
2025-08-15 00:05:34,070 - etl.pipeline - INFO - STEP 2: DATA TRANSFORMATION
2025-08-15 00:05:34,071 - etl.pipeline - INFO - ----------------------------------------
2025-08-15 00:05:34,071 - etl.transform - INFO - WeatherTransformer initialized
2025-08-15 00:05:34,071 - etl.transform - INFO - Starting data transformation
2025-08-15 00:05:34,074 - etl.transform - INFO - Transformation completed. 7 records created
2025-08-15 00:05:34,075 - etl.pipeline - INFO - Transformation completed in 0.00 seconds
2025-08-15 00:05:34,075 - etl.pipeline - INFO - Records created: 7
2025-08-15 00:05:34,076 - etl.pipeline - INFO - Date range: 2025-08-14 to 2025-08-20
2025-08-15 00:05:34,076 - etl.pipeline - INFO - 
----------------------------------------
2025-08-15 00:05:34,077 - etl.pipeline - INFO - STEP 3: DATA LOADING
2025-08-15 00:05:34,078 - etl.pipeline - INFO - ----------------------------------------
2025-08-15 00:05:34,083 - etl.load - INFO - WeatherLoader initialized with 7 records
2025-08-15 00:05:34,087 - etl.load - INFO - SQLite database and tables created successfully: data\weather_data.db
2025-08-15 00:05:34,101 - etl.load - INFO - Successfully processed 7 records to SQLite: data\weather_data.db
2025-08-15 00:05:34,103 - etl.load - INFO -   - Inserted: 0 new records
2025-08-15 00:05:34,104 - etl.load - INFO -   - Updated: 7 existing records
2025-08-15 00:05:34,104 - etl.pipeline - INFO - [SUCCESS] Data saved to SQLite database
2025-08-15 00:05:34,112 - etl.load - INFO - Data successfully saved to CSV: data\csv_exports\weather_data_lat53.41_lon-2.98_20250815_000534.csv
2025-08-15 00:05:34,112 - etl.pipeline - INFO - [SUCCESS] Data saved to CSV: data\csv_exports\weather_data_lat53.41_lon-2.98_20250815_000534.csv
2025-08-15 00:05:34,135 - etl.pipeline - INFO - Data loading completed in 0.04 seconds
2025-08-15 00:05:34,137 - etl.pipeline - INFO - 
============================================================
2025-08-15 00:05:34,137 - etl.pipeline - INFO - PIPELINE COMPLETED SUCCESSFULLY IN 1.75 SECONDS
2025-08-15 00:05:34,137 - etl.pipeline - INFO - ============================================================
2025-08-15 00:05:34,137 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:05:34] "POST /api/update-weather HTTP/1.1" 200 -
2025-08-15 00:05:35,661 - __main__ - INFO - Weather route called with lat=53.4071991, lon=-2.99168
2025-08-15 00:05:36,752 - __main__ - INFO - Location name: Liverpool, England
2025-08-15 00:05:36,752 - __main__ - INFO - Attempting to get latest record for 53.4071991, -2.99168
2025-08-15 00:05:36,754 - __main__ - INFO - Latest record found: True
2025-08-15 00:05:36,755 - __main__ - INFO - Weather record found: temp=N/A
2025-08-15 00:05:36,756 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-15 00:05:36,756 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4071991, -2.99168
2025-08-15 00:05:36,765 - __main__ - INFO - Rendering weather template for Liverpool, England
2025-08-15 00:05:36,767 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:05:36] "GET /weather?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-15 00:07:42,251 - __main__ - INFO - Weather route called with lat=53.4071991, lon=-2.99168
2025-08-15 00:07:43,387 - __main__ - INFO - Location name: Liverpool, England
2025-08-15 00:07:43,388 - __main__ - INFO - Attempting to get latest record for 53.4071991, -2.99168
2025-08-15 00:07:43,393 - __main__ - INFO - Latest record found: True
2025-08-15 00:07:43,394 - __main__ - INFO - Weather record found: temp=N/A
2025-08-15 00:07:43,394 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-15 00:07:43,396 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 53.4071991, -2.99168
2025-08-15 00:07:43,407 - __main__ - INFO - Rendering weather template for Liverpool, England
2025-08-15 00:07:43,410 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:07:43] "GET /weather?lat=53.4071991&lon=-2.99168 HTTP/1.1" 200 -
2025-08-15 00:07:45,924 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:07:45] "GET / HTTP/1.1" 200 -
2025-08-15 00:07:51,722 - __main__ - INFO - Weather route called with lat=28.3780464, lon=83.9999901
2025-08-15 00:07:52,772 - __main__ - INFO - Attempting to get latest record for 28.3780464, 83.9999901
2025-08-15 00:07:52,778 - __main__ - INFO - Latest record found: True
2025-08-15 00:07:52,779 - __main__ - INFO - Weather record found: temp=N/A
2025-08-15 00:07:52,780 - models.forecast.manager - INFO - ForecastManager initialized
2025-08-15 00:07:52,782 - models.forecast.manager - INFO - Creating 3-day avg temperature forecast for 28.3780464, 83.9999901
2025-08-15 00:07:52,792 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:07:52] "GET /weather?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
2025-08-15 00:08:01,509 - __main__ - INFO - History route called with lat=28.3780464, lon=83.9999901
2025-08-15 00:08:02,532 - __main__ - INFO - Found 7 records with tight tolerance (0.01)
2025-08-15 00:08:02,536 - __main__ - INFO - Successfully converted 7 records to dictionaries
2025-08-15 00:08:02,538 - __main__ - INFO - Rendering history template with 7 records
2025-08-15 00:08:02,544 - werkzeug - INFO - 127.0.0.1 - - [15/Aug/2025 00:08:02] "GET /history?lat=28.3780464&lon=83.9999901 HTTP/1.1" 200 -
